<html><head><link href="main.css" rel="stylesheet"></head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><title>JS13k 2022</title><body class="full"><div id="root"><canvas id="canvas-map"></canvas><canvas id="canvas-player"></canvas></div><script>(()=>{"use strict";var t={712:function(t,i,n){var s=this&&this.t||function(){return(s=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};Object.defineProperty(i,"i",{value:!0}),i.o=i.h=void 0;var o=n(839),e=n(603);!function(t){t.u="width",t.v="height"}(i.h||(i.h={}));var r=function(){function t(t,i){var n;void 0===i&&(i={}),this.context=t,this.coords=null!==(n=i.coords)&&void 0!==n?n:new o.l({canvas:t.canvas});var e={beginPath:!0,closePath:!1,fill:!1,M:void 0,_:!0,stroke:!1,p:{},O:!1,m:!1,j:!1};this.options=s(s({},e),i)}return t.prototype.rect=function(t,i,n,s,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o={}),this.g(o),this.context.rect(this.A(t,o),this.N(i,o),this.R(n,o),this.R(s,o)),this.k(o)},t.prototype.C=function(t,i){void 0===i&&(i={}),this.g(i);for(var n=0;n<t.length;n++){var s=this.A(t[n][0],i),o=this.N(t[n][1],i);0===n?this.context.moveTo(s,o):this.context.lineTo(s,o)}this.k(i)},t.prototype.S=function(t,i){void 0===i&&(i={}),this.g(i);for(var n=0;n<t.length-2;n++){var s=this.A(t[n][0],i),o=this.N(t[n][1],i);if(0===n)this.context.moveTo(s,o);else if(n<t.length-2){var e=(s+this.A(t[n+1][0],i))/2,r=(o+this.N(t[n+1][1],i))/2;this.context.quadraticCurveTo(s,o,e,r)}}this.context.quadraticCurveTo(this.A(t[t.length-2][0],i),this.N(t[t.length-2][1],i),this.A(t[t.length-1][0],i),this.N(t[t.length-1][1],i)),this.k(i)},t.prototype.W=function(t,i,n,s){void 0===s&&(s={}),this.g(s),this.context.arc(this.A(t,s),this.N(i,s),this.R(n,s),0,o.P),this.k(s)},t.prototype.drawImage=function(t,i,n,s){void 0===s&&(s={}),this.g(s),this.context.drawImage(t,this.A(i,s),this.N(n,s)),this.k(s)},t.prototype.T=function(t,i,n,e,r,h){void 0===h&&(h={}),this.C((0,o.T)(this.A(t,h),this.N(i,h),this.R(n,h),e,r),s(s({},h),{O:!1,_:!0}))},t.prototype.D=function(t,i,n,e,r){void 0===r&&(r={}),this.C((0,o.D)(this.A(t,r),this.N(i,r),this.R(n,r),e),s(s({},r),{O:!1,_:!0}))},t.prototype.H=function(t){this.L(s(s({},this.options.p),t))},t.prototype.text=function(t,i,n,s){void 0===s&&(s={}),this.g(s),this.context.fillText(t,this.A(i,s),this.N(n,s),this.U("maxTextWidth",s)),this.k(s)},t.prototype.clear=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.prototype.J=function(t,i){void 0===i&&(i={}),t.width=t.clientWidth*(i.K?e.q:1),t.height=t.clientHeight*(i.K?e.q:1)},t.prototype.A=function(t,i){return void 0===i&&(i={}),this.U("useNormalCoordinates",i)?this.coords.F(t):t},t.prototype.N=function(t,i){return void 0===i&&(i={}),this.U("useNormalCoordinates",i)?this.coords.I(t):t},t.prototype.R=function(t,i){void 0===i&&(i={});var n=this.U("scalarNormalization",i);return"width"===n?this.coords.width(t):"height"===n?this.coords.height(t):t},t.prototype.U=function(t,i){return i&&t in i?i[t]:this.options[t]},t.prototype.Y=function(t,i){var n=i&&t in i?i[t]:this.options.p[t];return"function"==typeof n?n(this.coords):n},t.prototype.B=function(t){var i=this.Y("fontSize",t),n=this.Y("lineHeight",t),s=this.Y("fontStyle",t),o=this.Y("fontFamily",t),e=this.Y("fontWeight",t),r=this.Y("fontStretch",t),h="number"==typeof i?"".concat(i,"px"):void 0;return n&&h&&(h="".concat(i," / ").concat(n,"}")),[h,o,s,e,r].join(" ")},t.prototype.L=function(t){for(var i in t){var n=this.Y(i,t);if(!(0,o.G)(n)){if("transform"===i&&this.context.setTransform(n),"translation"===i){var s=n,e=s.x,r=s.y;this.context.translate(this.A(e),this.N(r))}if("rotation"===i)if("number"==typeof n)this.context.rotate(n);else{var h=n,a=h.rotation,u=h.origin,v=this.A(u.x),c=this.N(u.y);this.context.translate(v,c),this.context.rotate(a),this.context.translate(-v,-c)}if("scale"===i)if("origin"in n){var d=n,f=d.origin,l=d.scale,w=d.V,M=void 0!==w&&w;v=this.A(f.x),c=this.N(f.y);this.context.translate(v,c),this.context.scale(l.x,l.y),this.context.translate(-v,-c),M&&(this.context.lineWidth=this.context.lineWidth*(1/((l.x+l.y)/2)))}else{var b=n;e=b.x,r=b.y;this.context.scale(e,r)}"lineDash"===i&&this.context.setLineDash(n),"alpha"===i&&(this.context.globalAlpha=n),i in this.context&&"function"!=typeof this.context[i]&&(this.context[i]=this.Y(i,t))}}this.context.font=this.B(t)},t.prototype.g=function(t){void 0===t&&(t={}),this.U("saveAndRestore",t)&&this.context.save(),this.U("skipApplyStyles",t)||this.H(t.p),this.U("beginPath",t)&&this.context.beginPath()},t.prototype.k=function(t){this.U("closePath",t)&&this.context.closePath(),this.U("fill",t)&&this.context.fill(),this.U("stroke",t)&&this.context.stroke(),this.U("saveAndRestore",t)&&this.context.restore()},t}();i.o=r},367:function(t,i,n){var s,o=this&&this.X||(s=function(t,i){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])})(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),e=this&&this.t||function(){return(e=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};Object.defineProperty(i,"i",{value:!0}),i.Z=void 0;var r=n(839),h=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.options=e(e({},{$:.025}),s.options),s}return o(i,t),i.prototype.C=function(t,i){void 0===i&&(i={});for(var n=t.length-1,s=0;s<2;s++)for(var o=[],e=0;e<n;e++){for(var h=t[e],a=t[e+1],u=Math.sqrt(Math.pow(h[0]-a[0],2)+Math.pow(h[1]-a[1],2)),v=this.options.$*u,c=0;c<4;c++){var d=Math.random()*v,f=Math.random()*r.P,l=d*Math.cos(f),w=d*Math.sin(f),M=NaN,b=NaN;if(0===c&&(M=h[0]+l,b=h[1]+w),1===c){var _=.5;M=(0,r.tt)(_,h[0],a[0])+l,b=(0,r.tt)(_,h[1],a[1])+w}if(2===c){_=.75;M=(0,r.tt)(_,h[0],a[0])+l,b=(0,r.tt)(_,h[1],a[1])+w}3===c&&(M=a[0]+l,b=a[1]+w),o.push([M,b])}this.S(o,i)}},i.prototype.W=function(t,i,n,s){void 0===s&&(s={});for(var o=10*this.options.$*this.R(n,s)/window.innerWidth,h=0;h<2;h++){for(var a=[],u=0;u<16;u++){var v=Math.random()*o,c=Math.random()*r.P,d=v*Math.cos(c),f=v*Math.sin(c),l=r.P*u/16,w=this.A(t+d,s)+Math.cos(l)*this.R(n,s),M=this.N(i+f,s)+Math.sin(l)*this.R(n,s);a.push([w,M])}a[16]=a[0],a[17]=a[1],this.S(a,e(e({},s),{O:!1,_:!0}))}},i.prototype.rect=function(t,i,n,s,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o={});var r=this.A(t),h=this.N(i),a=this.R(n),u=this.R(s),v=[[r,h],[r+a,h],[r+a,h+u],[r,h+u],[r,h]];this.C(v,e(e({},o),{O:!1,_:!0}))},i}(r.o);i.Z=h},659:function(t,i,n){var s=this&&this.t||function(){return(s=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)},o=this&&this.it||function(t,i,n){if(n||2===arguments.length)for(var s,o=0,e=i.length;o<e;o++)!s&&o in i||(s||(s=Array.prototype.slice.call(i,0,o)),s[o]=i[o]);return t.concat(s||Array.prototype.slice.call(i))};Object.defineProperty(i,"i",{value:!0}),i.l=void 0;var e,r=n(654),h=n(796),a=n(908),u=n(482);!function(t){t.nt="up",t.st="down"}(e||(e={}));var v=function(){function t(t){if(void 0===t&&(t={}),(0,h.G)(t.canvas)&&(0,r.ot)(t.et,t.rt))throw new Error("Invalid options. A canvas element must be supplied if baseHeight or baseWidth are not defined.");Object.assign(this,s(s({},{ht:[-1,1],ut:[-1,1],vt:!1,orientationY:"down",ct:!1}),t))}return t.prototype.dt=function(){var t;return null!==(t=this.et)&&void 0!==t?t:this.canvas.width},t.prototype.ft=function(){return this.dt()-2*this.lt()},t.prototype.wt=function(){var t;return null!==(t=this.rt)&&void 0!==t?t:this.canvas.height},t.prototype.Mt=function(){return this.wt()-2*this.bt()},t.prototype._t=function(){var t,i;return null!==(i=null!==(t=this.Ot)&&void 0!==t?t:this.padding)&&void 0!==i?i:0},t.prototype.lt=function(){return this._t()*this.dt()},t.prototype.jt=function(){return(0,h.G)(this.yt)?(0,h.G)(this.padding)?0:this.ct?this.padding*(this.dt()/this.wt()):this.padding:this.yt},t.prototype.bt=function(){return this.jt()*this.wt()},t.prototype.gt=function(){var t;return null!==(t=this.offsetX)&&void 0!==t?t:0},t.prototype.At=function(){var t;return null!==(t=this.offsetY)&&void 0!==t?t:0},t.prototype.F=function(t){var i=u.normalize.apply(void 0,o(o([t],this.ht,!1),[this.vt],!1));return this.lt()+this.gt()+i*this.ft()},t.prototype.I=function(t){var i=u.normalize.apply(void 0,o(o([t],this.ut,!1),[this.vt],!1)),n=this.Nt===e.nt;return this.bt()+this.At()+(n?1-i:i)*this.Mt()},t.prototype.Rt=function(t){var i=(0,u.normalize)(t,this.lt(),this.lt()+this.width(),this.vt);return a.tt.apply(void 0,o([i],this.ht,!1))},t.prototype.kt=function(t){var i=(0,u.normalize)(t,this.bt(),this.bt()+this.height(),this.vt);return a.tt.apply(void 0,o([i],this.ht,!1))},t.prototype.width=function(t){return this.ft()*(null!=t?t:1)},t.prototype.height=function(t){return this.Mt()*(null!=t?t:1)},t}();i.l=v},358:(t,i,n)=>{Object.defineProperty(i,"i",{value:!0}),i.Ct=void 0;var s=n(839);i.Ct=function(t,i){if(t.parentElement){var n=t.parentElement,o=i.x,e=i.y,r=new ResizeObserver((function(){var i=n.getBoundingClientRect(),r=i.width,h=i.height,a=Math.min(r/o,h/e),u=t.clientWidth,v=t.clientHeight,c=Math.round(a*o),d=Math.round(a*e);c===u&&d===v||(t instanceof HTMLCanvasElement&&(t.width=c*s.q,t.height=d*s.q),t.style.width=c+"px",t.style.height=d+"px")}));return r.observe(n),r}return console.warn("aspectRatioResize: element has no parent and cannot be resized"),null}},999:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.St=void 0;i.St=function(t,i,n){var s=n*Math.sqrt(3)/2;return[[t,i-2*s/3],[t+n/2,i*(s/3)],[t-n/2,i*(s/3)]]}},125:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.xt=void 0;i.xt=function(t,i,n,s){var o=Math.sqrt(s*s/4-n*n);return[[t,i-2*o/3],[t+s/2,i*(o/3)],[t-s/2,i*(o/3)]]}},932:(t,i,n)=>{Object.defineProperty(i,"i",{value:!0}),i.D=void 0;var s=n(965);i.D=function(t,i,n,o){void 0===o&&(o=5);for(var e=[],r=0,h=o;r<=h;r++){var a=-s.PI/(2*o)+s.P*(r/h);e.push([t+Math.cos(a)*n,i+Math.sin(a)*n])}return e}},166:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.zt=void 0;i.zt=function(t,i,n,s,o){return[Math.cos(o)*(t-n)-Math.sin(o)*(i-s)+n,Math.sin(o)*(t-n)+Math.cos(o)*(i-s)+s]}},154:(t,i,n)=>{Object.defineProperty(i,"i",{value:!0}),i.T=void 0;var s=n(965);i.T=function(t,i,n,o,e){void 0===o&&(o=5),void 0===e&&(e=.4);for(var r=[],h=0,a=2*o;h<=a;h++){var u=-s.PI/(2*o)+s.P*(h/a),v=h%2;r.push([t+Math.cos(u)*(0===v?n:n*e),i+Math.sin(u)*(0===v?n:n*e)])}return r}},839:function(t,i,n){var s=this&&this.Wt||(Object.create?function(t,i,n,s){void 0===s&&(s=n),Object.defineProperty(t,s,{Pt:!0,get:function(){return i[n]}})}:function(t,i,n,s){void 0===s&&(s=n),t[s]=i[n]}),o=this&&this.Tt||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||s(i,t,n)};Object.defineProperty(i,"i",{value:!0}),o(n(712),i),o(n(367),i),o(n(659),i),o(n(603),i),o(n(147),i),o(n(654),i),o(n(796),i),o(n(90),i),o(n(600),i),o(n(965),i),o(n(908),i),o(n(482),i),o(n(674),i),o(n(358),i),o(n(999),i),o(n(125),i),o(n(932),i),o(n(166),i),o(n(154),i)},603:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.q=void 0,i.q=window.devicePixelRatio||1},90:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.Dt=void 0;i.Dt=function(t){return JSON.parse(JSON.stringify(t))}},147:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.Ht=void 0;i.Ht=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.every((function(t){return void 0===t}))}},654:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.ot=void 0;i.ot=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.some((function(t){return void 0===t}))}},796:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.G=void 0;i.G=function(t){return void 0===t}},674:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.Et=void 0;var n=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.ratio=function(){return this.x/this.y},t}();i.Et=n},600:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.vt=void 0;i.vt=function(t,i,n){return Math.max(Math.min(n,t),i)}},965:(t,i,n)=>{Object.defineProperty(i,"i",{value:!0}),i.Lt=i.PI=i.P=void 0;var s=n(674);i.P=2*Math.PI,i.PI=Math.PI,i.Lt=new s.Et(0,0)},908:(t,i)=>{Object.defineProperty(i,"i",{value:!0}),i.tt=void 0;i.tt=function(t,i,n){return i*(1-t)+n*t}},482:(t,i,n)=>{Object.defineProperty(i,"i",{value:!0}),i.normalize=void 0;var s=n(600);i.normalize=function(t,i,n,o){return void 0===o&&(o=!1),((o?(0,s.vt)(t,i,n):t)-i)/(n-i)}}},i={};function n(s){var o=i[s];if(void 0!==o)return o.exports;var e=i[s]={exports:{}};return t[s].call(e.exports,e,e.exports,n),e.exports}(()=>{var t=n(839);const i=new t.Et(32,18),s=1/i.x,o={move:{Ut:!1,Jt:!1,left:!1,right:!1}},e={strokeStyle:"white",lineWidth:t=>t.width(.001)},r={map:document.getElementById("canvas-map"),Kt:document.getElementById("canvas-player")},h={map:r.map.getContext("2d"),Kt:r.Kt.getContext("2d")},a={map:new t.l({canvas:r.map,ht:[0,i.x],ut:[0,i.y],padding:0})},u={map:new t.o(h.map,{coords:a.map,p:e,stroke:!0,O:!0,m:"width"}),Kt:new t.Z(h.Kt,{coords:a.map,p:{...e,lineWidth:t=>t.width(.00175)},stroke:!0,$:.1,O:!0,m:"width"})};const v=new class{constructor(n){this.qt=n,this.position=new t.Et(i.x/2,i.y/2),this.size=s/2,this.Ft=4,this.It=1500,this.speed=.005}Yt(t){const i=.7071*t*this.speed;return o.move.left&&o.move.Ut?(this.position.x-=i,void(this.position.y-=i)):o.move.left&&o.move.Jt?(this.position.x-=i,void(this.position.y+=i)):o.move.right&&o.move.Ut?(this.position.x+=i,void(this.position.y-=i)):o.move.right&&o.move.Jt?(this.position.x+=i,void(this.position.y+=i)):void(o.move.Ut?this.position.y-=i:o.move.Jt?this.position.y+=i:o.move.left?this.position.x-=i:o.move.right&&(this.position.x+=i))}Bt(t){t.T(0,0,.5,5)}Gt(t){const i=Math.floor(t/this.It%1*this.Ft);this.qt.clear();for(let t=0;t<this.Qt.length;t++)this.qt.drawImage(this.Qt[i],this.position.x,this.position.y)}Vt(){const i=this.qt.coords.width(s),n=[];this.qt.H(this.qt.options.p);for(let s=0;s<this.Ft;s++){const s=document.createElement("canvas"),o=s.getContext("2d"),e=new t.Z(o,{...this.qt.options,p:{...this.qt.options.p,lineWidth:this.qt.context.lineWidth},coords:new t.l({et:i,rt:i})});s.width=i,s.height=i,this.Bt(e),n.push(s)}this.Qt=n}}(u.Kt);var c;!function(t){t[t.Xt=0]="CanvasResize",t[t.Zt=1]="Tick",t[t.$t=2]="KeyDown",t[t.ti=3]="KeyUp"}(c||(c={}));const d={[c.Xt]:[],[c.Zt]:[],[c.$t]:[],[c.ti]:[]},f=(t,i,n=!1)=>{d[t].push(i),n&&i()},l=(t,...i)=>{const n=d[t];for(let t=0;t<n.length;t++)n[t](...i)};new ResizeObserver((()=>{l(c.Xt)})).observe(r.map),window.addEventListener("keydown",(t=>{l(c.$t,t.key)})),window.addEventListener("keyup",(t=>{l(c.ti,t.key)}));let w=0;const M=t=>{l(c.Zt,t,t-w),w=t,window.requestAnimationFrame(M)};Object.values(r).forEach((n=>(0,t.Ct)(n,i))),f(c.Xt,(()=>(t=>{for(let n=0;n<i.x;n++)for(let s=0;s<i.y;s++)t.rect(n,s,1/i.x,1/i.x,{p:{strokeStyle:"rgba(255,255,255,0.1)"}})})(u.map)),!0),f(c.Xt,(()=>{v.Vt()}),!0),f(c.Zt,((t,i)=>{v.Yt(i),v.Gt(t)})),f(c.$t,(t=>{"ArrowLeft"!==t&&"a"!==t||(o.move.left=!0),"ArrowRight"!==t&&"d"!==t||(o.move.right=!0),"ArrowUp"!==t&&"w"!==t||(o.move.Ut=!0),"ArrowDown"!==t&&"s"!==t||(o.move.Jt=!0)})),f(c.ti,(t=>{"ArrowLeft"!==t&&"a"!==t||(o.move.left=!1),"ArrowRight"!==t&&"d"!==t||(o.move.right=!1),"ArrowUp"!==t&&"w"!==t||(o.move.Ut=!1),"ArrowDown"!==t&&"s"!==t||(o.move.Jt=!1)})),window.requestAnimationFrame(M)})()})();</script></body></html>