<html><head><link href="main.css" rel="stylesheet"></head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><title>Bardo</title><body class="full"><div id="root"><canvas id="ui"></canvas><canvas id="upgrades"></canvas><canvas id="map"></canvas><canvas id="gameplay"></canvas></div><script>(()=>{var t={705:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.i=void 0;i.i=function(t){var i=void 0===t?{}:t,s=i.o,e=void 0===s?0:s,n=i.h,r=void 0===n?-1:n,o=i.u,h=void 0===o?1:o,a=i.l,u=void 0===a?1:a,c=i.v,l=void 0===c?0:c,f=i.p,d=void 0===f?0:f,v=i.g,p=void 0!==v&&v;if(e<r||e>h)throw new Error("yStart must be between yMin and yMax");var g=2*Math.PI,w=(r+h)/2,m=(h-r)/2,M=p?-1:1,y=Math.asin(2*(e-r)/(h-r)-1)*(u/g);return function(t){return w+m*Math.sin(M*(g*(t-l+y))/u)+d}}},257:function(t,i,s){"use strict";var e=this&&this.m||(Object.create?function(t,i,s,e){void 0===e&&(e=s),Object.defineProperty(t,e,{M:!0,get:function(){return i[s]}})}:function(t,i,s,e){void 0===e&&(e=s),t[e]=i[s]}),n=this&&this.S||function(t,i){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(i,s)||e(i,t,s)};Object.defineProperty(i,"t",{value:!0}),n(s(705),i)},712:function(t,i,s){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var i,s=1,e=arguments.length;s<e;s++)for(var n in i=arguments[s])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t},e.apply(this,arguments)};Object.defineProperty(i,"t",{value:!0}),i.O=i.j=void 0;var n=s(839),r=s(603),o=s(674);!function(t){t.R="width",t.k="height"}(i.j||(i.j={}));var h=function(){function t(t,i){var s;void 0===i&&(i={}),this.context=t,this.coords=null!==(s=i.coords)&&void 0!==s?s:new n.A({canvas:t.canvas});var r={beginPath:!0,closePath:!1,fill:!1,C:-1,N:!0,stroke:!1,P:!1,D:!1,W:!1,L:0,U:!1,random:Math.random};this.options=e(e({},r),i),this.options.I=e(e({},{fontFamily:"sans-serif",fontSize:16}),i.I)}return t.prototype.rect=function(t,i,s,e,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=1),void 0===e&&(e=1),void 0===n&&(n={}),this.B("roughness",n)?this.K(t,i,s,e,n):this.T(t,i,s,e,n)},t.prototype.K=function(t,i,s,n,r){var o=this.F(t),h=this.H(i),a=this.q(s),u=this.J(n),c=[[o,h],[o+a,h],[o+a,h+u],[o,h+u],[o,h]];this.Y(c,e(e({},r),{P:!1,N:!0,U:!0}))},t.prototype.T=function(t,i,s,e,n){this.V(n),this.context.rect(this.F(t,n),this.H(i,n),this.q(s),this.J(e)),this.X(n)},t.prototype.Y=function(t,i){void 0===i&&(i={}),this.B("roughness",i)?this.G(t,i):this.Z(t,i)},t.prototype.Z=function(t,i){this.V(i);for(var s=0;s<t.length;s++){var e=this.F(t[s][0],i),n=this.H(t[s][1],i);0===s?this.context.moveTo(e,n):this.context.lineTo(e,n)}this.X(i)},t.prototype.G=function(t,i){for(var s=this.B("roughness",i)||0,r=this.B("random",i),o=t.length-1,h=0;h<2;h++){for(var a=[],u=0;u<o;u++)for(var c=t[u],l=c[0],f=c[1],d=t[u+1],v=d[0],p=d[1],g=s*Math.sqrt(Math.pow(l-v,2)+Math.pow(f-p,2)),w=0;w<4;w++){var m=r()*g,M=r()*n.$,y=m*Math.cos(M),b=m*Math.sin(M),S=NaN,_=NaN;if(0===w&&(S=l+y,_=f+b),1===w){var O=.5;S=(0,n.tt)(O,l,v)+y,_=(0,n.tt)(O,f,p)+b}if(2===w){O=.75;S=(0,n.tt)(O,l,v)+y,_=(0,n.tt)(O,f,p)+b}3===w&&(i.U&&u===o-1?(S=a[0][0],_=a[0][1]):(S=v+y,_=p+b)),a.push([S,_])}var j=0===h?i:e(e({},i),{fill:!1});this.it(a,j)}},t.prototype.it=function(t,i){var s=this;void 0===i&&(i={}),this.V(i);for(var e=0;e<t.length-1;e++){var n=this.F(t[e][0],i),r=this.H(t[e][1],i);if(0===e)this.context.moveTo(n,r);else{var o=this.F(t[e+1][0],i),h=this.H(t[e+1][1],i);if(o===n&&h===r)this.context.lineTo(o,h);else{var a=(n+o)/2,u=(r+h)/2;this.context.quadraticCurveTo(n,r,a,u)}}}t.slice(-1).forEach((function(t){s.context.lineTo(s.F(t[0],i),s.H(t[1],i))})),this.X(i)},t.prototype.st=function(t,i,s,e){void 0===e&&(e={}),this.B("roughness",e)?this.et(t,i,s,e):this.nt(t,i,s,e)},t.prototype.nt=function(t,i,s,e){this.V(e),this.context.arc(this.F(t,e),this.H(i,e),this.rt(s,e),0,n.$),this.X(e)},t.prototype.et=function(t,i,s,r){for(var o=this.B("roughness",r),h=this.B("random",r),a=o*this.rt(s,r)/window.innerWidth,u=0;u<2;u++){for(var c=[],l=0;l<16;l++){var f=h()*a,d=h()*n.$,v=f*Math.cos(d),p=f*Math.sin(d),g=n.$*l/16,w=this.F(t+v,r)+Math.cos(g)*this.rt(s,r),m=this.H(i+p,r)+Math.sin(g)*this.rt(s,r);c.push([w,m])}c[16]=c[0],c[17]=c[1],this.it(c,e(e({},r),{P:!1,N:!0,U:!0}))}},t.prototype.drawImage=function(t,i,s,e){void 0===e&&(e={}),this.V(e),this.context.drawImage(t,this.F(i,e),this.H(s,e)),this.X(e)},t.prototype.ot=function(t,i,s,r,o,h){void 0===h&&(h={}),this.Y((0,n.ot)(this.F(t,h),this.H(i,h),this.rt(s,h),r,o),e(e({},h),{P:!1,N:!0}))},t.prototype.ht=function(t,i,s,r,o){void 0===o&&(o={});var h=this.B("roughness",o);this.Y((0,n.ht)(this.F(t,o),this.H(i,o),this.rt(s,o),r),e(e({},o),{P:!1,N:!0,U:Boolean(h)}))},t.prototype.ut=function(t){this.ct(e(e({},this.options.I),t))},t.prototype.text=function(t,i,s,e){void 0===e&&(e={}),this.B("roughness",e)?this.lt(t,i,s,e):this.ft(t,i,s,e)},t.prototype.ft=function(t,i,s,e){void 0===e&&(e={}),this.V(e);var n=this.B("maxTextWidth",e);this.context.fillText(t,this.F(i,e),this.H(s,e),n>0?n:void 0),this.X(e)},t.prototype.lt=function(t,i,s,r){var h=this;void 0===r&&(r={});var a=this.dt(t,r.I),u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent,l=a.width,f=this.B("roughness",r),d=this.B("random",r),v=t.split(""),p=u-c,g=this.coords.vt(p),w=l/v.length,m=this.coords.gt(w)-this.coords.gt(0),M=m*v.length;this.ut(r.I),v.forEach((function(t,a){var u,c;if("left"===h.context.textAlign)c=(u=i+m*a)+m/2;else if("right"===h.context.textAlign)c=(u=-M+i+m*(a+1))-m/2;else{if("center"!==h.context.textAlign)throw new Error("textAlign must be 'left', 'right', or 'center' to use rough text");c=u=-M/2+i+m*(.5+a)}var v,p=s;if("top"===h.context.textBaseline)v=p-g/2;else if("bottom"===h.context.textBaseline)v=p-g/2;else{if("middle"!==h.context.textBaseline)throw new Error("textBaseline must be 'top', 'bottom', or 'middle' to use rough text");v=p}var w=f*l*.05,y=[(0,n.random)(Math.min(.4,w/6.5),0,d)*m,(0,n.random)(Math.min(.4,w/6.5),0,d)*m],b=[(0,n.random)(Math.min(.4,w/6.5),0,d)*g,(0,n.random)(Math.min(.4,w/6.5),0,d)*g];h.ft(t,u+y[0],p+b[0],e(e({},r),{I:e(e({},r.I),{rotation:{origin:new o.wt(c,v),rotation:w*Math.PI/16}})})),h.ft(t,u+y[1],p+b[1],e(e({},r),{I:e(e({},r.I),{rotation:{origin:new o.wt(c,v),rotation:-w*Math.PI/16}})}))}))},t.prototype.clear=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.prototype.Mt=function(t,i){void 0===i&&(i={}),t.width=t.clientWidth*(i.yt?r.bt:1),t.height=t.clientHeight*(i.yt?r.bt:1)},t.prototype.F=function(t,i){return void 0===i&&(i={}),this.B("useNormalCoordinates",i)?this.coords.St(t):t},t.prototype.H=function(t,i){return void 0===i&&(i={}),this.B("useNormalCoordinates",i)?this.coords._t(t):t},t.prototype.q=function(t){return this.coords.width(t)},t.prototype.J=function(t){return this.coords.height(t)},t.prototype.rt=function(t,i){void 0===i&&(i={});var s=this.B("scalarNormalization",i);return"width"===s?this.coords.width(t):"height"===s?this.coords.height(t):t},t.prototype.B=function(t,i){var s=i&&t in i?i[t]:this.options[t];return console.assert(null!=s,"A value for ".concat(s," could not be resolved.")),s},t.prototype.Ot=function(t,i){var s=i&&t in i?i[t]:this.options.I[t];return"function"==typeof s?s(this.coords):s},t.prototype.jt=function(t){var i=this.Ot("fontSize",t),s=this.Ot("lineHeight",t),e=this.Ot("fontStyle",t),n=this.Ot("fontFamily",t),r=this.Ot("fontWeight",t),o=this.Ot("fontStretch",t),h="number"==typeof i?"".concat(i,"px"):void 0;return s&&h&&(h="".concat(i," / ").concat(s,"}")),[h,n,e,r,o].join(" ").trim()},t.prototype.ct=function(t){for(var i in t){var s=this.Ot(i,t);if(!(0,n.xt)(s)){if("transform"===i&&this.context.setTransform(s),"translation"===i){var e=s,r=e.x,o=e.y;this.context.translate(this.F(r),this.H(o))}if("rotation"===i)if("number"==typeof s)this.context.rotate(s);else{var h=s,a=h.rotation,u=h.origin,c=this.F(u.x),l=this.H(u.y);this.context.translate(c,l),this.context.rotate(a),this.context.translate(-c,-l)}if("scale"===i)if("origin"in s){var f=s,d=f.origin,v=f.scale,p=f.Rt,g=void 0!==p&&p;c=this.F(d.x),l=this.H(d.y);this.context.translate(c,l),this.context.scale(v.x,v.y),this.context.translate(-c,-l),g&&(this.context.lineWidth=this.context.lineWidth*(1/((v.x+v.y)/2)))}else{var w=s;r=w.x,o=w.y;this.context.scale(r,o)}"lineDash"===i&&this.context.setLineDash(s),"alpha"===i&&(this.context.globalAlpha=s),i in this.context&&"function"!=typeof this.context[i]&&(this.context[i]=this.Ot(i,t))}}this.context.font=this.jt(t)},t.prototype.V=function(t){void 0===t&&(t={}),this.B("saveAndRestore",t)&&this.context.save(),this.B("skipApplyStyles",t)||this.ut(t.I),this.B("beginPath",t)&&this.context.beginPath()},t.prototype.X=function(t){this.B("closePath",t)&&this.context.closePath(),this.B("fill",t)&&this.context.fill(),this.B("stroke",t)&&this.context.stroke(),this.B("saveAndRestore",t)&&this.context.restore()},t.prototype.dt=function(t,i){this.context.save(),this.ut(i);var s=this.context.measureText(t);return this.context.restore(),s},t}();i.O=h},659:function(t,i,s){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var i,s=1,e=arguments.length;s<e;s++)for(var n in i=arguments[s])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t},e.apply(this,arguments)};Object.defineProperty(i,"t",{value:!0}),i.A=void 0;var n,r=s(654),o=s(796),h=s(908),a=s(482);!function(t){t.kt="up",t.At="down"}(n||(n={}));var u=function(){function t(t){if(void 0===t&&(t={}),(0,o.xt)(t.canvas)&&(0,r.zt)(t.Ct,t.Nt))throw new Error("Invalid options. A canvas element must be supplied if baseHeight or baseWidth are not defined.");Object.assign(this,e(e({},{Pt:[-1,1],Et:[-1,1],Dt:!1,orientationY:"down",Wt:!1}),t))}return t.prototype.Lt=function(){var t;return null!==(t=this.Ct)&&void 0!==t?t:this.canvas.width},t.prototype.Ut=function(){return this.Lt()-2*this.It()},t.prototype.Bt=function(){var t;return null!==(t=this.Nt)&&void 0!==t?t:this.canvas.height},t.prototype.Kt=function(){return this.Bt()-2*this.Tt()},t.prototype.Ft=function(){var t,i;return null!==(i=null!==(t=this.Ht)&&void 0!==t?t:this.padding)&&void 0!==i?i:0},t.prototype.It=function(){return this.Ft()*this.Lt()},t.prototype.qt=function(){return(0,o.xt)(this.Jt)?(0,o.xt)(this.padding)?0:this.Wt?this.padding*(this.Lt()/this.Bt()):this.padding:this.Jt},t.prototype.Tt=function(){return this.qt()*this.Bt()},t.prototype.Yt=function(){var t;return null!==(t=this.offsetX)&&void 0!==t?t:0},t.prototype.Vt=function(){var t;return null!==(t=this.offsetY)&&void 0!==t?t:0},t.prototype.St=function(t){var i=(0,a.normalize)(t,this.Pt[0],this.Pt[1],this.Dt);return this.It()+this.Yt()+i*this.Ut()},t.prototype._t=function(t){var i=(0,a.normalize)(t,this.Et[0],this.Et[1],this.Dt),s=this.Xt===n.kt;return this.Tt()+this.Vt()+(s?1-i:i)*this.Kt()},t.prototype.gt=function(t){var i=(0,a.normalize)(t,this.It(),this.It()+this.width(),this.Dt);return(0,h.tt)(i,this.Pt[0],this.Pt[1])},t.prototype.Gt=function(t){var i=(0,a.normalize)(t,this.Tt(),this.Tt()+this.height(),this.Dt);return(0,h.tt)(i,this.Pt[0],this.Pt[1])},t.prototype.width=function(t){return this.Ut()*(null!=t?t:1)},t.prototype.height=function(t){return this.Kt()*(null!=t?t:1)},t.prototype.Qt=function(t){return this.gt(t)-this.gt(0)},t.prototype.vt=function(t){return this.Gt(t)-this.Gt(0)},t}();i.A=u},326:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Zt=void 0;var e=s(839);i.Zt=function(t,i){if(t.parentElement){var s=t.parentElement,n=i.x,r=i.y,o=new ResizeObserver((function(){var i=s.getBoundingClientRect(),o=i.width,h=i.height,a=Math.min(o/n,h/r),u=t.clientWidth,c=t.clientHeight,l=Math.round(a*n),f=Math.round(a*r);l===u&&f===c||(t instanceof HTMLCanvasElement&&(t.width=l*e.bt,t.height=f*e.bt),t.style.width=l+"px",t.style.height=f+"px")}));return o.observe(s),o}return console.warn("aspectRatioResize: element has no parent and cannot be resized"),null}},999:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.$t=void 0;i.$t=function(t,i,s){var e=s*Math.sqrt(3)/2;return[[t,i-2*e/3],[t+s/2,i*(e/3)],[t-s/2,i*(e/3)]]}},125:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ti=void 0;i.ti=function(t,i,s,e){var n=Math.sqrt(e*e/4-s*s);return[[t,i-2*n/3],[t+e/2,i*(n/3)],[t-e/2,i*(n/3)]]}},932:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ht=void 0;var e=s(965);i.ht=function(t,i,s,n){void 0===n&&(n=5);for(var r=[],o=0,h=n;o<=h;o++){var a=-e.PI/(2*n)+e.$*(o/h);r.push([t+Math.cos(a)*s,i+Math.sin(a)*s])}return r}},166:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ii=void 0;i.ii=function(t,i,s,e,n){return[Math.cos(n)*(t-s)-Math.sin(n)*(i-e)+s,Math.sin(n)*(t-s)+Math.cos(n)*(i-e)+e]}},154:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ot=void 0;var e=s(965);i.ot=function(t,i,s,n,r){void 0===n&&(n=5),void 0===r&&(r=.4);for(var o=[],h=0,a=2*n;h<=a;h++){var u=-e.PI/(2*n)+e.$*(h/a),c=h%2;o.push([t+Math.cos(u)*(0===c?s:s*r),i+Math.sin(u)*(0===c?s:s*r)])}return o}},839:function(t,i,s){"use strict";var e=this&&this.m||(Object.create?function(t,i,s,e){void 0===e&&(e=s),Object.defineProperty(t,e,{M:!0,get:function(){return i[s]}})}:function(t,i,s,e){void 0===e&&(e=s),t[e]=i[s]}),n=this&&this.S||function(t,i){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(i,s)||e(i,t,s)};Object.defineProperty(i,"t",{value:!0}),n(s(712),i),n(s(659),i),n(s(603),i),n(s(147),i),n(s(654),i),n(s(796),i),n(s(90),i),n(s(466),i),n(s(92),i),n(s(358),i),n(s(159),i),n(s(600),i),n(s(965),i),n(s(908),i),n(s(250),i),n(s(482),i),n(s(674),i),n(s(327),i),n(s(326),i),n(s(999),i),n(s(125),i),n(s(932),i),n(s(166),i),n(s(154),i)},603:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.bt=void 0,i.bt=window.devicePixelRatio||1},90:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.si=void 0;i.si=function(t){return JSON.parse(JSON.stringify(t))}},147:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ei=void 0;i.ei=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.every((function(t){return void 0===t}))}},654:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.zt=void 0;i.zt=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.some((function(t){return void 0===t}))}},796:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.xt=void 0;i.xt=function(t){return void 0===t}},466:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ni=void 0;i.ni=function(t){for(new Date;new Date-t<ms;);}},674:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.wt=void 0;var e=s(159),n=function(){function t(t,i){this.x=t,this.y=i}return Object.defineProperty(t.prototype,"ratio",{get:function(){return this.x/this.y},M:!1,ri:!0}),Object.defineProperty(t.prototype,"oi",{get:function(){return Math.pow(Math.pow(this.x,2)+Math.pow(this.y,2),.5)},M:!1,ri:!0}),t.prototype.add=function(t,i){return"number"==typeof t?(this.x+=t,"number"==typeof i&&(this.y+=i)):(this.x+=t.x,this.y+=t.y),this},t.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.hi=function(t){return(0,e.ai)(this.x,this.y,t.x,t.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.normalize=function(){var t=this.oi;return 0!==t&&(this.x/=t,this.y/=t),this},t.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},t.from=function(i,s){return new t(i.x-s.x,i.y-s.y)},t}();i.wt=n},600:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Dt=void 0;i.Dt=function(t,i,s){return Math.max(Math.min(s,t),i)}},92:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ui=i.ci=void 0;var e=s(159);i.ci=function(t,i,s,n,r,o){return(0,e.ai)(t,i,n,r)<=s+o};i.ui=function(t,i,s,e,n,r,o,h){return!(i+e<r||i>r+h||t+s<n||t>n+o)}},965:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.li=i.PI=i.$=void 0;var e=s(674);i.$=2*Math.PI,i.PI=Math.PI,i.li=new e.wt(0,0)},159:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.fi=i.ai=void 0;i.ai=function(t,s,e,n){return Math.pow((0,i.fi)(t,s,e,n),.5)};i.fi=function(t,i,s,e){return Math.pow(s-t,2)+Math.pow(e-i,2)}},908:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.tt=void 0;i.tt=function(t,i,s){return i*(1-t)+s*t}},250:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.di=void 0;i.di=function(t,i){return(t%i+i)%i}},327:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.vi=void 0;i.vi=function(t){return function(){var i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),(((i^=i+Math.imul(i^i>>>7,61|i))^i>>>14)>>>0)/4294967296}}},482:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.normalize=void 0;var e=s(600);i.normalize=function(t,i,s,n){return void 0===n&&(n=!1),((n?(0,e.Dt)(t,i,s):t)-i)/(s-i)}},358:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.random=void 0,i.random=function(t,i,s){if(void 0===t&&(t=1),void 0===i&&(i=0),void 0===s&&(s=Math.random),Array.isArray(t)){var e="function"==typeof i?i:Math.random;return t[Math.floor(e()*t.length)]}if("number"==typeof t&&"number"==typeof i&&"function"==typeof s)return i+s()*(t-i);throw new Error("Invalid args. Check function signature.")}},557:function(t){var i;t.exports=(i=function(){function t(t){return n.appendChild(t.pi),t}function s(t){for(var i=0;i<n.children.length;i++)n.children[i].style.display=i===t?"block":"none";e=t}var e=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),s(++e%n.children.length)}),!1);var r=(performance||Date).now(),o=r,h=0,a=t(new i.gi("FPS","#0ff","#002")),u=t(new i.gi("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new i.gi("MB","#f08","#201"));return s(0),{wi:16,pi:n,mi:t,Mi:s,yi:function(){r=(performance||Date).now()},end:function(){h++;var t=(performance||Date).now();if(u.update(t-r,200),t>o+1e3&&(a.update(1e3*h/(t-o),100),o=t,h=0,c)){var i=performance.memory;c.update(i.bi/1048576,i.Si/1048576)}return t},update:function(){r=this.end()},_i:n,Oi:s}},i.gi=function(t,i,s){var e=1/0,n=0,r=Math.round,o=r(window.devicePixelRatio||1),h=80*o,a=48*o,u=3*o,c=2*o,l=3*o,f=15*o,d=74*o,v=30*o,p=document.createElement("canvas");p.width=h,p.height=a,p.style.cssText="width:80px;height:48px";var g=p.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=s,g.fillRect(0,0,h,a),g.fillStyle=i,g.fillText(t,u,c),g.fillRect(l,f,d,v),g.fillStyle=s,g.globalAlpha=.9,g.fillRect(l,f,d,v),{pi:p,update:function(a,w){e=Math.min(e,a),n=Math.max(n,a),g.fillStyle=s,g.globalAlpha=1,g.fillRect(0,0,h,f),g.fillStyle=i,g.fillText(r(a)+" "+t+" ("+r(e)+"-"+r(n)+")",u,c),g.drawImage(p,l+o,f,d-o,v,l,f,d-o,v),g.fillRect(l+d-o,f,o,v),g.fillStyle=s,g.globalAlpha=.9,g.fillRect(l+d-o,f,o,r((1-a/w)*v))}}},i)}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,s),r.exports}s.n=t=>{var i=t&&t.t?()=>t.default:()=>t;return s.d(i,{a:i}),i},s.d=(t,i)=>{for(var e in i)s.ji(i,e)&&!s.ji(t,e)&&Object.defineProperty(t,e,{M:!0,get:i[e]})},s.ji=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),(()=>{"use strict";var t,i=s(839),e=s(557),n=s.n(e);!function(t){t.xi="gameplay",t.Ri="intro",t.ki="paused",t.Ai="upgrade"}(t||(t={}));const r={move:{zi:!1,Ci:!1,left:!1,right:!1},timestamp:{Ni:0,Pi:-58e3},Ei:{Di:0,level:0,next:0,Wi:0},Li:!1,Ui:[],Ii:[],items:[],Bi:[],Ki:t.Ri,Ti:3,Fi:0,Hi:1550},o=[[[58,15],[55,7],[48,4],[40,7],[37,15],[40,22],[48,26],[55,22],[58,15]],[[87,34],[85,30],[81,29],[14,29],[9,30],[8,34],[9,38],[14,40],[37,40],[37,88],[38,93],[43,95],[45,94],[49,90],[50,80],[52,80],[72,68],[72,62],[58,52],[58,40],[81,40],[85,38],[87,34]],[[50,68],[50,62],[54,65],[50,68]]],h=new i.wt(0,0),a=new i.wt(32,18),u=new i.wt(a.x/2-1,a.y/2-1),c=1/a.x,l=[3178312775,2263286931,486574442,329066167],f="rgb(28,5,50)",d="rgba(0,0,0)",v="rgb(253,93,106)",p="rgb(254,184,18)",g="rgb(111,254,237)",w="rgb(248,96,248)",m="rgb(1,255,185)",M={qi:document.querySelector("canvas#upgrades"),Ji:document.querySelector("canvas#ui"),map:document.querySelector("canvas#map"),Yi:document.querySelector("canvas#gameplay")},y={qi:M.qi.getContext("2d"),Ji:M.Ji.getContext("2d"),map:M.map.getContext("2d"),Yi:M.Yi.getContext("2d")},b={strokeStyle:"white",fillStyle:"white",fontFamily:"Arial, sans-serif",textAlign:"center",textBaseline:"middle",lineWidth:t=>t.width(.00175),fontSize:t=>t.width(.1)},S={P:!0,D:"width",stroke:!0},_={map:new i.A({canvas:M.map,Pt:[0,a.x],Et:[0,a.y]}),upgrade:new i.A({canvas:M.qi,padding:.1}),Ji:new i.A({canvas:M.Ji})},O={map:new i.O(y.map,{...S,coords:_.map,I:{...b,lineWidth:t=>t.width(.001)}}),Yi:new i.O(y.Yi,{...S,coords:_.map,I:{...b},L:.1}),upgrade:new i.O(y.qi,{...S,coords:_.upgrade,I:{...b},L:.05}),Ji:new i.O(y.Ji,{...S,coords:_.Ji,I:{...b}})},j=t=>(0,i.vi)(l[t]),x=[0,100],R=[-1,1],k={Vi:{}};class A{constructor(t){this.Xi="",this.cache={},this.Gi=!1,this.Qi=4,this.Zi=0,this.position=t,this.$i=t.clone()}get ts(){if("ts"in this.cache)return this.cache.ts;const t=this.position.clone().add(this.ss/2,this.ss/2);return this.cache.ts=t,t}get key(){if("key"in this.cache)return this.cache.key;const t=[String(this.Xi),String(this.es),JSON.stringify(this.options)].join("~");return this.cache.key=t,t}ns(t,s){const e=this.key;e in k.Vi&&k.Vi[e].length||(console.info("Cached sprite not found. Regenerating. Key: "+e),k.Vi[this.key]=((t,s,e,n,r)=>{const o=[];t.ut(t.options.I);for(let h=0;h<n;h++){const n=document.createElement("canvas");n.width=e,n.height=e;const a=n.getContext("2d"),u=new i.O(a,{...t.options,I:{...t.options.I,lineWidth:t.context.lineWidth},coords:new i.A({canvas:n,Pt:r,Et:r}),random:j(h)});s(u),u.context.save(),u.context.fillStyle="rgba(255,0,0,0.2)",u.context.fillRect(0,0,n.width,n.height),u.context.restore(),o.push(n)}return o})(O.Yi,this.rs,O.Yi.coords.width(c*this.ss),this.Qi,this.os));const n=k.Vi[e][this.Zi];O.Yi.drawImage(n,(0,i.tt)(t,this.$i.x,this.position.x),(0,i.tt)(t,this.$i.y,this.position.y),s),O.Yi.st(this.ts.x,this.ts.y,this.es*c,{I:{strokeStyle:"red"}})}update(t,i,s){this.$i.set(this.position),this.ts.x=this.position.x+this.ss/2,this.ts.y=this.position.y+this.ss/2,this.Zi=Math.floor(t/r.Hi%1*this.Qi)}}const z=new class extends A{constructor(t){super(t),this.es=.75,this.ss=1.5,this.Xi=0,this.speed=.005,this.os=x,this.hs="right",this.us={I:{scale:{origin:this.ts,scale:new i.wt(-1,1)}}},this.options={I:{fillStyle:w},fill:!0},this.rs=t=>{o.forEach((i=>{t.Y(i,this.options)}))},this.update=(t,i)=>{super.update(t,i),this.cs(t,i)},this.cs=(t,s)=>{const e=s*this.speed,n=.7071*e;let o=0,h=0;r.move.left&&r.move.zi?(o=-n,h=-n):r.move.left&&r.move.Ci?(o=-n,h=n):r.move.right&&r.move.zi?(o=n,h=-n):r.move.right&&r.move.Ci?(o=n,h=n):r.move.zi?h=-e:r.move.Ci?h=e:r.move.left?o=-e:r.move.right&&(o=e),this.position.x=(0,i.Dt)(this.position.x+o,0,a.x-1),this.position.y=(0,i.Dt)(this.position.y+h,0,a.y-1)}}ns(t){super.ns(t,"left"===this.hs?this.us:void 0)}}(u.clone()),C={6:{ls:[10,11,12.5,15,18,21.5,26.5],range:[1.5,1.55,1.65,1.8,2,2.25,2.55],fs:[1,2,3,4,5,6,7]},7:{ds:[.07,.09,.11,.15,.2,.25,.34],vs:[1.5,1.55,1.65,1.85,2.15,2.65,3.15]},8:{ls:[6,6.5,7.5,9,11,13.5,17],frequency:[1,1.5,2,3,4,6,8]},9:{ls:[3,4,6,9,13,18,24],vs:[1.5,1.7,2,2.4,2.9,3.5,4.2]},10:{ls:[16,18,21,25,30,36,43],frequency:[.5,.6,.7,.9,1.1,1.4,1.7]}};class N extends A{constructor(t,s=z.ts.clone()){super(s),this.size=.25,this.ps=!1,this.gs=(t,s,e)=>{for(let n=0;n<r.Ui.length;n++){const o=r.Ui[n];(0,i.ci)(this.ts.x,this.ts.y,this.es,o.ts.x,o.ts.y,o.es)&&(o.ls(t,s,e,this.Xi),this.ps&&(this.Gi=!0))}},this.parent=t}update(t,i,s){super.update(t,i),this.cs(t,i,s),this.gs(this.parent.ls,s,t)}}class P extends N{constructor(t,s){super(t,z.position.clone()),this.os=R,this.ss=1,this.es=.05,this.Xi=8,this.options=void 0,this.ps=!0,this.rs=t=>{t.Y([[-1,0],[1,0]]),t.Y([[-.75,-.4],[-1,0],[-.75,.4]])},this.cs=(t,i)=>{this.$i.set(this.position),this.position.x+=this.ws.x*this.parent.speed,this.position.y+=this.ws.y*this.parent.speed},this.ws=i.wt.from(s,this.ts).normalize(),this.Ms=this.ws.angle()+i.PI,this.ys={I:{rotation:{origin:this.ts,rotation:this.Ms}}}}ns(t){super.ns(t,this.ys)}}class E extends class{constructor(){this.bs=[],r.Ii.push(this)}Ss(){return this.level<7}ns(t){for(let i=0;i<this.bs.length;i++)this.bs[i].ns(t)}update(t,i){for(let s=0;s<this.bs.length;s++)this.bs[s].Gi?this.bs.splice(s,1):this.bs[s].update(t,i,s)}}{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this._s=0,this.upgrade=()=>{this.Ss()&&this.level++}}get Os(){return C[8]}get frequency(){return 1e3/this.Os.frequency[this.level-1]}get ls(){return this.Os.ls[this.level-1]}update(t,i){if(super.update(t,i),t-this._s>this.frequency){this._s=t;const i=this.js();i&&this.bs.push(new P(this,i.ts))}for(let s=0;s<this.bs.length;s++){const e=this.bs[s];e.update(t,i,s),e.ts.hi(z.ts)>this.range&&(e.Gi=!0)}}js(){let t,i=1/0;for(let s=0;s<r.Ui.length;s++){const e=z.ts.hi(r.Ui[s].ts);e<i&&(i=e,t=r.Ui[s])}return t}}const D={xs:[],Rs:[],ks:[],As:[],zs:[],Cs:[],Ns:[],Ps:[]};let W=0;const L=(t,i)=>(D[t].push({id:W,Es:i}),W++,W-1),U=(t,...i)=>{const s=D[t];for(let t=0;t<s.length;t++)s[t].Es(...i)};new ResizeObserver((()=>{U("CanvasResize")})).observe(M.map),window.addEventListener("keydown",(t=>{U("KeyDown",t.key)})),window.addEventListener("keyup",(t=>{U("KeyUp",t.key)})),window.addEventListener("resize",(t=>{U("WindowResize")}));const I=()=>{r.Ei.Wi=r.Ei.Di,r.Ei.level++,r.Ei.next=50*r.Ei.level,U("StateChange",t.Ai)},B=()=>{O.upgrade.options.random=j(0),O.upgrade.clear();for(let t=0;t<r.Ti;t++){const s=new i.A({offsetX:O.upgrade.coords.St(-1)+O.upgrade.coords.width(t/r.Ti),offsetY:O.upgrade.coords._t(-1),Ct:O.upgrade.coords.width()/r.Ti,Nt:O.upgrade.coords.height(),padding:.05}),e=new i.O(O.upgrade.context,{...O.upgrade.options,coords:s,stroke:!1});e.rect(-1,-1,1,e.coords.height()/e.coords.width(),{stroke:r.Fi===t,fill:!0,I:{fillStyle:"rgba(255,255,255,.5)"}}),e.text("TEST",0,-.8,{I:{textBaseline:"top"}})}},K=()=>{const t=(r.Ei.Di-r.Ei.Wi)/(r.Ei.next-r.Ei.Wi);console.log("drawing",t),O.Ji.rect(-1,-1,1,1,{fill:!1,L:0,stroke:!0}),O.Ji.rect(-1,-1,t,1,{fill:!0,L:0,I:{fillStyle:m}})},T=[[[22,38],[35,87],[37,89],[44,92],[55,92],[60,89],[64,84],[76,38],[74,35],[59,22],[49,20],[38,22],[29,29],[22,38]],[[31,52],[45,55],[40,61],[35,59],[31,52]],[[58,61],[56,60],[54,55],[67,52],[62,59],[58,61]],[[58,25],[59,17],[63,12],[68,8],[76,7],[83,8],[88,12],[92,17],[94,25],[93,29],[89,38]],[[74,35],[89,52],[86,54],[83,55],[79,55],[75,51],[72,40],[74,35]],[[40,25],[38,17],[34,12],[29,8],[22,7],[15,8],[10,12],[6,17],[5,29],[9,38]],[[25,35],[9,52],[11,54],[14,55],[19,55],[22,51],[25,40],[25,35]]];class F extends A{constructor(t,i){super(t),this.Ds=t=>{this.Gi=!0},this.Ws=i}update(t,i,s){super.update(t,i),this.cs(t,i,s)}cs(t,s,e){this.Ws.Ls&&((t,s,e,n)=>{const r=i.wt.from(z.position,t);if(!e.start&&r.oi<e.ai)e.start=s;else if(e.start&&r.oi<.5)e.Us(n);else if(e.start){const i=s-e.start;r.normalize();const n=r.clone().multiply(.0015*i-.25);t.x+=n.x,t.y+=n.y}})(this.position,t,this.Ws.Ls,e)}}class H extends F{constructor(t,i){let s;super(t,{Ls:{ai:3,Is:t.clone(),Us:t=>{r.Ei.Di+=i,K(),this.Ds(t)}}}),this.os=R,this.ss=1,this.es=.25,this.Xi=11,this.rs=t=>{t.ot(0,0,this.es,5,.4,this.options)},this.Ei=i,s=this.Ei<20?0:this.Ei<50?1:2,this.options={I:H.I[s],fill:!0}}}H.I={0:{fillStyle:p,strokeStyle:p},1:{fillStyle:g,strokeStyle:g},2:{fillStyle:w,strokeStyle:w}};const q=(0,s(257).i)({o:.5,u:1,h:.2,l:2});class J extends A{constructor(t,s,e){super(J.Bs(t.ts.clone(),t)),this.es=.5,this.ss=1,this.duration=500,this.Ks={I:{scale:{origin:h,scale:new i.wt(1,1)}}},this.options=void 0,this.os=R,this.ns=t=>{super.ns(t,this.Ks)},this.rs=t=>{t.text(this.text,0,0,{fill:!0,I:{fontSize:t=>t.width(.35),textBaseline:"top"},L:.3})},this.target=t,this.Xi=s,this.text=s,this.start=e}static Bs(t,i){return t.x=i.ts.x-.5,t.y=i.ts.y-1.5,t}update(t,i){super.update(t,0,i);const s=q((t-this.start)/this.duration);this.Ks.I.scale.origin=this.ts,this.Ks.I.scale.scale.x=s,this.Ks.I.scale.scale.y=s,J.Bs(this.position,this.target),t-this.start>=this.duration&&(this.Gi=!0)}}class Y extends A{constructor(t,i,s){super(t),this.speed=.00175,this.Ts=1e3,this.Fs={},this.options={I:{fillStyle:d},fill:!0},this.Ws=i,this.Hs=s,this.qs=s}Js(t){O.Yi.text(String(t),this.ts.x,this.ts.y-this.ss/2)}ls(t,i,s,e){const n=this.Fs[e];n&&s-n<this.Ts||(this.Hs-=t,r.Bi.push(new J(this,String(t),s)),this.Hs<=0&&this.Ds(),this.Fs[e]=s)}Ds(){const t=new H(this.ts.clone(),this.qs);t.position.add(-t.ss/2,-t.ss/2),r.items.push(t),this.Gi=!0}update(t,i){super.update(t,i),this.cs(t,i)}cs(t,s){this.Ws.Ys&&((t,s,e)=>{const n=i.wt.from(z.position,t).normalize().multiply(s*e.Vs);t.x+=n.x,t.y+=n.y})(this.position,s,this.Ws.Ys),this.Ws.Xs&&((t,s,e)=>{const n=i.wt.from(z.position,t);if(n.oi<e.ai){const i=n.normalize().multiply(s*e.Ys);t.x+=i.x,t.y+=i.y}else{if(t.equals(e.Gs))return;if(t.hi(e.Gs)<.1)t.set(e.Gs);else{const n=i.wt.from(e.Gs,t).normalize().multiply(s*e.Ys);t.x+=n.x,t.y+=n.y}}})(this.position,s,this.Ws.Xs)}}class V extends Y{constructor(t,i){super(t,{Xs:{Ys:.002,ai:3,Gs:t.clone()}},i),this.os=x,this.ss=1,this.Xi=1,this.es=.5,this.rs=t=>{T.forEach((i=>t.Y(i,this.options)))}}}const X=[[[87,35],[83,21],[80,15],[70,6],[57,1],[43,1],[30,6],[20,15],[15,28],[14,35],[9,39],[7,47],[9,54],[14,59],[18,72],[26,84],[37,92],[44,95],[57,95],[63,92],[74,84],[82,72],[87,59],[94,50],[95,47],[92,39],[87,35]],[[87,45],[76,44],[76,35],[80,34],[80,41],[83,41],[87,45]],[[78,63],[76,68],[76,65],[78,63]],[[63,74],[63,63],[71,63],[73,65],[73,74],[63,74]],[[45,74],[43,73],[43,65],[45,63],[57,63],[57,74],[45,74]],[[29,74],[30,63],[38,63],[40,65],[40,73],[29,74]],[[24,63],[25,68],[24,63]],[[22,30],[25,24],[25,29],[22,30]],[[57,19],[57,30],[43,29],[43,21],[45,19],[57,19]],[[78,30],[76,29],[76,24],[78,30]],[[73,58],[71,60],[63,60],[62,56],[58,54],[57,60],[45,60],[43,58],[43,54],[40,56],[38,60],[30,60],[29,35],[38,34],[40,35],[40,38],[43,40],[43,35],[45,34],[57,34],[58,40],[62,38],[63,34],[73,35],[73,58]],[[29,29],[29,19],[38,19],[40,21],[40,29],[29,29]],[[73,19],[73,29],[63,30],[63,19],[73,19]],[[63,16],[62,11],[70,16],[63,16]],[[40,14],[38,16],[31,16],[40,11],[40,14]],[[58,9],[57,16],[45,16],[43,14],[43,9],[58,9]],[[18,41],[21,41],[21,35],[24,34],[25,44],[14,45],[18,41]],[[18,52],[14,49],[25,50],[24,60],[22,60],[21,53],[18,52]],[[31,78],[40,79],[40,86],[31,78]],[[43,88],[43,79],[58,79],[58,88],[43,88]],[[62,86],[63,78],[71,78],[62,86]],[[83,52],[80,53],[78,60],[76,58],[76,50],[87,49],[83,52]],[[38,41],[33,42],[32,47],[33,50],[38,52],[41,50],[43,47],[41,42],[38,41]],[[63,41],[59,42],[58,47],[59,50],[63,52],[67,50],[69,47],[67,42],[63,41]]];const G=[[[37,36],[46,37],[53,42],[57,48],[60,58],[59,66],[56,69],[49,74],[46,84],[37,87],[31,86],[28,84],[26,74],[17,69],[14,62],[17,48],[21,42],[28,37],[37,36]],[[63,95],[68,71],[69,59],[67,45],[64,35],[58,28],[47,21],[37,19],[27,21],[15,28],[10,35],[7,45],[6,59],[6,71],[12,95]],[[14,61],[15,79],[21,95]],[[61,61],[59,79],[54,95]],[[77,21],[45,10],[29,9],[20,9],[12,13],[17,8],[25,4],[44,2],[71,6],[92,13],[77,21]],[[94,9],[82,95]],[[42,51],[39,53],[40,59],[43,63],[46,63],[51,60],[53,55],[53,51],[47,48],[42,51]],[[37,63],[34,66],[33,71],[41,71],[40,66],[37,63]],[[33,51],[30,49],[24,49],[22,51],[20,55],[24,60],[30,63],[34,59],[35,56],[33,51]]];const Q=[[[95,56],[75,43],[51,35],[43,53],[40,65],[40,82],[44,91],[49,95],[54,96],[65,94],[72,90],[86,74],[96,59],[95,56]],[[53,85],[49,80],[47,68],[56,79],[71,80],[59,85],[53,85]],[[73,71],[67,65],[76,65],[81,72],[73,71]],[[54,62],[49,55],[57,56],[63,62],[54,62]],[[39,47],[33,49],[27,56],[31,45],[36,42],[42,42],[44,36],[48,29],[52,29],[57,31],[55,20],[49,2],[24,7],[2,19],[11,42],[23,57],[35,63],[39,47]],[[43,22],[51,25],[43,29],[35,25],[43,22]],[[25,36],[16,38],[20,31],[29,29],[25,36]]];const Z=[[[58,46],[68,43],[75,40],[74,43],[70,50],[63,50],[60,49],[58,46]],[[49,3],[35,6],[24,14],[16,26],[14,40],[16,62],[23,78],[34,88],[49,94],[62,89],[73,79],[81,63],[84,40],[81,26],[73,14],[62,6],[49,3]],[[46,48],[45,59],[37,54],[34,57],[31,63],[32,73],[43,84],[35,81],[26,74],[21,63],[19,50],[19,34],[22,24],[29,14],[41,7],[32,17],[31,32],[33,37],[39,41],[42,38],[43,31],[46,43],[43,45],[46,48]],[[56,85],[64,76],[68,68],[66,59],[61,54],[58,55],[54,59],[53,48],[56,46],[53,44],[54,33],[56,31],[58,40],[62,40],[65,37],[68,28],[66,18],[58,7],[69,14],[76,24],[79,34],[79,50],[77,63],[75,70],[69,77],[62,82],[56,85]],[[41,46],[30,43],[23,40],[23,43],[27,50],[35,50],[38,49],[41,46]]];class $ extends A{constructor(t,s){super(t),this.Gi=!1,this.Xi=12,this.es=1.5,this.ss=3,this.duration=2500,this.Qs=r.Hi/2,this.options=void 0,this.os=R,this.rs=t=>{t.rect(-.2,-.8,.2,.8,{I:{rotation:{origin:h,rotation:i.PI/4},fillStyle:v},fill:!0,stroke:!1}),t.rect(-.2,-.8,.2,.8,{I:{rotation:{origin:h,rotation:-i.PI/4},fillStyle:v},fill:!0,stroke:!1})},this.start=s}update(t,i){super.update(t,0,i),t-this.start>$.duration&&(this.Gi=!0)}}$.duration=2500;const tt=[0,1,2,3],it=[class extends Y{constructor(t,i){super(t,{Ys:{Vs:.002}},i),this.os=x,this.ss=1,this.Xi=3,this.es=.5,this.rs=t=>{Z.forEach((i=>t.Y(i,this.options)))}}},class extends Y{constructor(t,i){super(t,{Ys:{Vs:.002}},i),this.os=x,this.ss=2,this.Xi=2,this.es=1,this.rs=t=>{Q.forEach((i=>t.Y(i,this.options)))}}},class extends Y{constructor(t,i){super(t,{Ys:{Vs:.002}},i),this.os=x,this.ss=1,this.Xi=4,this.es=.5,this.speed=.002,this.rs=t=>{X.forEach((i=>t.Y(i,this.options)))}}},class extends Y{constructor(t,i){super(t,{Ys:{Vs:.002}},i),this.os=x,this.ss=1,this.Xi=5,this.es=.5,this.rs=t=>{G.forEach((i=>t.Y(i,this.options)))}}}],st=t=>{const s=(t-r.timestamp.Pi-6e4)/$.duration;if(s<1&&!r.Li){const s=(0,i.random)(.8*a.x,.1),e=(0,i.random)(.8*a.y,.1),n=new $(new i.wt(s,e),t);r.Li=n,r.Bi.push(n)}else if(s>1&&r.Li){const s=Math.floor((0,i.random)(16,12));for(let t=0;t<s;t++){const e=r.Li.ts.x+1.5*Math.cos(i.$*t/s),n=r.Li.ts.y+1.5*Math.sin(i.$*t/s);r.Ui.push(new V(new i.wt(e,n),5))}r.timestamp.Pi=t,r.Li=!1}};let et;const nt=new(n()),rt=nt.mi(new(n().gi)("phys","#0ff","#002"));nt.pi.id="stats",document.body.appendChild(nt.pi);const ot=1e3/60;let ht=0,at=0,ut=0;const ct=(i=0)=>{nt.yi();const s=r.Ki!==t.xi?0:i-at;for(at=i,ut+=Math.min(s,50);ut>=ot;)lt(),ut-=ot,ht+=ot;ft(ut/ot),nt.end(),window.requestAnimationFrame(ct)},lt=()=>{rt.update(59.99999999999999,200),z.update(ht,ot);for(let t=r.Ii.length-1;t>=0;t--)r.Ii[t].update(ht,ot);for(let t=r.Ui.length-1;t>=0;t--)r.Ui[t].Gi?r.Ui.splice(t,1):r.Ui[t].update(ht,ot);for(let t=r.items.length-1;t>=0;t--)r.items[t].Gi?r.items.splice(t,1):r.items[t].update(ht,ot,t);for(let t=r.Bi.length-1;t>=0;t--)r.Bi[t].Gi?r.Bi.splice(t,1):r.Bi[t].update(ht,t);(t=>{const s=1e3*(9e5-Math.max(0,t)/1e3)/1e6;if(t-r.timestamp.Ni>=s){r.timestamp.Ni=t;const s=(0,i.random)(it),e=(0,i.random)(tt);let n,o;0===e&&(n=(0,i.random)(a.x),o=0),1===e&&(n=(0,i.random)(a.x),o=a.y),2===e&&(n=0,o=(0,i.random)(a.y)),3===e&&(n=0,o=(0,i.random)(a.y)),r.Ui.push(new s(new i.wt(n,o),5))}t-r.timestamp.Pi>=6e4&&st(t)})(ht)},ft=t=>{O.Yi.clear();for(let i=0;i<r.Ui.length;i++)r.Ui[i].ns(t);for(let i=0;i<r.Ii.length;i++)r.Ii[i].ns(t);for(let i=0;i<r.items.length;i++)r.items[i].ns(t);for(let i=0;i<r.Bi.length;i++)r.Bi[i].ns(t);z.ns(t)};(0,i.Zt)(M.map,a),(0,i.Zt)(M.Yi,a),(0,i.Zt)(M.qi,a),L("KeyDown",(s=>{"Enter"===s&&r.Ii.forEach((t=>t.upgrade())),"Shift"===s&&(console.log(s),r.Ei.Di=r.Ei.next,U("LevelUp")),"Escape"===s&&r.Ki===t.xi&&U("StateChange",t.ki),"ArrowLeft"!==s&&"a"!==s||(r.Ki===t.xi&&(r.move.left=!0,z.hs="left"),r.Ki===t.Ai&&(r.Fi=(0,i.di)(r.Fi-1,r.Ti),B())),"ArrowRight"!==s&&"d"!==s||(r.Ki===t.xi&&(r.move.right=!0,z.hs="right"),r.Ki===t.Ai&&(r.Fi=(0,i.di)(r.Fi+1,r.Ti),B())),"ArrowUp"!==s&&"w"!==s||(r.move.zi=!0),"ArrowDown"!==s&&"s"!==s||(r.move.Ci=!0)})),L("KeyUp",(i=>{"ArrowLeft"!==i&&"a"!==i||(r.move.left=!1),"ArrowRight"!==i&&"d"!==i||(r.move.right=!1),"ArrowUp"!==i&&"w"!==i||(r.move.zi=!1),"ArrowDown"!==i&&"s"!==i||(r.move.Ci=!1),"Enter"===i&&r.Ki===t.ki&&U("StateChange",t.xi)})),L("CanvasResize",(()=>{for(const t in k.Vi)k.Vi[t].length=0;(()=>{for(let t=0;t<a.x;t++)for(let i=0;i<a.y;i++)O.map.rect(t,i,1/a.x,1/a.y,{I:{strokeStyle:"rgba(255,255,255,0.1)"}})})();const s=M.map.getBoundingClientRect();M.Ji.style.height=String(.05*s.height),M.Ji.style.left=String(s.left),M.Ji.style.top=String(s.top-M.Ji.clientHeight),M.Ji.style.width=String(s.width),M.Ji.width=M.Ji.clientWidth*i.bt,M.Ji.height=M.Ji.clientHeight*i.bt,K(),r.Ki===t.Ai&&B()})),L("WindowResize",(()=>{const t=M.map.getBoundingClientRect();M.Ji.style.height=String(.05*t.height),M.Ji.style.left=String(t.left),M.Ji.style.top=String(t.top-M.Ji.clientHeight),M.Ji.style.width=String(t.width)})),L("StateChange",(i=>{if(i===t.Ai)r.Fi=0,B(),et=L("CanvasResize",B);i!==t.Ai&&(t=>{let i;for(i in D)for(let s=D[i].length-1;s>=0;s--)D[i][s].id===t&&D[i].splice(s,1)})(et),r.Ki=i})),L("LevelUp",I),L("Initialize",(()=>{document.body.style.backgroundColor=f,M.map.style.zIndex="-1",I(),new E})),U("Initialize"),U("StateChange",t.xi),window.requestAnimationFrame(ct)})()})();</script></body></html>