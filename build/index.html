<html><head><link href="main.css" rel="stylesheet"></head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><title>Bardo</title><body class="full"><div id="root"><canvas id="ui"></canvas><canvas id="upgrades"></canvas><canvas id="map"></canvas><canvas id="gameplay"></canvas></div><script>(()=>{var t={705:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.i=void 0;s.i=function(t){var s=void 0===t?{}:t,i=s.h,e=void 0===i?0:i,n=s.o,h=void 0===n?-1:n,r=s.u,o=void 0===r?1:r,a=s.l,u=void 0===a?1:a,c=s.v,l=void 0===c?0:c,f=s.g,d=void 0===f?0:f,v=s.p,g=void 0!==v&&v;if(e<h||e>o)throw new Error("yStart must be between yMin and yMax");var p=2*Math.PI,w=(h+o)/2,m=(o-h)/2,y=g?-1:1,M=Math.asin(2*(e-h)/(o-h)-1)*(u/p);return function(t){return w+m*Math.sin(y*(p*(t-l+M))/u)+d}}},257:function(t,s,i){"use strict";var e=this&&this.m||(Object.create?function(t,s,i,e){void 0===e&&(e=i),Object.defineProperty(t,e,{M:!0,get:function(){return s[i]}})}:function(t,s,i,e){void 0===e&&(e=i),t[e]=s[i]}),n=this&&this.S||function(t,s){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(s,i)||e(s,t,i)};Object.defineProperty(s,"t",{value:!0}),n(i(705),s)},712:function(t,s,i){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var n in s=arguments[i])Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);return t},e.apply(this,arguments)};Object.defineProperty(s,"t",{value:!0}),s.O=s.j=void 0;var n=i(839),h=i(603),r=i(674);!function(t){t.k="width",t.C="height"}(s.j||(s.j={}));var o=function(){function t(t,s){var i;void 0===s&&(s={}),this.context=t,this.coords=null!==(i=s.coords)&&void 0!==i?i:new n.R({canvas:t.canvas});var h={beginPath:!0,closePath:!1,fill:!1,A:-1,N:!0,stroke:!1,P:!1,L:!1,D:!1,W:0,U:!1,random:Math.random};this.options=e(e({},h),s),this.options.I=e(e({},{fontFamily:"sans-serif",fontSize:16}),s.I)}return t.prototype.rect=function(t,s,i,e,n){void 0===t&&(t=0),void 0===s&&(s=0),void 0===i&&(i=1),void 0===e&&(e=1),void 0===n&&(n={}),this.B("roughness",n)?this.q(t,s,i,e,n):this.F(t,s,i,e,n)},t.prototype.q=function(t,s,i,n,h){var r=this.K(t),o=this.T(s),a=this.H(i),u=this.$(n),c=[[r,o],[r+a,o],[r+a,o+u],[r,o+u],[r,o]];this.J(c,e(e({},h),{P:!1,N:!0,U:!0}))},t.prototype.F=function(t,s,i,e,n){this.Y(n),this.context.rect(this.K(t,n),this.T(s,n),this.H(i),this.$(e)),this.V(n)},t.prototype.J=function(t,s){void 0===s&&(s={}),this.B("roughness",s)?this.X(t,s):this.G(t,s)},t.prototype.G=function(t,s){this.Y(s);for(var i=0;i<t.length;i++){var e=this.K(t[i][0],s),n=this.T(t[i][1],s);0===i?this.context.moveTo(e,n):this.context.lineTo(e,n)}this.V(s)},t.prototype.X=function(t,s){for(var i=this.B("roughness",s)||0,h=this.B("random",s),r=t.length-1,o=0;o<2;o++){for(var a=[],u=0;u<r;u++)for(var c=t[u],l=c[0],f=c[1],d=t[u+1],v=d[0],g=d[1],p=i*Math.sqrt(Math.pow(l-v,2)+Math.pow(f-g,2)),w=0;w<4;w++){var m=h()*p,y=h()*n.Z,M=m*Math.cos(y),b=m*Math.sin(y),S=NaN,_=NaN;if(0===w&&(S=l+M,_=f+b),1===w){var x=.5;S=(0,n.tt)(x,l,v)+M,_=(0,n.tt)(x,f,g)+b}if(2===w){x=.75;S=(0,n.tt)(x,l,v)+M,_=(0,n.tt)(x,f,g)+b}3===w&&(s.U&&u===r-1?(S=a[0][0],_=a[0][1]):(S=v+M,_=g+b)),a.push([S,_])}var O=0===o?s:e(e({},s),{fill:!1});this.st(a,O)}},t.prototype.st=function(t,s){var i=this;void 0===s&&(s={}),this.Y(s);for(var e=0;e<t.length-1;e++){var n=this.K(t[e][0],s),h=this.T(t[e][1],s);if(0===e)this.context.moveTo(n,h);else{var r=this.K(t[e+1][0],s),o=this.T(t[e+1][1],s);if(r===n&&o===h)this.context.lineTo(r,o);else{var a=(n+r)/2,u=(h+o)/2;this.context.quadraticCurveTo(n,h,a,u)}}}t.slice(-1).forEach((function(t){i.context.lineTo(i.K(t[0],s),i.T(t[1],s))})),this.V(s)},t.prototype.it=function(t,s,i,e){void 0===e&&(e={}),this.B("roughness",e)?this.et(t,s,i,e):this.nt(t,s,i,e)},t.prototype.nt=function(t,s,i,e){this.Y(e),this.context.arc(this.K(t,e),this.T(s,e),this.ht(i,e),0,n.Z),this.V(e)},t.prototype.et=function(t,s,i,h){for(var r=this.B("roughness",h),o=this.B("random",h),a=r*this.ht(i,h)/window.innerWidth,u=0;u<2;u++){for(var c=[],l=0;l<16;l++){var f=o()*a,d=o()*n.Z,v=f*Math.cos(d),g=f*Math.sin(d),p=n.Z*l/16,w=this.K(t+v,h)+Math.cos(p)*this.ht(i,h),m=this.T(s+g,h)+Math.sin(p)*this.ht(i,h);c.push([w,m])}c[16]=c[0],c[17]=c[1],this.st(c,e(e({},h),{P:!1,N:!0,U:!0}))}},t.prototype.drawImage=function(t,s,i,e){void 0===e&&(e={}),this.Y(e),this.context.drawImage(t,this.K(s,e),this.T(i,e)),this.V(e)},t.prototype.rt=function(t,s,i,h,r,o){void 0===o&&(o={}),this.J((0,n.rt)(this.K(t,o),this.T(s,o),this.ht(i,o),h,r),e(e({},o),{P:!1,N:!0}))},t.prototype.ot=function(t,s,i,h,r){void 0===r&&(r={});var o=this.B("roughness",r);this.J((0,n.ot)(this.K(t,r),this.T(s,r),this.ht(i,r),h),e(e({},r),{P:!1,N:!0,U:Boolean(o)}))},t.prototype.ut=function(t){this.ct(e(e({},this.options.I),t))},t.prototype.text=function(t,s,i,e){void 0===e&&(e={}),this.B("roughness",e)?this.lt(t,s,i,e):this.ft(t,s,i,e)},t.prototype.ft=function(t,s,i,e){void 0===e&&(e={}),this.Y(e);var n=this.B("maxTextWidth",e);this.context.fillText(t,this.K(s,e),this.T(i,e),n>0?n:void 0),this.V(e)},t.prototype.lt=function(t,s,i,h){var o=this;void 0===h&&(h={});var a=this.dt(t,h.I),u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent,l=a.width,f=this.B("roughness",h),d=this.B("random",h),v=t.split(""),g=u-c,p=this.coords.vt(g),w=l/v.length,m=this.coords.gt(w)-this.coords.gt(0),y=m*v.length;this.ut(h.I),v.forEach((function(t,a){var u,c;if("left"===o.context.textAlign)c=(u=s+m*a)+m/2;else if("right"===o.context.textAlign)c=(u=-y+s+m*(a+1))-m/2;else{if("center"!==o.context.textAlign)throw new Error("textAlign must be 'left', 'right', or 'center' to use rough text");c=u=-y/2+s+m*(.5+a)}var v,g=i;if("top"===o.context.textBaseline)v=g-p/2;else if("bottom"===o.context.textBaseline)v=g-p/2;else{if("middle"!==o.context.textBaseline)throw new Error("textBaseline must be 'top', 'bottom', or 'middle' to use rough text");v=g}var w=f*l*.05,M=[(0,n.random)(Math.min(.4,w/6.5),0,d)*m,(0,n.random)(Math.min(.4,w/6.5),0,d)*m],b=[(0,n.random)(Math.min(.4,w/6.5),0,d)*p,(0,n.random)(Math.min(.4,w/6.5),0,d)*p];o.ft(t,u+M[0],g+b[0],e(e({},h),{I:e(e({},h.I),{rotation:{origin:new r.wt(c,v),rotation:w*Math.PI/16}})})),o.ft(t,u+M[1],g+b[1],e(e({},h),{I:e(e({},h.I),{rotation:{origin:new r.wt(c,v),rotation:-w*Math.PI/16}})}))}))},t.prototype.clear=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.prototype.yt=function(t,s){void 0===s&&(s={}),t.width=t.clientWidth*(s.Mt?h.bt:1),t.height=t.clientHeight*(s.Mt?h.bt:1)},t.prototype.K=function(t,s){return void 0===s&&(s={}),this.B("useNormalCoordinates",s)?this.coords.St(t):t},t.prototype.T=function(t,s){return void 0===s&&(s={}),this.B("useNormalCoordinates",s)?this.coords._t(t):t},t.prototype.H=function(t){return this.coords.width(t)},t.prototype.$=function(t){return this.coords.height(t)},t.prototype.ht=function(t,s){void 0===s&&(s={});var i=this.B("scalarNormalization",s);return"width"===i?this.coords.width(t):"height"===i?this.coords.height(t):t},t.prototype.B=function(t,s){var i=s&&t in s?s[t]:this.options[t];return console.assert(null!=i,"A value for ".concat(i," could not be resolved.")),i},t.prototype.xt=function(t,s){var i=s&&t in s?s[t]:this.options.I[t];return"function"==typeof i?i(this.coords):i},t.prototype.Ot=function(t){var s=this.xt("fontSize",t),i=this.xt("lineHeight",t),e=this.xt("fontStyle",t),n=this.xt("fontFamily",t),h=this.xt("fontWeight",t),r=this.xt("fontStretch",t),o="number"==typeof s?"".concat(s,"px"):void 0;return i&&o&&(o="".concat(s," / ").concat(i,"}")),[o,n,e,h,r].join(" ").trim()},t.prototype.ct=function(t){for(var s in t){var i=this.xt(s,t);if(!(0,n.jt)(i)){if("transform"===s&&this.context.setTransform(i),"translation"===s){var e=i,h=e.x,r=e.y;this.context.translate(this.K(h),this.T(r))}if("rotation"===s)if("number"==typeof i)this.context.rotate(i);else{var o=i,a=o.rotation,u=o.origin,c=this.K(u.x),l=this.T(u.y);this.context.translate(c,l),this.context.rotate(a),this.context.translate(-c,-l)}if("scale"===s)if("origin"in i){var f=i,d=f.origin,v=f.scale,g=f.kt,p=void 0!==g&&g;c=this.K(d.x),l=this.T(d.y);this.context.translate(c,l),this.context.scale(v.x,v.y),this.context.translate(-c,-l),p&&(this.context.lineWidth=this.context.lineWidth*(1/((v.x+v.y)/2)))}else{var w=i;h=w.x,r=w.y;this.context.scale(h,r)}"lineDash"===s&&this.context.setLineDash(i),"alpha"===s&&(this.context.globalAlpha=i),s in this.context&&"function"!=typeof this.context[s]&&(this.context[s]=this.xt(s,t))}}this.context.font=this.Ot(t)},t.prototype.Y=function(t){void 0===t&&(t={}),this.B("saveAndRestore",t)&&this.context.save(),this.B("skipApplyStyles",t)||this.ut(t.I),this.B("beginPath",t)&&this.context.beginPath()},t.prototype.V=function(t){this.B("closePath",t)&&this.context.closePath(),this.B("fill",t)&&this.context.fill(),this.B("stroke",t)&&this.context.stroke(),this.B("saveAndRestore",t)&&this.context.restore()},t.prototype.dt=function(t,s){this.context.save(),this.ut(s);var i=this.context.measureText(t);return this.context.restore(),i},t}();s.O=o},659:function(t,s,i){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var n in s=arguments[i])Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);return t},e.apply(this,arguments)};Object.defineProperty(s,"t",{value:!0}),s.R=void 0;var n,h=i(654),r=i(796),o=i(908),a=i(482);!function(t){t.Ct="up",t.Rt="down"}(n||(n={}));var u=function(){function t(t){if(void 0===t&&(t={}),(0,r.jt)(t.canvas)&&(0,h.At)(t.zt,t.Nt))throw new Error("Invalid options. A canvas element must be supplied if baseHeight or baseWidth are not defined.");Object.assign(this,e(e({},{Pt:[-1,1],Et:[-1,1],Lt:!1,orientationY:"down",Dt:!1}),t))}return t.prototype.Wt=function(){var t;return null!==(t=this.zt)&&void 0!==t?t:this.canvas.width},t.prototype.Ut=function(){return this.Wt()-2*this.It()},t.prototype.Bt=function(){var t;return null!==(t=this.Nt)&&void 0!==t?t:this.canvas.height},t.prototype.qt=function(){return this.Bt()-2*this.Ft()},t.prototype.Kt=function(){var t,s;return null!==(s=null!==(t=this.Tt)&&void 0!==t?t:this.padding)&&void 0!==s?s:0},t.prototype.It=function(){return this.Kt()*this.Wt()},t.prototype.Ht=function(){return(0,r.jt)(this.$t)?(0,r.jt)(this.padding)?0:this.Dt?this.padding*(this.Wt()/this.Bt()):this.padding:this.$t},t.prototype.Ft=function(){return this.Ht()*this.Bt()},t.prototype.Jt=function(){var t;return null!==(t=this.offsetX)&&void 0!==t?t:0},t.prototype.Yt=function(){var t;return null!==(t=this.offsetY)&&void 0!==t?t:0},t.prototype.St=function(t){var s=(0,a.normalize)(t,this.Pt[0],this.Pt[1],this.Lt);return this.It()+this.Jt()+s*this.Ut()},t.prototype._t=function(t){var s=(0,a.normalize)(t,this.Et[0],this.Et[1],this.Lt),i=this.Vt===n.Ct;return this.Ft()+this.Yt()+(i?1-s:s)*this.qt()},t.prototype.gt=function(t){var s=(0,a.normalize)(t,this.It(),this.It()+this.width(),this.Lt);return(0,o.tt)(s,this.Pt[0],this.Pt[1])},t.prototype.Xt=function(t){var s=(0,a.normalize)(t,this.Ft(),this.Ft()+this.height(),this.Lt);return(0,o.tt)(s,this.Pt[0],this.Pt[1])},t.prototype.width=function(t){return this.Ut()*(null!=t?t:1)},t.prototype.height=function(t){return this.qt()*(null!=t?t:1)},t.prototype.Gt=function(t){return this.gt(t)-this.gt(0)},t.prototype.vt=function(t){return this.Xt(t)-this.Xt(0)},t}();s.R=u},326:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Qt=void 0;var e=i(839);s.Qt=function(t,s){if(t.parentElement){var i=t.parentElement,n=s.x,h=s.y,r=new ResizeObserver((function(){var s=i.getBoundingClientRect(),r=s.width,o=s.height,a=Math.min(r/n,o/h),u=t.clientWidth,c=t.clientHeight,l=Math.round(a*n),f=Math.round(a*h);l===u&&f===c||(t instanceof HTMLCanvasElement&&(t.width=l*e.bt,t.height=f*e.bt),t.style.width=l+"px",t.style.height=f+"px")}));return r.observe(i),r}return console.warn("aspectRatioResize: element has no parent and cannot be resized"),null}},999:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Zt=void 0;s.Zt=function(t,s,i){var e=i*Math.sqrt(3)/2;return[[t,s-2*e/3],[t+i/2,s*(e/3)],[t-i/2,s*(e/3)]]}},125:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ts=void 0;s.ts=function(t,s,i,e){var n=Math.sqrt(e*e/4-i*i);return[[t,s-2*n/3],[t+e/2,s*(n/3)],[t-e/2,s*(n/3)]]}},932:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ot=void 0;var e=i(965);s.ot=function(t,s,i,n){void 0===n&&(n=5);for(var h=[],r=0,o=n;r<=o;r++){var a=-e.PI/(2*n)+e.Z*(r/o);h.push([t+Math.cos(a)*i,s+Math.sin(a)*i])}return h}},166:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ss=void 0;s.ss=function(t,s,i,e,n){return[Math.cos(n)*(t-i)-Math.sin(n)*(s-e)+i,Math.sin(n)*(t-i)+Math.cos(n)*(s-e)+e]}},154:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.rt=void 0;var e=i(965);s.rt=function(t,s,i,n,h){void 0===n&&(n=5),void 0===h&&(h=.4);for(var r=[],o=0,a=2*n;o<=a;o++){var u=-e.PI/(2*n)+e.Z*(o/a),c=o%2;r.push([t+Math.cos(u)*(0===c?i:i*h),s+Math.sin(u)*(0===c?i:i*h)])}return r}},839:function(t,s,i){"use strict";var e=this&&this.m||(Object.create?function(t,s,i,e){void 0===e&&(e=i),Object.defineProperty(t,e,{M:!0,get:function(){return s[i]}})}:function(t,s,i,e){void 0===e&&(e=i),t[e]=s[i]}),n=this&&this.S||function(t,s){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(s,i)||e(s,t,i)};Object.defineProperty(s,"t",{value:!0}),n(i(712),s),n(i(659),s),n(i(603),s),n(i(147),s),n(i(654),s),n(i(796),s),n(i(90),s),n(i(466),s),n(i(92),s),n(i(358),s),n(i(159),s),n(i(600),s),n(i(965),s),n(i(908),s),n(i(250),s),n(i(482),s),n(i(674),s),n(i(327),s),n(i(326),s),n(i(999),s),n(i(125),s),n(i(932),s),n(i(166),s),n(i(154),s)},603:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.bt=void 0,s.bt=window.devicePixelRatio||1},90:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.es=void 0;s.es=function(t){return JSON.parse(JSON.stringify(t))}},147:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ns=void 0;s.ns=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return t.every((function(t){return void 0===t}))}},654:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.At=void 0;s.At=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return t.some((function(t){return void 0===t}))}},796:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.jt=void 0;s.jt=function(t){return void 0===t}},466:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.hs=void 0;s.hs=function(t){for(new Date;new Date-t<ms;);}},674:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.wt=void 0;var e=i(159),n=function(){function t(t,s){this.x=t,this.y=s}return Object.defineProperty(t.prototype,"ratio",{get:function(){return this.x/this.y},M:!1,rs:!0}),Object.defineProperty(t.prototype,"os",{get:function(){return Math.pow(Math.pow(this.x,2)+Math.pow(this.y,2),.5)},M:!1,rs:!0}),t.prototype.add=function(t,s){return"number"==typeof t?(this.x+=t,"number"==typeof s&&(this.y+=s)):(this.x+=t.x,this.y+=t.y),this},t.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.us=function(t){return(0,e.cs)(this.x,this.y,t.x,t.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.normalize=function(){var t=this.os;return 0!==t&&(this.x/=t,this.y/=t),this},t.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},t.from=function(s,i){return new t(s.x-i.x,s.y-i.y)},t}();s.wt=n},600:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Lt=void 0;s.Lt=function(t,s,i){return Math.max(Math.min(i,t),s)}},92:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ls=s.fs=void 0;var e=i(159);s.fs=function(t,s,i,n,h,r){return(0,e.cs)(t,s,n,h)<=i+r};s.ls=function(t,s,i,e,n,h,r,o){return!(s+e<h||s>h+o||t+i<n||t>n+r)}},965:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ds=s.PI=s.Z=void 0;var e=i(674);s.Z=2*Math.PI,s.PI=Math.PI,s.ds=new e.wt(0,0)},159:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.vs=s.cs=void 0;s.cs=function(t,i,e,n){return Math.pow((0,s.vs)(t,i,e,n),.5)};s.vs=function(t,s,i,e){return Math.pow(i-t,2)+Math.pow(e-s,2)}},908:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.tt=void 0;s.tt=function(t,s,i){return s*(1-t)+i*t}},250:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.gs=void 0;s.gs=function(t,s){return(t%s+s)%s}},327:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ps=void 0;s.ps=function(t){return function(){var s=t+=1831565813;return s=Math.imul(s^s>>>15,1|s),(((s^=s+Math.imul(s^s>>>7,61|s))^s>>>14)>>>0)/4294967296}}},482:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.normalize=void 0;var e=i(600);s.normalize=function(t,s,i,n){return void 0===n&&(n=!1),((n?(0,e.Lt)(t,s,i):t)-s)/(i-s)}},358:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.random=void 0,s.random=function(t,s,i){if(void 0===t&&(t=1),void 0===s&&(s=0),void 0===i&&(i=Math.random),Array.isArray(t)){var e="function"==typeof s?s:Math.random;return t[Math.floor(e()*t.length)]}if("number"==typeof t&&"number"==typeof s&&"function"==typeof i)return s+i()*(t-s);throw new Error("Invalid args. Check function signature.")}},557:function(t){var s;t.exports=(s=function(){function t(t){return n.appendChild(t.ws),t}function i(t){for(var s=0;s<n.children.length;s++)n.children[s].style.display=s===t?"block":"none";e=t}var e=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),i(++e%n.children.length)}),!1);var h=(performance||Date).now(),r=h,o=0,a=t(new s.ys("FPS","#0ff","#002")),u=t(new s.ys("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new s.ys("MB","#f08","#201"));return i(0),{Ms:16,ws:n,bs:t,Ss:i,_s:function(){h=(performance||Date).now()},end:function(){o++;var t=(performance||Date).now();if(u.update(t-h,200),t>r+1e3&&(a.update(1e3*o/(t-r),100),r=t,o=0,c)){var s=performance.memory;c.update(s.xs/1048576,s.Os/1048576)}return t},update:function(){h=this.end()},js:n,ks:i}},s.ys=function(t,s,i){var e=1/0,n=0,h=Math.round,r=h(window.devicePixelRatio||1),o=80*r,a=48*r,u=3*r,c=2*r,l=3*r,f=15*r,d=74*r,v=30*r,g=document.createElement("canvas");g.width=o,g.height=a,g.style.cssText="width:80px;height:48px";var p=g.getContext("2d");return p.font="bold "+9*r+"px Helvetica,Arial,sans-serif",p.textBaseline="top",p.fillStyle=i,p.fillRect(0,0,o,a),p.fillStyle=s,p.fillText(t,u,c),p.fillRect(l,f,d,v),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(l,f,d,v),{ws:g,update:function(a,w){e=Math.min(e,a),n=Math.max(n,a),p.fillStyle=i,p.globalAlpha=1,p.fillRect(0,0,o,f),p.fillStyle=s,p.fillText(h(a)+" "+t+" ("+h(e)+"-"+h(n)+")",u,c),p.drawImage(g,l+r,f,d-r,v,l,f,d-r,v),p.fillRect(l+d-r,f,r,v),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(l+d-r,f,r,h((1-a/w)*v))}}},s)}},s={};function i(e){var n=s[e];if(void 0!==n)return n.exports;var h=s[e]={exports:{}};return t[e].call(h.exports,h,h.exports,i),h.exports}i.n=t=>{var s=t&&t.t?()=>t.default:()=>t;return i.d(s,{a:s}),s},i.d=(t,s)=>{for(var e in s)i.Cs(s,e)&&!i.Cs(t,e)&&Object.defineProperty(t,e,{M:!0,get:s[e]})},i.Cs=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),(()=>{"use strict";var t,s=i(839),e=i(557),n=i.n(e);!function(t){t.Rs="gameplay",t.As="intro",t.zs="paused",t.Ns="upgrade"}(t||(t={}));const h={move:{Ps:!1,Es:!1,left:!1,right:!1},timestamp:{Ls:0,Ds:-58e3},Ws:100,Us:{Is:0,level:0,next:0,Bs:0},qs:!1,Fs:[],Ks:[],items:[],Ts:[],Hs:t.As,$s:3,Js:[],Ys:0,Vs:1550},r=[[[58,15],[55,7],[48,4],[40,7],[37,15],[40,22],[48,26],[55,22],[58,15]],[[87,34],[85,30],[81,29],[14,29],[9,30],[8,34],[9,38],[14,40],[37,40],[37,88],[38,93],[43,95],[45,94],[49,90],[50,80],[52,80],[72,68],[72,62],[58,52],[58,40],[81,40],[85,38],[87,34]],[[50,68],[50,62],[54,65],[50,68]]],o={Xs:document.querySelector("canvas#upgrades"),Gs:document.querySelector("canvas#ui"),map:document.querySelector("canvas#map"),Qs:document.querySelector("canvas#gameplay")},a={Xs:o.Xs.getContext("2d"),Gs:o.Gs.getContext("2d"),map:o.map.getContext("2d"),Qs:o.Qs.getContext("2d")},u=new s.wt(0,0),c=new s.wt(32,18),l=new s.wt(c.x/2-1,c.y/2-1),f=1/c.x,d={strokeStyle:"white",fillStyle:"white",fontFamily:"Comic Sans MS, Chalkboard SE, Comic Neue sans-serif",textAlign:"center",textBaseline:"middle",lineWidth:t=>t.width(.00175),fontSize:t=>t.width(.1)},v={P:!0,L:"width",stroke:!0},g={map:new s.R({canvas:o.map,Pt:[0,c.x],Et:[0,c.y]}),upgrade:new s.R({canvas:o.Xs,padding:.1}),Gs:new s.R({canvas:o.Gs})},p={map:new s.O(a.map,{...v,coords:g.map,I:{...d,lineWidth:t=>t.width(.001)}}),Qs:new s.O(a.Qs,{...v,coords:g.map,I:{...d},W:.1}),upgrade:new s.O(a.Xs,{...v,coords:g.upgrade,I:{...d,lineWidth:t=>t.width(.0175)},W:.02}),Gs:new s.O(a.Gs,{...v,coords:g.Gs,I:{...d}})},w=[3178312775,2263286931,486574442,329066167],m="#fff",y="rgb(28,5,50)",M="rgba(0,0,0)",b="rgb(253,93,106)",S="rgb(254,184,18)",_="rgb(111,254,237)",x="rgb(248,96,248)",O="rgb(1,255,185)",j=t=>(0,s.ps)(w[t]),k=[0,100],C=[-1,1],R={Zs:{}};class A{constructor(t){this.ti="",this.cache={},this.si=!1,this.ii=new s.wt(0,0),this.ei=new s.wt(0,0),this.ni=new s.wt(0,0),this.hi=4,this.ri=0,this.position=t,this.oi=t.clone()}get ai(){if("ai"in this.cache)return this.cache.ai;const t=this.position.clone().add(this.ui/2,this.ui/2);return this.cache.ai=t,t}get key(){if("key"in this.cache)return this.cache.key;const t=[String(this.ti),String(this.ci),JSON.stringify(this.options)].join("~");return this.cache.key=t,t}li(t){this.ni.x=(0,s.tt)(t,this.oi.x,this.position.x),this.ni.y=(0,s.tt)(t,this.oi.y,this.position.y),this.ei.x=(0,s.tt)(t,this.ii.x,this.ai.x),this.ei.y=(0,s.tt)(t,this.ii.y,this.ai.y)}fi(t,i,e=!0){const n=this.key,h=n in R.Zs&&R.Zs[n].length;e&&this.li(t),h||(R.Zs[this.key]=((t,i,e,n,h)=>{const r=[];t.ut(t.options.I);for(let o=0;o<n;o++){const n=document.createElement("canvas");n.width=e,n.height=e;const a=n.getContext("2d");i(new s.O(a,{...t.options,I:{...t.options.I,lineWidth:t.context.lineWidth},coords:new s.R({canvas:n,Pt:h,Et:h}),random:j(o)})),r.push(n)}return r})(p.Qs,this.di,p.Qs.coords.width(f*this.ui),this.hi,this.vi));const r=R.Zs[n][this.ri];p.Qs.drawImage(r,this.ni.x,this.ni.y,i)}update(t,s,i){this.oi.set(this.position),this.ii.set(this.ai),this.ai.x=this.position.x+this.ui/2,this.ai.y=this.position.y+this.ui/2,this.ri=Math.floor(t/h.Vs%1*this.hi)}}const z=new class extends A{constructor(t){super(t),this.gi=0,this.pi=100,this.Ws=100,this.ci=.75,this.ui=1.5,this.ti=0,this.speed=.005,this.vi=k,this.wi="right",this.mi={I:{}},this.options={I:{fillStyle:x},fill:!0},this.di=t=>{r.forEach((s=>{t.J(s,this.options)}))},this.update=(t,s)=>{super.update(t,s),this.yi(t,s)},this.yi=(t,i)=>{const e=i*this.speed,n=.7071*e;let r=0,o=0;h.move.left&&h.move.Ps?(r=-n,o=-n):h.move.left&&h.move.Es?(r=-n,o=n):h.move.right&&h.move.Ps?(r=n,o=-n):h.move.right&&h.move.Es?(r=n,o=n):h.move.Ps?o=-e:h.move.Es?o=e:h.move.left?r=-e:h.move.right&&(r=e),this.position.x=(0,s.Lt)(this.position.x+r,0,c.x-1),this.position.y=(0,s.Lt)(this.position.y+o,0,c.y-1)}}get Mi(){const t=.1;return this.position.y<c.y*t?0:this.position.y>.9*c.y?1:this.position.x<c.x*t?2:this.position.x>.9*c.x&&3}fi(t){this.li(t),super.fi(t,"left"===this.wi?this.mi:void 0,!1),p.Qs.rect(this.ei.x-.5,this.ei.y+this.ci,f*this.Ws/this.pi,f/10,{fill:!0,stroke:!1,W:0,I:{fillStyle:b}})}bi(t){if(!(t<this.gi+200))for(let i=0;i<h.Fs.length;i++){const e=h.Fs[i];(0,s.fs)(this.position.x,this.position.y,this.ci,e.position.x,e.position.y,e.ci)&&this.Si(e._i,t)}}Si(t,s){this.gi=s,this.Ws-=t}}(l.clone()),N={6:{xi:[10,11,12.5,15,18,21.5,26.5],range:[1.5,1.55,1.65,1.8,2,2.25,2.55],Oi:[1,2,3,4,5,6,7]},7:{ji:[.07,.09,.11,.15,.2,.25,.34],ki:[1.5,1.55,1.65,1.85,2.15,2.65,3.15]},8:{xi:[6,6.5,7.5,9,11,13.5,17],frequency:[1,1.5,2,3,4,6,8]},9:{xi:[3,4,6,9,13,18,24],ki:[1.5,1.7,2,2.4,2.9,3.5,4.2]},10:{xi:[16,18,21,25,30,36,43],frequency:[.5,.6,.7,.9,1.1,1.4,1.7]}};class P extends A{constructor(t,i=z.ai.clone()){super(i),this.size=.25,this.Ci=!1,this.Ri=(t,i,e)=>{for(let n=0;n<h.Fs.length;n++){const r=h.Fs[n];(0,s.fs)(this.ai.x,this.ai.y,this.ci,r.ai.x,r.ai.y,r.ci)&&(r.xi(t,i,e,this.ti),this.Ci&&(this.si=!0))}},this.parent=t}update(t,s,i){super.update(t,s),this.yi(t,s,i),this.Ri(this.parent.xi,i,t)}}class E{constructor(){this.Ai=[],h.Ks.push(this)}zi(){return this.level<7}fi(t){for(let s=0;s<this.Ai.length;s++)this.Ai[s].fi(t)}update(t,s){for(let i=0;i<this.Ai.length;i++)this.Ai[i].si?this.Ai.splice(i,1):this.Ai[i].update(t,s,i)}}class L extends P{constructor(t,i){super(t,z.position.clone()),this.vi=C,this.ui=1,this.ci=.05,this.ti=8,this.options=void 0,this.Ci=!0,this.di=t=>{t.J([[-1,0],[1,0]]),t.J([[-.75,-.4],[-1,0],[-.75,.4]])},this.yi=(t,s)=>{this.oi.set(this.position),this.position.x+=this.Ni.x*this.parent.speed,this.position.y+=this.Ni.y*this.parent.speed},this.Ni=s.wt.from(i,this.ai).normalize(),this.Pi=this.Ni.angle()+s.PI,this.Ei={I:{rotation:{origin:this.ai,rotation:this.Pi}}}}fi(t){super.fi(t,this.Ei)}}class D extends E{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this.Li=0,this.type=8,this.upgrade=()=>{this.zi()&&this.level++}}get Di(){return N[8]}get frequency(){return 1e3/this.Di.frequency[this.level-1]}get xi(){return this.Di.xi[this.level-1]}update(t,s){if(super.update(t,s),t-this.Li>this.frequency){this.Li=t;const s=this.Wi();s&&this.Ai.push(new L(this,s.ai))}for(let i=0;i<this.Ai.length;i++){const e=this.Ai[i];e.update(t,s,i),e.ai.us(z.ai)>this.range&&(e.si=!0)}}Wi(){let t,s=1/0;for(let i=0;i<h.Fs.length;i++){const e=z.ai.us(h.Fs[i].ai);e<s&&(s=e,t=h.Fs[i])}return t}}const W={Ui:[],Ii:[],Bi:[],qi:[],Fi:[],Ki:[],Ti:[],Hi:[]};let U=0;const I=(t,s)=>(W[t].push({id:U,$i:s}),U++,U-1),B=(t,...s)=>{const i=W[t];for(let t=0;t<i.length;t++)i[t].$i(...s)};new ResizeObserver((()=>{B("CanvasResize")})).observe(o.map),window.addEventListener("keydown",(t=>{B("KeyDown",t.key)})),window.addEventListener("keyup",(t=>{B("KeyUp",t.key)})),window.addEventListener("resize",(t=>{B("WindowResize")}));const q=[.4,.2,.6],F=[0,.2,.6];class K extends P{constructor(t,i,e){super(t,i),this.vi=C,this.ui=2,this.ci=.5,this.ti=10,this.options=void 0,this.di=t=>{const s=-1/3;t.J([[s,0],[s,0-q[0]/2],[s+F[1],0-q[1]/2],[s+F[2],0-q[2]/2],[s+F[2],0+q[2]/2],[s+F[1],0+q[1]/2],[s,0+q[0]/2],[s,0]]),t.J([[s+F[1],.8],[s+F[1],0+q[0]/2]])},this.yi=(t,i)=>{this.oi.set(this.position);const e=(0,s.normalize)(t,this.start,this.start+this.parent.duration),n=-s.PI/2-e*s.PI;this.parent.Ji(this.position,n,this.Yi),this.position.add(-this.ui/2,-this.ui/2)},this.start=e,this.Yi="left"===z.wi?1:-1,this.Ei={I:{rotation:{origin:this.ai,rotation:this.Yi*-Math.PI/4},scale:{origin:this.ai,scale:new s.wt(-1*this.Yi,1)}}}}fi(t){super.fi(t,this.Ei)}}class T extends E{constructor(){super(),this.level=1,this.range=1.7,this.speed=.09,this.duration=500,this.Li=0,this.type=10,this.upgrade=()=>{this.zi()&&this.level++}}get Di(){return N[10]}get frequency(){return 1e3/this.Di.frequency[this.level-1]}Ji(t,s,i){t.x=z.ai.x+i*Math.cos(i*s)*this.range,t.y=z.ai.y+i*Math.sin(i*s)*this.range}get xi(){return this.Di.xi[this.level-1]}update(t,i){if(super.update(t,i),t-this.Li>this.frequency){this.Li=t;const i=z.position.clone();this.Ji(i,-s.PI/2,1),i.add(-.5,-.5),this.Ai.push(new K(this,i,t))}for(let s=0;s<this.Ai.length;s++){const e=this.Ai[s];e.update(t,i,s),t-e.start>this.duration&&(e.si=!0)}}}class H extends P{constructor(t,i){super(t),this.vi=C,this.ti=9,this.options=void 0,this.di=t=>{t.it(0,0,.5,{I:{fillStyle:x,alpha:.1},fill:!0}),t.it(0,0,.5,{I:{strokeStyle:x}}),t.it(0,0,.4,{I:{strokeStyle:x}});for(let i=0;i<5;i++){const e=.3*Math.cos(s.Z*i/5),n=.3*Math.sin(s.Z*i/5);t.it(e,n,.2,{I:{strokeStyle:x}})}},this.yi=(t,s)=>{this.oi.set(this.position)},this.start=i,this.Vi={I:{scale:new s.wt(this.parent.ki,this.parent.ki)}},this.oi.add(-this.ci,-this.ci),this.position.add(-this.ci,-this.ci)}get ci(){return this.parent.ki}get ui(){return 2*this.ci}}class $ extends E{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this.Li=0,this.frequency=1500,this.duration=1500,this.type=9,this.upgrade=()=>{this.zi()&&this.level++}}get Di(){return N[9]}get ki(){return this.Di.ki[this.level-1]}get xi(){return this.Di.xi[this.level-1]}update(t,s){super.update(t,s),t-this.Li>this.frequency&&(this.Li=t,this.Ai.push(new H(this,t)));for(let i=0;i<this.Ai.length;i++){const e=this.Ai[i];e.update(t,s,i),t-e.start>this.duration&&(e.si=!0)}}}class J extends P{constructor(t){super(t),this.vi=C,this.ui=1,this.ti=6,this.ci=.25,this.offset=0,this.options=void 0,this.di=t=>{t.it(0,0,this.ci,{I:{fillStyle:x},fill:!0})},this.yi=(t,i)=>{this.oi.set(this.position);const e=this.offset+s.Z*(t/this.parent.l),n=z.ai.x+Math.cos(e)*this.parent.range-this.ui/2,h=z.ai.y+Math.sin(e)*this.parent.range-this.ui/2;this.position.x=(0,s.tt)(1-this.parent.Xi,this.oi.x,n),this.position.y=(0,s.tt)(1-this.parent.Xi,this.oi.y,h)}}}class Y extends E{constructor(){super(),this.level=1,this.Xi=.33,this.l=2e3,this.type=6,this.upgrade=()=>{if(this.zi())for(this.level++;this.Ai.length<this.Oi;)this.Ai.push(new J(this)),this.Ai.forEach(((t,i)=>t.offset=s.Z*i/this.Ai.length))},this.Ai.push(new J(this))}get Di(){return N[6]}get Oi(){return this.Di.Oi[this.level-1]}get range(){return this.Di.range[this.level-1]}get xi(){return this.Di.xi[this.level-1]}}const V=[8,10,6,9],X=()=>{h.Us.Bs=h.Us.Is,h.Us.level++,h.Us.next=50*Math.pow(h.Us.level,2),h.Js.length=0,h.Js=(t=>{const s=V.map((t=>{const s=h.Ks.find((s=>s.type===t)),i=(s?.level??0)+1;let e,n;switch(t){case 8:1===i?e=()=>new D:s&&(e=()=>s.upgrade()),n=`Arrow - L${i}`;break;case 10:1===i?e=()=>new T:s&&(e=()=>s.upgrade()),n=`Axe - L${i}`;break;case 6:1===i?e=()=>new Y:s&&(e=()=>s.upgrade()),n=`Orb - L${i}`;break;case 9:1===i?e=()=>new $:s&&(e=()=>s.upgrade()),n=`Summoning Circle - L${i}`;break;default:throw new Error}return{text:n,Gi:e}})),i=[];for(let e=0;e<t;e++){const t=Math.floor(Math.random()*s.length);i.push(s[t]),s.splice(t,1)}return i})(h.$s),B("StateChange",t.Ns)},G=()=>{p.upgrade.options.random=j(0),p.upgrade.clear();for(let t=0;t<h.$s;t++){const i=h.Js[t],e=new s.R({offsetX:p.upgrade.coords.St(-1)+p.upgrade.coords.width(t/h.$s),offsetY:p.upgrade.coords._t(-1),zt:p.upgrade.coords.width()/h.$s,Nt:p.upgrade.coords.height(),padding:.05}),n=new s.O(p.upgrade.context,{...p.upgrade.options,coords:e,stroke:!1});n.rect(-1,-1,1,1,{stroke:!0,fill:!0,I:{fillStyle:y,strokeStyle:h.Ys===t?O:m}}),n.text(i.text,0,-.8,{I:{textBaseline:"top",fillStyle:h.Ys===t?O:m},W:0,A:e.width(.9)})}},Q=()=>{const t=(h.Us.Is-h.Us.Bs)/(h.Us.next-h.Us.Bs);p.Gs.clear(),p.Gs.rect(-1,-1,1,1,{fill:!1,W:0,stroke:!0}),p.Gs.rect(-1,-1,t,1,{fill:!0,W:0,I:{fillStyle:O}})},Z=[[[22,38],[35,87],[37,89],[44,92],[55,92],[60,89],[64,84],[76,38],[74,35],[59,22],[49,20],[38,22],[29,29],[22,38]],[[31,52],[45,55],[40,61],[35,59],[31,52]],[[58,61],[56,60],[54,55],[67,52],[62,59],[58,61]],[[58,25],[59,17],[63,12],[68,8],[76,7],[83,8],[88,12],[92,17],[94,25],[93,29],[89,38]],[[74,35],[89,52],[86,54],[83,55],[79,55],[75,51],[72,40],[74,35]],[[40,25],[38,17],[34,12],[29,8],[22,7],[15,8],[10,12],[6,17],[5,29],[9,38]],[[25,35],[9,52],[11,54],[14,55],[19,55],[22,51],[25,40],[25,35]]];class tt extends A{constructor(t,s){super(t),this.Qi=t=>{this.si=!0},this.Zi=s}update(t,s,i){super.update(t,s),this.yi(t,s,i)}yi(t,i,e){this.Zi.te&&((t,i,e,n)=>{const h=s.wt.from(z.position,t);if(!e.start&&h.os<e.cs)e.start=i;else if(e.start&&h.os<.5)e.se(n);else if(e.start){const s=i-e.start;h.normalize();const n=h.clone().multiply(.0015*s-.25);t.x+=n.x,t.y+=n.y}})(this.position,t,this.Zi.te,e)}}class st extends tt{constructor(t,s){let i;super(t,{te:{cs:3,ie:t.clone(),se:t=>{h.Us.Is+=s,h.Us.Is>h.Us.next&&B("LevelUp"),Q(),this.Qi(t)}}}),this.vi=C,this.ui=1,this.ci=.25,this.ti=11,this.di=t=>{t.rt(0,0,this.ci,5,.4,this.options)},this.Us=s,i=this.Us<20?0:this.Us<50?1:2,this.options={I:st.I[i],fill:!0}}}st.I={0:{fillStyle:S,strokeStyle:S},1:{fillStyle:_,strokeStyle:_},2:{fillStyle:x,strokeStyle:x}};const it=(0,i(257).i)({h:.5,u:1,o:.2,l:2});class et extends A{constructor(t,i,e){super(et.ee(t.ai.clone(),t)),this.ci=.5,this.ui=1,this.duration=500,this.Vi={I:{scale:{origin:u,scale:new s.wt(1,1)}}},this.options=void 0,this.vi=C,this.fi=t=>{super.fi(t,this.Vi)},this.di=t=>{t.text(this.text,0,0,{fill:!0,I:{fontSize:t=>t.width(.35),textBaseline:"top"},W:0})},this.target=t,this.ti=i,this.text=i,this.start=e}static ee(t,s){return t.x=s.ai.x-.5,t.y=s.ai.y-1.5,t}update(t,s){super.update(t,0,s);const i=it((t-this.start)/this.duration);this.Vi.I.scale.origin=this.ai,this.Vi.I.scale.scale.x=i,this.Vi.I.scale.scale.y=i,et.ee(this.position,this.target),t-this.start>=this.duration&&(this.si=!0)}}class nt extends A{constructor(t,s,i){super(t),this._i=5,this.speed=.00155,this.ne=1e3,this.he={},this.options={I:{fillStyle:M},fill:!0},this.Zi=s,this.Ws=i,this.pi=i}re(t){p.Qs.text(String(t),this.ai.x,this.ai.y-this.ui/2,{W:0})}xi(t,s,i,e){const n=this.he[e];n&&i-n<this.ne||(this.Ws-=t,h.Ts.push(new et(this,String(t),i)),this.Ws<=0&&this.Qi(),this.he[e]=i)}Qi(){const t=new st(this.ai.clone(),this.pi);t.position.add(-t.ui/2,-t.ui/2),h.items.push(t),this.si=!0}update(t,s){super.update(t,s),this.yi(t,s)}yi(t,i){this.Zi.oe&&((t,i,e)=>{const n=s.wt.from(z.position,t).normalize().multiply(i*e.ae);t.x+=n.x,t.y+=n.y})(this.position,i,this.Zi.oe),this.Zi.ue&&((t,i,e)=>{const n=s.wt.from(z.position,t);if(n.os<e.cs){const s=n.normalize().multiply(i*e.oe);t.x+=s.x,t.y+=s.y}else{if(t.equals(e.ce))return;if(t.us(e.ce)<.1)t.set(e.ce);else{const n=s.wt.from(e.ce,t).normalize().multiply(i*e.oe);t.x+=n.x,t.y+=n.y}}})(this.position,i,this.Zi.ue)}}class ht extends nt{constructor(t,s){super(t,{ue:{oe:.002,cs:3,ce:t.clone()}},s),this.vi=k,this.ui=1,this.ti=1,this.ci=.5,this.di=t=>{Z.forEach((s=>t.J(s,this.options)))}}}ht.le=7;const rt=[[[87,35],[83,21],[80,15],[70,6],[57,1],[43,1],[30,6],[20,15],[15,28],[14,35],[9,39],[7,47],[9,54],[14,59],[18,72],[26,84],[37,92],[44,95],[57,95],[63,92],[74,84],[82,72],[87,59],[94,50],[95,47],[92,39],[87,35]],[[87,45],[76,44],[76,35],[80,34],[80,41],[83,41],[87,45]],[[78,63],[76,68],[76,65],[78,63]],[[63,74],[63,63],[71,63],[73,65],[73,74],[63,74]],[[45,74],[43,73],[43,65],[45,63],[57,63],[57,74],[45,74]],[[29,74],[30,63],[38,63],[40,65],[40,73],[29,74]],[[24,63],[25,68],[24,63]],[[22,30],[25,24],[25,29],[22,30]],[[57,19],[57,30],[43,29],[43,21],[45,19],[57,19]],[[78,30],[76,29],[76,24],[78,30]],[[73,58],[71,60],[63,60],[62,56],[58,54],[57,60],[45,60],[43,58],[43,54],[40,56],[38,60],[30,60],[29,35],[38,34],[40,35],[40,38],[43,40],[43,35],[45,34],[57,34],[58,40],[62,38],[63,34],[73,35],[73,58]],[[29,29],[29,19],[38,19],[40,21],[40,29],[29,29]],[[73,19],[73,29],[63,30],[63,19],[73,19]],[[63,16],[62,11],[70,16],[63,16]],[[40,14],[38,16],[31,16],[40,11],[40,14]],[[58,9],[57,16],[45,16],[43,14],[43,9],[58,9]],[[18,41],[21,41],[21,35],[24,34],[25,44],[14,45],[18,41]],[[18,52],[14,49],[25,50],[24,60],[22,60],[21,53],[18,52]],[[31,78],[40,79],[40,86],[31,78]],[[43,88],[43,79],[58,79],[58,88],[43,88]],[[62,86],[63,78],[71,78],[62,86]],[[83,52],[80,53],[78,60],[76,58],[76,50],[87,49],[83,52]],[[38,41],[33,42],[32,47],[33,50],[38,52],[41,50],[43,47],[41,42],[38,41]],[[63,41],[59,42],[58,47],[59,50],[63,52],[67,50],[69,47],[67,42],[63,41]]];class ot extends nt{constructor(t,s){super(t,{oe:{ae:.002}},s),this.vi=k,this.ui=1,this.ti=4,this.ci=.5,this.speed=.002,this.di=t=>{rt.forEach((s=>t.J(s,this.options)))}}}ot.le=13;const at=[[[37,36],[46,37],[53,42],[57,48],[60,58],[59,66],[56,69],[49,74],[46,84],[37,87],[31,86],[28,84],[26,74],[17,69],[14,62],[17,48],[21,42],[28,37],[37,36]],[[63,95],[68,71],[69,59],[67,45],[64,35],[58,28],[47,21],[37,19],[27,21],[15,28],[10,35],[7,45],[6,59],[6,71],[12,95]],[[14,61],[15,79],[21,95]],[[61,61],[59,79],[54,95]],[[77,21],[45,10],[29,9],[20,9],[12,13],[17,8],[25,4],[44,2],[71,6],[92,13],[77,21]],[[94,9],[82,95]],[[42,51],[39,53],[40,59],[43,63],[46,63],[51,60],[53,55],[53,51],[47,48],[42,51]],[[37,63],[34,66],[33,71],[41,71],[40,66],[37,63]],[[33,51],[30,49],[24,49],[22,51],[20,55],[24,60],[30,63],[34,59],[35,56],[33,51]]];class ut extends nt{constructor(t,s){super(t,{oe:{ae:.002}},s),this.vi=k,this.ui=1,this.ti=5,this.ci=.5,this.di=t=>{at.forEach((s=>t.J(s,this.options)))}}}ut.le=15;const ct=[[[95,56],[75,43],[51,35],[43,53],[40,65],[40,82],[44,91],[49,95],[54,96],[65,94],[72,90],[86,74],[96,59],[95,56]],[[53,85],[49,80],[47,68],[56,79],[71,80],[59,85],[53,85]],[[73,71],[67,65],[76,65],[81,72],[73,71]],[[54,62],[49,55],[57,56],[63,62],[54,62]],[[39,47],[33,49],[27,56],[31,45],[36,42],[42,42],[44,36],[48,29],[52,29],[57,31],[55,20],[49,2],[24,7],[2,19],[11,42],[23,57],[35,63],[39,47]],[[43,22],[51,25],[43,29],[35,25],[43,22]],[[25,36],[16,38],[20,31],[29,29],[25,36]]];class lt extends nt{constructor(t,s){super(t,{oe:{ae:.002}},s),this.vi=k,this.ui=2,this.ti=2,this.ci=1,this.di=t=>{ct.forEach((s=>t.J(s,this.options)))}}}lt.le=10;const ft=[[[58,46],[68,43],[75,40],[74,43],[70,50],[63,50],[60,49],[58,46]],[[49,3],[35,6],[24,14],[16,26],[14,40],[16,62],[23,78],[34,88],[49,94],[62,89],[73,79],[81,63],[84,40],[81,26],[73,14],[62,6],[49,3]],[[46,48],[45,59],[37,54],[34,57],[31,63],[32,73],[43,84],[35,81],[26,74],[21,63],[19,50],[19,34],[22,24],[29,14],[41,7],[32,17],[31,32],[33,37],[39,41],[42,38],[43,31],[46,43],[43,45],[46,48]],[[56,85],[64,76],[68,68],[66,59],[61,54],[58,55],[54,59],[53,48],[56,46],[53,44],[54,33],[56,31],[58,40],[62,40],[65,37],[68,28],[66,18],[58,7],[69,14],[76,24],[79,34],[79,50],[77,63],[75,70],[69,77],[62,82],[56,85]],[[41,46],[30,43],[23,40],[23,43],[27,50],[35,50],[38,49],[41,46]]];class dt extends nt{constructor(t,s){super(t,{oe:{ae:.002}},s),this.vi=k,this.ui=1,this.ti=3,this.ci=.5,this.di=t=>{ft.forEach((s=>t.J(s,this.options)))}}}dt.le=5;const vt={1:ht,2:lt,3:dt,4:ot,5:ut};class gt extends A{constructor(t,i){super(t),this.si=!1,this.ti=12,this.ci=1.5,this.ui=3,this.duration=2500,this.fe=h.Vs/2,this.options=void 0,this.vi=C,this.di=t=>{t.rect(-.2,-.8,.2,.8,{I:{rotation:{origin:u,rotation:s.PI/4},fillStyle:b},fill:!0,stroke:!1}),t.rect(-.2,-.8,.2,.8,{I:{rotation:{origin:u,rotation:-s.PI/4},fillStyle:b},fill:!0,stroke:!1})},this.start=i}update(t,s){super.update(t,0,s),t-this.start>gt.duration&&(this.si=!0)}}gt.duration=2500;const pt=[0,1,2,3],wt=Object.keys(vt),mt=t=>{const i=1e3*(9e5-Math.max(0,t)/1e3)/1e6;if(t-h.timestamp.Ls>=i){h.timestamp.Ls=t;const i=(0,s.random)(wt),e=(0,s.random)(pt);let n,r;0===e&&(n=(0,s.random)(c.x),r=0),1===e&&(n=(0,s.random)(c.x),r=c.y),2===e&&(n=0,r=(0,s.random)(c.y)),3===e&&(n=0,r=(0,s.random)(c.y));const o=vt[i];h.Fs.push(new o(new s.wt(n,r),(t=>vt[t].le*h.Us.level*.5)(i)))}t-h.timestamp.Ds>=6e4&&yt(t)},yt=t=>{const i=(t-h.timestamp.Ds-6e4)/gt.duration;if(i<1&&!h.qs){const i=(0,s.random)(.8*c.x,.1),e=(0,s.random)(.8*c.y,.1),n=new gt(new s.wt(i,e),t);h.qs=n,h.Ts.push(n)}else if(i>1&&h.qs){const i=Math.floor((0,s.random)(16,12));for(let t=0;t<i;t++){const e=h.qs.ai.x+1.5*Math.cos(s.Z*t/i),n=h.qs.ai.y+1.5*Math.sin(s.Z*t/i);h.Fs.push(new ht(new s.wt(e,n),5))}h.timestamp.Ds=t,h.qs=!1}};let Mt;const bt=new(n()),St=bt.bs(new(n().ys)("phys","#0ff","#002"));bt.ws.id="stats",document.body.appendChild(bt.ws);const _t=1e3/60;let xt=0,Ot=0,jt=0;const kt=(s=0)=>{bt._s();const i=h.Hs!==t.Rs?0:s-Ot;for(Ot=s,jt+=Math.min(i,50);jt>=_t;)Ct(),jt-=_t,xt+=_t;Rt(jt/_t),bt.end(),window.requestAnimationFrame(kt)},Ct=()=>{St.update(59.99999999999999,200),z.update(xt,_t);for(let t=h.Ks.length-1;t>=0;t--)h.Ks[t].update(xt,_t);for(let t=h.Fs.length-1;t>=0;t--)h.Fs[t].si?h.Fs.splice(t,1):h.Fs[t].update(xt,_t);for(let t=h.items.length-1;t>=0;t--)h.items[t].si?h.items.splice(t,1):h.items[t].update(xt,_t,t);for(let t=h.Ts.length-1;t>=0;t--)h.Ts[t].si?h.Ts.splice(t,1):h.Ts[t].update(xt,t);mt(xt)},Rt=t=>{p.Qs.clear();for(let s=0;s<h.Fs.length;s++)h.Fs[s].fi(t);for(let s=0;s<h.Ks.length;s++)h.Ks[s].fi(t);for(let s=0;s<h.items.length;s++)h.items[s].fi(t);for(let s=0;s<h.Ts.length;s++)h.Ts[s].fi(t);z.fi(t)};(0,s.Qt)(o.map,c),(0,s.Qt)(o.Qs,c),(0,s.Qt)(o.Xs,c),I("KeyDown",(i=>{if("Enter"===i&&h.Hs===t.Ns){h.Js[h.Ys].Gi(),h.Ys=0,p.upgrade.clear(),B("StateChange",t.Rs)}"Shift"===i&&(h.Us.Is=h.Us.next,B("LevelUp")),"Escape"===i&&h.Hs===t.Rs&&B("StateChange",t.zs),"ArrowLeft"!==i&&"a"!==i||(h.Hs===t.Rs&&(h.move.left=!0,z.wi="left"),h.Hs===t.Ns&&(h.Ys=(0,s.gs)(h.Ys-1,h.$s),G())),"ArrowRight"!==i&&"d"!==i||(h.Hs===t.Rs&&(h.move.right=!0,z.wi="right"),h.Hs===t.Ns&&(h.Ys=(0,s.gs)(h.Ys+1,h.$s),G())),"ArrowUp"!==i&&"w"!==i||(h.move.Ps=!0),"ArrowDown"!==i&&"s"!==i||(h.move.Es=!0)})),I("KeyUp",(s=>{"ArrowLeft"!==s&&"a"!==s||(h.move.left=!1),"ArrowRight"!==s&&"d"!==s||(h.move.right=!1),"ArrowUp"!==s&&"w"!==s||(h.move.Ps=!1),"ArrowDown"!==s&&"s"!==s||(h.move.Es=!1),"Enter"===s&&h.Hs===t.zs&&B("StateChange",t.Rs)})),I("CanvasResize",(()=>{for(const t in R.Zs)R.Zs[t].length=0;(()=>{for(let t=0;t<c.x;t++)for(let s=0;s<c.y;s++)p.map.rect(t,s,1/c.x,1/c.y,{I:{strokeStyle:"rgba(255,255,255,0.1)"}})})();const i=o.map.getBoundingClientRect();o.Gs.style.height=String(.05*i.height),o.Gs.style.left=String(i.left),o.Gs.style.top=String(i.top-o.Gs.clientHeight),o.Gs.style.width=String(i.width),o.Gs.width=o.Gs.clientWidth*s.bt,o.Gs.height=o.Gs.clientHeight*s.bt,Q(),h.Hs===t.Ns&&G()})),I("WindowResize",(()=>{const t=o.map.getBoundingClientRect();o.Gs.style.height=String(.05*t.height),o.Gs.style.left=String(t.left),o.Gs.style.top=String(t.top-o.Gs.clientHeight),o.Gs.style.width=String(t.width)})),I("StateChange",(s=>{if(s===t.Ns)h.Ys=0,G(),Mt=I("CanvasResize",G);s!==t.Ns&&(t=>{let s;for(s in W)for(let i=W[s].length-1;i>=0;i--)W[s][i].id===t&&W[s].splice(i,1)})(Mt),h.Hs=s})),I("LevelUp",X),I("Initialize",(()=>{document.body.style.backgroundColor=y,o.map.style.zIndex="-1",X(),new D})),B("Initialize"),B("StateChange",t.Rs),window.requestAnimationFrame(kt)})()})();</script></body></html>