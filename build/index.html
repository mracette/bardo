<html><head><link href="main.css" rel="stylesheet"></head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><title>Bardo</title><body class="full"><div id="root"><canvas id="ui"></canvas><canvas id="upgrades"></canvas><canvas id="map"></canvas><canvas id="gameplay"></canvas></div><script>(()=>{var t={705:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.i=void 0;i.i=function(t){var i=void 0===t?{}:t,s=i.o,e=void 0===s?0:s,n=i.h,r=void 0===n?-1:n,o=i.u,h=void 0===o?1:o,a=i.l,u=void 0===a?1:a,c=i.v,l=void 0===c?0:c,f=i.p,d=void 0===f?0:f,v=i.g,p=void 0!==v&&v;if(e<r||e>h)throw new Error("yStart must be between yMin and yMax");var g=2*Math.PI,w=(r+h)/2,M=(h-r)/2,m=p?-1:1,b=Math.asin(2*(e-r)/(h-r)-1)*(u/g);return function(t){return w+M*Math.sin(m*(g*(t-l+b))/u)+d}}},257:function(t,i,s){"use strict";var e=this&&this.M||(Object.create?function(t,i,s,e){void 0===e&&(e=s),Object.defineProperty(t,e,{m:!0,get:function(){return i[s]}})}:function(t,i,s,e){void 0===e&&(e=s),t[e]=i[s]}),n=this&&this._||function(t,i){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(i,s)||e(i,t,s)};Object.defineProperty(i,"t",{value:!0}),n(s(705),i)},712:function(t,i,s){"use strict";var e=this&&this.O||function(){return e=Object.assign||function(t){for(var i,s=1,e=arguments.length;s<e;s++)for(var n in i=arguments[s])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t},e.apply(this,arguments)};Object.defineProperty(i,"t",{value:!0}),i.S=i.j=void 0;var n=s(839),r=s(603);!function(t){t.A="width",t.k="height"}(i.j||(i.j={}));var o=function(){function t(t,i){var s;void 0===i&&(i={}),this.context=t,this.coords=null!==(s=i.coords)&&void 0!==s?s:new n.R({canvas:t.canvas});var r={beginPath:!0,closePath:!1,fill:!1,N:void 0,P:!0,stroke:!1,C:!1,W:!1,D:!1};this.options=e(e({},r),i),this.options.T=e(e({},{fontFamily:"sans-serif",fontSize:16}),i.T)}return t.prototype.rect=function(t,i,s,e,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=1),void 0===e&&(e=1),void 0===n&&(n={}),this.F(n),this.context.rect(this.B(t,n),this.L(i,n),this.H(s),this.I(e)),this.q(n)},t.prototype.U=function(t,i){void 0===i&&(i={}),this.F(i);for(var s=0;s<t.length;s++){var e=this.B(t[s][0],i),n=this.L(t[s][1],i);0===s?this.context.moveTo(e,n):this.context.lineTo(e,n)}this.q(i)},t.prototype.J=function(t,i){var s=this;void 0===i&&(i={}),this.F(i);for(var e=0;e<t.length-1;e++){var n=this.B(t[e][0],i),r=this.L(t[e][1],i);if(0===e)this.context.moveTo(n,r);else{var o=this.B(t[e+1][0],i),h=this.L(t[e+1][1],i);if(o===n&&h===r)this.context.lineTo(o,h);else{var a=(n+o)/2,u=(r+h)/2;this.context.quadraticCurveTo(n,r,a,u)}}}t.slice(-1).forEach((function(t){s.context.lineTo(s.B(t[0],i),s.L(t[1],i))})),this.q(i)},t.prototype.K=function(t,i,s,e){void 0===e&&(e={}),this.F(e),this.context.arc(this.B(t,e),this.L(i,e),this.Y(s,e),0,n.V),this.q(e)},t.prototype.drawImage=function(t,i,s,e){void 0===e&&(e={}),this.F(e),this.context.drawImage(t,this.B(i,e),this.L(s,e)),this.q(e)},t.prototype.X=function(t,i,s,r,o,h){void 0===h&&(h={}),this.U((0,n.X)(this.B(t,h),this.L(i,h),this.Y(s,h),r,o),e(e({},h),{C:!1,P:!0}))},t.prototype.G=function(t,i,s,r,o){void 0===o&&(o={}),this.U((0,n.G)(this.B(t,o),this.L(i,o),this.Y(s,o),r),e(e({},o),{C:!1,P:!0}))},t.prototype.Z=function(t){this.$(e(e({},this.options.T),t))},t.prototype.text=function(t,i,s,e){void 0===e&&(e={}),this.F(e),this.context.fillText(t,this.B(i,e),this.L(s,e),this.tt("maxTextWidth",e)),this.q(e)},t.prototype.clear=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.prototype.it=function(t,i){void 0===i&&(i={}),t.width=t.clientWidth*(i.st?r.et:1),t.height=t.clientHeight*(i.st?r.et:1)},t.prototype.B=function(t,i){return void 0===i&&(i={}),this.tt("useNormalCoordinates",i)?this.coords.nt(t):t},t.prototype.L=function(t,i){return void 0===i&&(i={}),this.tt("useNormalCoordinates",i)?this.coords.rt(t):t},t.prototype.H=function(t){return this.coords.width(t)},t.prototype.I=function(t){return this.coords.height(t)},t.prototype.Y=function(t,i){void 0===i&&(i={});var s=this.tt("scalarNormalization",i);return"width"===s?this.coords.width(t):"height"===s?this.coords.height(t):t},t.prototype.tt=function(t,i){return i&&t in i?i[t]:this.options[t]},t.prototype.ot=function(t,i){var s=i&&t in i?i[t]:this.options.T[t];return"function"==typeof s?s(this.coords):s},t.prototype.ht=function(t){var i=this.ot("fontSize",t),s=this.ot("lineHeight",t),e=this.ot("fontStyle",t),n=this.ot("fontFamily",t),r=this.ot("fontWeight",t),o=this.ot("fontStretch",t),h="number"==typeof i?"".concat(i,"px"):void 0;return s&&h&&(h="".concat(i," / ").concat(s,"}")),[h,n,e,r,o].join(" ").trim()},t.prototype.$=function(t){for(var i in t){var s=this.ot(i,t);if(!(0,n.ut)(s)){if("transform"===i&&this.context.setTransform(s),"translation"===i){var e=s,r=e.x,o=e.y;this.context.translate(this.B(r),this.L(o))}if("rotation"===i)if("number"==typeof s)this.context.rotate(s);else{var h=s,a=h.rotation,u=h.origin,c=this.B(u.x),l=this.L(u.y);this.context.translate(c,l),this.context.rotate(a),this.context.translate(-c,-l)}if("scale"===i)if("origin"in s){var f=s,d=f.origin,v=f.scale,p=f.ct,g=void 0!==p&&p;c=this.B(d.x),l=this.L(d.y);this.context.translate(c,l),this.context.scale(v.x,v.y),this.context.translate(-c,-l),g&&(this.context.lineWidth=this.context.lineWidth*(1/((v.x+v.y)/2)))}else{var w=s;r=w.x,o=w.y;this.context.scale(r,o)}"lineDash"===i&&this.context.setLineDash(s),"alpha"===i&&(this.context.globalAlpha=s),i in this.context&&"function"!=typeof this.context[i]&&(this.context[i]=this.ot(i,t))}}this.context.font=this.ht(t)},t.prototype.F=function(t){void 0===t&&(t={}),this.tt("saveAndRestore",t)&&this.context.save(),this.tt("skipApplyStyles",t)||this.Z(t.T),this.tt("beginPath",t)&&this.context.beginPath()},t.prototype.q=function(t){this.tt("closePath",t)&&this.context.closePath(),this.tt("fill",t)&&this.context.fill(),this.tt("stroke",t)&&this.context.stroke(),this.tt("saveAndRestore",t)&&this.context.restore()},t}();i.S=o},367:function(t,i,s){"use strict";var e,n=this&&this.lt||(e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])},e(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}),r=this&&this.O||function(){return r=Object.assign||function(t){for(var i,s=1,e=arguments.length;s<e;s++)for(var n in i=arguments[s])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t},r.apply(this,arguments)};Object.defineProperty(i,"t",{value:!0}),i.ft=void 0;var o=s(839),h=s(358),a=function(t){function i(i,s){var e=t.call(this,i,s)||this;return e.options=r(r({},{dt:.025,vt:!1}),e.options),e}return n(i,t),i.prototype.U=function(t,i){void 0===i&&(i={});for(var s=this.tt("roughness",i)||0,e=t.length-1,n=0;n<2;n++){for(var h=[],a=0;a<e;a++){var u=t[a],c=u[0],l=u[1],f=t[a+1],d=f[0],v=f[1],p=s*Math.sqrt(Math.pow(c-d,2)+Math.pow(l-v,2));if(i.vt&&a===e-1){h.push(h[0]);break}for(var g=0;g<4;g++){var w=Math.random()*p,M=Math.random()*o.V,m=w*Math.cos(M),b=w*Math.sin(M),y=NaN,_=NaN;if(0===g&&(y=c+m,_=l+b),1===g){var O=.5;y=(0,o.gt)(O,c,d)+m,_=(0,o.gt)(O,l,v)+b}if(2===g){O=.75;y=(0,o.gt)(O,c,d)+m,_=(0,o.gt)(O,l,v)+b}3===g&&(y=d+m,_=v+b),h.push([y,_])}}var S=0===n?i:r(r({},i),{fill:!1});this.J(h,S)}},i.prototype.K=function(t,i,s,e){void 0===e&&(e={});for(var n=(this.tt("roughness",e)||0)*this.Y(s,e)/window.innerWidth,h=0;h<2;h++){for(var a=[],u=0;u<16;u++){var c=Math.random()*n,l=Math.random()*o.V,f=c*Math.cos(l),d=c*Math.sin(l),v=o.V*u/16,p=this.B(t+f,e)+Math.cos(v)*this.Y(s,e),g=this.L(i+d,e)+Math.sin(v)*this.Y(s,e);a.push([p,g])}a[16]=a[0],a[17]=a[1],this.J(a,r(r({},e),{C:!1,P:!0,vt:!0}))}},i.prototype.rect=function(t,i,s,e,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=1),void 0===e&&(e=1),void 0===n&&(n={});var o=this.B(t),h=this.L(i),a=this.H(s),u=this.I(e),c=[[o,h],[o+a,h],[o+a,h+u],[o,h+u],[o,h]];this.U(c,r(r({},n),{C:!1,P:!0,vt:!0}))},i.prototype.wt=function(t,i){this.context.save(),this.Z(i);var s=this.context.measureText(t);return this.context.restore(),s},i.prototype.text=function(i,s,e,n){var a=this;void 0===n&&(n={});var u=this.wt(i,n.T),c=u.actualBoundingBoxAscent,l=u.actualBoundingBoxDescent,f=u.width,d=i.split(""),v=c-l,p=this.coords.Mt(v),g=f/d.length,w=this.coords.bt(g)-this.coords.bt(0),M=w*d.length;this.Z(n.T),d.forEach((function(i,u){var c,l;if("left"===a.context.textAlign)l=(c=s+w*u)+w/2;else if("right"===a.context.textAlign)l=(c=-M+s+w*(u+1))-w/2;else{if("center"!==a.context.textAlign)throw new Error("textAlign must be 'left', 'right', or 'center' to use rough text");l=c=-M/2+s+w*(.5+u)}var d,v=e;if("top"===a.context.textBaseline)d=v-p/2;else if("bottom"===a.context.textBaseline)d=v-p/2;else{if("middle"!==a.context.textBaseline)throw new Error("textBaseline must be 'top', 'bottom', or 'middle' to use rough text");d=v}var g=(a.tt("roughness",n)||0)*f*.05,m=[(0,h.random)(Math.min(.4,g/6.5))*w,(0,h.random)(Math.min(.4,g/6.5))*w],b=[(0,h.random)(Math.min(.4,g/6.5))*p,(0,h.random)(Math.min(.4,g/6.5))*p];t.prototype.text.call(a,i,c+m[0],v+b[0],r(r({},n),{T:r(r({},n.T),{rotation:{origin:new o.yt(l,d),rotation:g*Math.PI/16}})})),t.prototype.text.call(a,i,c+m[1],v+b[1],r(r({},n),{T:r(r({},n.T),{rotation:{origin:new o.yt(l,d),rotation:-g*Math.PI/16}})}))}))},i}(o.S);i.ft=a},659:function(t,i,s){"use strict";var e=this&&this.O||function(){return e=Object.assign||function(t){for(var i,s=1,e=arguments.length;s<e;s++)for(var n in i=arguments[s])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t},e.apply(this,arguments)};Object.defineProperty(i,"t",{value:!0}),i.R=void 0;var n,r=s(654),o=s(796),h=s(908),a=s(482);!function(t){t._t="up",t.Ot="down"}(n||(n={}));var u=function(){function t(t){if(void 0===t&&(t={}),(0,o.ut)(t.canvas)&&(0,r.St)(t.jt,t.xt))throw new Error("Invalid options. A canvas element must be supplied if baseHeight or baseWidth are not defined.");Object.assign(this,e(e({},{At:[-1,1],kt:[-1,1],Rt:!1,orientationY:"down",Nt:!1}),t))}return t.prototype.zt=function(){var t;return null!==(t=this.jt)&&void 0!==t?t:this.canvas.width},t.prototype.Pt=function(){return this.zt()-2*this.Ct()},t.prototype.Et=function(){var t;return null!==(t=this.xt)&&void 0!==t?t:this.canvas.height},t.prototype.Wt=function(){return this.Et()-2*this.Dt()},t.prototype.Tt=function(){var t,i;return null!==(i=null!==(t=this.Ft)&&void 0!==t?t:this.padding)&&void 0!==i?i:0},t.prototype.Ct=function(){return this.Tt()*this.zt()},t.prototype.Bt=function(){return(0,o.ut)(this.Lt)?(0,o.ut)(this.padding)?0:this.Nt?this.padding*(this.zt()/this.Et()):this.padding:this.Lt},t.prototype.Dt=function(){return this.Bt()*this.Et()},t.prototype.Ht=function(){var t;return null!==(t=this.offsetX)&&void 0!==t?t:0},t.prototype.It=function(){var t;return null!==(t=this.offsetY)&&void 0!==t?t:0},t.prototype.nt=function(t){var i=(0,a.normalize)(t,this.At[0],this.At[1],this.Rt);return this.Ct()+this.Ht()+i*this.Pt()},t.prototype.rt=function(t){var i=(0,a.normalize)(t,this.kt[0],this.kt[1],this.Rt),s=this.qt===n._t;return this.Dt()+this.It()+(s?1-i:i)*this.Wt()},t.prototype.bt=function(t){var i=(0,a.normalize)(t,this.Ct(),this.Ct()+this.width(),this.Rt);return(0,h.gt)(i,this.At[0],this.At[1])},t.prototype.Ut=function(t){var i=(0,a.normalize)(t,this.Dt(),this.Dt()+this.height(),this.Rt);return(0,h.gt)(i,this.At[0],this.At[1])},t.prototype.width=function(t){return this.Pt()*(null!=t?t:1)},t.prototype.height=function(t){return this.Wt()*(null!=t?t:1)},t.prototype.Jt=function(t){return this.bt(t)-this.bt(0)},t.prototype.Mt=function(t){return this.Ut(t)-this.Ut(0)},t}();i.R=u},326:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Kt=void 0;var e=s(839);i.Kt=function(t,i){if(t.parentElement){var s=t.parentElement,n=i.x,r=i.y,o=new ResizeObserver((function(){var i=s.getBoundingClientRect(),o=i.width,h=i.height,a=Math.min(o/n,h/r),u=t.clientWidth,c=t.clientHeight,l=Math.round(a*n),f=Math.round(a*r);l===u&&f===c||(t instanceof HTMLCanvasElement&&(t.width=l*e.et,t.height=f*e.et),t.style.width=l+"px",t.style.height=f+"px")}));return o.observe(s),o}return console.warn("aspectRatioResize: element has no parent and cannot be resized"),null}},999:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Yt=void 0;i.Yt=function(t,i,s){var e=s*Math.sqrt(3)/2;return[[t,i-2*e/3],[t+s/2,i*(e/3)],[t-s/2,i*(e/3)]]}},125:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Vt=void 0;i.Vt=function(t,i,s,e){var n=Math.sqrt(e*e/4-s*s);return[[t,i-2*n/3],[t+e/2,i*(n/3)],[t-e/2,i*(n/3)]]}},932:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.G=void 0;var e=s(965);i.G=function(t,i,s,n){void 0===n&&(n=5);for(var r=[],o=0,h=n;o<=h;o++){var a=-e.PI/(2*n)+e.V*(o/h);r.push([t+Math.cos(a)*s,i+Math.sin(a)*s])}return r}},166:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Xt=void 0;i.Xt=function(t,i,s,e,n){return[Math.cos(n)*(t-s)-Math.sin(n)*(i-e)+s,Math.sin(n)*(t-s)+Math.cos(n)*(i-e)+e]}},154:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.X=void 0;var e=s(965);i.X=function(t,i,s,n,r){void 0===n&&(n=5),void 0===r&&(r=.4);for(var o=[],h=0,a=2*n;h<=a;h++){var u=-e.PI/(2*n)+e.V*(h/a),c=h%2;o.push([t+Math.cos(u)*(0===c?s:s*r),i+Math.sin(u)*(0===c?s:s*r)])}return o}},839:function(t,i,s){"use strict";var e=this&&this.M||(Object.create?function(t,i,s,e){void 0===e&&(e=s),Object.defineProperty(t,e,{m:!0,get:function(){return i[s]}})}:function(t,i,s,e){void 0===e&&(e=s),t[e]=i[s]}),n=this&&this._||function(t,i){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(i,s)||e(i,t,s)};Object.defineProperty(i,"t",{value:!0}),n(s(712),i),n(s(367),i),n(s(659),i),n(s(603),i),n(s(147),i),n(s(654),i),n(s(796),i),n(s(90),i),n(s(466),i),n(s(92),i),n(s(358),i),n(s(159),i),n(s(600),i),n(s(965),i),n(s(908),i),n(s(250),i),n(s(482),i),n(s(674),i),n(s(326),i),n(s(999),i),n(s(125),i),n(s(932),i),n(s(166),i),n(s(154),i)},603:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.et=void 0,i.et=window.devicePixelRatio||1},90:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Gt=void 0;i.Gt=function(t){return JSON.parse(JSON.stringify(t))}},147:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Qt=void 0;i.Qt=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.every((function(t){return void 0===t}))}},654:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.St=void 0;i.St=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.some((function(t){return void 0===t}))}},796:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ut=void 0;i.ut=function(t){return void 0===t}},466:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Zt=void 0;i.Zt=function(t){for(new Date;new Date-t<ms;);}},674:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.yt=void 0;var e=s(159),n=function(){function t(t,i){this.x=t,this.y=i}return Object.defineProperty(t.prototype,"ratio",{get:function(){return this.x/this.y},m:!1,$t:!0}),Object.defineProperty(t.prototype,"ti",{get:function(){return Math.pow(Math.pow(this.x,2)+Math.pow(this.y,2),.5)},m:!1,$t:!0}),t.prototype.add=function(t,i){return"number"==typeof t?(this.x+=t,"number"==typeof i&&(this.y+=i)):(this.x+=t.x,this.y+=t.y),this},t.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.ii=function(t){return(0,e.si)(this.x,this.y,t.x,t.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.normalize=function(){var t=this.ti;return 0!==t&&(this.x/=t,this.y/=t),this},t.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},t.from=function(i,s){return new t(i.x-s.x,i.y-s.y)},t}();i.yt=n},600:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.Rt=void 0;i.Rt=function(t,i,s){return Math.max(Math.min(s,t),i)}},92:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ei=i.ni=void 0;var e=s(159);i.ni=function(t,i,s,n,r,o){return(0,e.si)(t,i,n,r)<=s+o};i.ei=function(t,i,s,e,n,r,o,h){return!(i+e<r||i>r+h||t+s<n||t>n+o)}},965:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.ri=i.PI=i.V=void 0;var e=s(674);i.V=2*Math.PI,i.PI=Math.PI,i.ri=new e.yt(0,0)},159:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.oi=i.si=void 0;i.si=function(t,s,e,n){return Math.pow((0,i.oi)(t,s,e,n),.5)};i.oi=function(t,i,s,e){return Math.pow(s-t,2)+Math.pow(e-i,2)}},908:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.gt=void 0;i.gt=function(t,i,s){return i*(1-t)+s*t}},250:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.hi=void 0;i.hi=function(t,i){return(t%i+i)%i}},482:(t,i,s)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.normalize=void 0;var e=s(600);i.normalize=function(t,i,s,n){return void 0===n&&(n=!1),((n?(0,e.Rt)(t,i,s):t)-i)/(s-i)}},358:(t,i)=>{"use strict";Object.defineProperty(i,"t",{value:!0}),i.random=void 0,i.random=function(t,i){return void 0===t&&(t=1),void 0===i&&(i=0),Array.isArray(t)?t[Math.floor(Math.random()*t.length)]:i+Math.random()*(t-i)}},557:function(t){var i;t.exports=(i=function(){function t(t){return n.appendChild(t.ai),t}function s(t){for(var i=0;i<n.children.length;i++)n.children[i].style.display=i===t?"block":"none";e=t}var e=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),s(++e%n.children.length)}),!1);var r=(performance||Date).now(),o=r,h=0,a=t(new i.ui("FPS","#0ff","#002")),u=t(new i.ui("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new i.ui("MB","#f08","#201"));return s(0),{ci:16,ai:n,li:t,fi:s,di:function(){r=(performance||Date).now()},end:function(){h++;var t=(performance||Date).now();if(u.update(t-r,200),t>o+1e3&&(a.update(1e3*h/(t-o),100),o=t,h=0,c)){var i=performance.memory;c.update(i.vi/1048576,i.pi/1048576)}return t},update:function(){r=this.end()},gi:n,wi:s}},i.ui=function(t,i,s){var e=1/0,n=0,r=Math.round,o=r(window.devicePixelRatio||1),h=80*o,a=48*o,u=3*o,c=2*o,l=3*o,f=15*o,d=74*o,v=30*o,p=document.createElement("canvas");p.width=h,p.height=a,p.style.cssText="width:80px;height:48px";var g=p.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=s,g.fillRect(0,0,h,a),g.fillStyle=i,g.fillText(t,u,c),g.fillRect(l,f,d,v),g.fillStyle=s,g.globalAlpha=.9,g.fillRect(l,f,d,v),{ai:p,update:function(a,w){e=Math.min(e,a),n=Math.max(n,a),g.fillStyle=s,g.globalAlpha=1,g.fillRect(0,0,h,f),g.fillStyle=i,g.fillText(r(a)+" "+t+" ("+r(e)+"-"+r(n)+")",u,c),g.drawImage(p,l+o,f,d-o,v,l,f,d-o,v),g.fillRect(l+d-o,f,o,v),g.fillStyle=s,g.globalAlpha=.9,g.fillRect(l+d-o,f,o,r((1-a/w)*v))}}},i)}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,s),r.exports}s.n=t=>{var i=t&&t.t?()=>t.default:()=>t;return s.d(i,{a:i}),i},s.d=(t,i)=>{for(var e in i)s.Mi(i,e)&&!s.Mi(t,e)&&Object.defineProperty(t,e,{m:!0,get:i[e]})},s.Mi=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),(()=>{"use strict";var t,i=s(839),e=s(557),n=s.n(e);!function(t){t.mi="gameplay",t.bi="intro",t.yi="paused",t._i="upgrade"}(t||(t={}));const r={move:{Oi:!1,Si:!1,left:!1,right:!1},timestamp:{ji:0,xi:-58e3},Ai:!1,ki:[],Ri:[],items:[],Ni:[],zi:t.bi,Pi:4,Ci:0,Ei:1550},o=[[[58,15],[55,7],[48,4],[40,7],[37,15],[40,22],[48,26],[55,22],[58,15]],[[87,34],[85,30],[81,29],[14,29],[9,30],[8,34],[9,38],[14,40],[37,40],[37,88],[38,93],[43,95],[45,94],[49,90],[50,80],[52,80],[72,68],[72,62],[58,52],[58,40],[81,40],[85,38],[87,34]],[[50,68],[50,62],[54,65],[50,68]]],h=new i.yt(0,0),a=new i.yt(32,18),u=new i.yt(a.x/2-1,a.y/2-1),c=1/a.x,l="rgb(28,5,50)",f="rgba(0,0,0)",d="rgb(253,93,106)",v="rgb(254,184,18)",p="rgb(111,254,237)",g="rgb(248,96,248)",w={Wi:document.querySelector("canvas#upgrades"),Di:document.querySelector("canvas#ui"),map:document.querySelector("canvas#map"),Ti:document.querySelector("canvas#gameplay")},M={Wi:w.Wi.getContext("2d"),Di:w.Di.getContext("2d"),map:w.map.getContext("2d"),Ti:w.Ti.getContext("2d")},m="Arial, sans-serif",b={strokeStyle:"white",fillStyle:"white",lineWidth:t=>t.width(.001),fontFamily:m,textAlign:"center",textBaseline:"middle",fontSize:t=>t.width(.1)},y={C:!0,W:"width"},_={map:new i.R({canvas:w.map,At:[0,a.x],kt:[0,a.y]}),upgrade:new i.R({canvas:w.Wi,padding:.1}),Di:new i.R({canvas:w.Di})},O={map:new i.S(M.map,{...y,coords:_.map,T:b,stroke:!0}),Ti:new i.ft(M.Ti,{...y,coords:_.map,T:{...b,lineWidth:t=>t.width(.00175)},stroke:!0,dt:.1}),upgrade:new i.ft(M.Wi,{...y,coords:_.upgrade,T:{...b,lineWidth:t=>t.width(.01),fontSize:t=>t.width(.1),fontFamily:m}}),Di:new i.ft(M.Di,{...y,coords:_.Di,T:{...b,lineWidth:t=>t.width(.01),fontSize:t=>t.width(.1),fontFamily:m}})},S=[0,100],j=[-1,1],x={Fi:{}};class A{constructor(t){this.Bi="",this.cache={},this.Li=!1,this.Hi=4,this.Ii=0,this.position=t,this.qi=t.clone()}get Ui(){if("Ui"in this.cache)return this.cache.Ui;const t=this.position.clone().add(this.Ji/2,this.Ji/2);return this.cache.Ui=t,t}get key(){if("key"in this.cache)return this.cache.key;const t=String(this.Bi)+String(this.Ki)+JSON.stringify(this.options);return this.cache.key=t,t}Yi(t,s){const e=this.key;e in x.Fi&&x.Fi[e].length||(x.Fi[this.key]=((t,s,e,n,r)=>{const o=[];t.Z(t.options.T);for(let h=0;h<n;h++){const n=document.createElement("canvas");n.width=e,n.height=e;const h=n.getContext("2d");s(new i.ft(h,{...t.options,T:{...t.options.T,lineWidth:t.context.lineWidth},coords:new i.R({canvas:n,At:r,kt:r})})),o.push(n)}return o})(O.Ti,this.Vi,O.Ti.coords.width(c*this.Ji),this.Hi,this.Xi));const n=x.Fi[e][this.Ii];O.Ti.drawImage(n,(0,i.gt)(t,this.qi.x,this.position.x),(0,i.gt)(t,this.qi.y,this.position.y),s)}update(t,i,s){this.qi.set(this.position),this.Ui.x=this.position.x+this.Ji/2,this.Ui.y=this.position.y+this.Ji/2,this.Ii=Math.floor(t/r.Ei%1*this.Hi)}}const k=new class extends A{constructor(t){super(t),this.Ki=.75,this.Ji=1.5,this.Bi=0,this.speed=.005,this.Xi=S,this.Gi="right",this.Qi={T:{scale:{origin:this.Ui,scale:new i.yt(-1,1)}}},this.options={T:{fillStyle:g},fill:!0},this.Vi=t=>{o.forEach((i=>{t.U(i,this.options)}))},this.update=(t,i)=>{super.update(t,i),this.Zi(t,i)},this.Zi=(t,s)=>{const e=s*this.speed,n=.7071*e;let o=0,h=0;r.move.left&&r.move.Oi?(o=-n,h=-n):r.move.left&&r.move.Si?(o=-n,h=n):r.move.right&&r.move.Oi?(o=n,h=-n):r.move.right&&r.move.Si?(o=n,h=n):r.move.Oi?h=-e:r.move.Si?h=e:r.move.left?o=-e:r.move.right&&(o=e),this.position.x=(0,i.Rt)(this.position.x+o,0,a.x-1),this.position.y=(0,i.Rt)(this.position.y+h,0,a.y-1)}}Yi(t){super.Yi(t,"left"===this.Gi?this.Qi:void 0)}}(u.clone()),R={6:{$i:[10,11,12.5,15,18,21.5,26.5],range:[1.5,1.55,1.65,1.8,2,2.25,2.55],ts:[1,2,3,4,5,6,7]},7:{ss:[.07,.09,.11,.15,.2,.25,.34],es:[1.5,1.55,1.65,1.85,2.15,2.65,3.15]},8:{$i:[6,6.5,7.5,9,11,13.5,17],frequency:[1,1.5,2,3,4,6,8]},9:{$i:[3,4,6,9,13,18,24],es:[1.5,1.7,2,2.4,2.9,3.5,4.2]},10:{$i:[16,18,21,25,30,36,43],frequency:[.5,.6,.7,.9,1.1,1.4,1.7]}};class N extends A{constructor(t,s=k.Ui.clone()){super(s),this.size=.25,this.ns=!1,this.rs=(t,s,e)=>{for(let n=0;n<r.ki.length;n++){const o=r.ki[n];(0,i.ni)(this.Ui.x,this.Ui.y,this.Ki,o.Ui.x,o.Ui.y,o.Ki)&&(o.$i(t,s,e,this.Bi),this.ns&&(this.Li=!0))}},this.parent=t}update(t,i,s){super.update(t,i),this.Zi(t,i,s),this.rs(this.parent.$i,s,t)}}class z extends N{constructor(t,s){super(t,k.position.clone()),this.Xi=j,this.Ji=1,this.Ki=.05,this.Bi=8,this.options=void 0,this.ns=!0,this.Vi=t=>{t.U([[-1,0],[1,0]]),t.U([[-.75,-.4],[-1,0],[-.75,.4]])},this.Zi=(t,i)=>{this.qi.set(this.position),this.position.x+=this.os.x*this.parent.speed,this.position.y+=this.os.y*this.parent.speed},this.os=i.yt.from(s,this.Ui).normalize(),this.hs=this.os.angle()+i.PI,this.us={T:{rotation:{origin:this.Ui,rotation:this.hs}}}}Yi(t){super.Yi(t,this.us)}}class P extends class{constructor(){this.cs=[],r.Ri.push(this)}ls(){return this.level<7}Yi(t){for(let i=0;i<this.cs.length;i++)this.cs[i].Yi(t)}update(t,i){for(let s=0;s<this.cs.length;s++)this.cs[s].Li?this.cs.splice(s,1):this.cs[s].update(t,i,s)}}{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this.fs=0,this.upgrade=()=>{this.ls()&&this.level++}}get ds(){return R[8]}get frequency(){return 1e3/this.ds.frequency[this.level-1]}get $i(){return this.ds.$i[this.level-1]}update(t,i){if(super.update(t,i),t-this.fs>this.frequency){this.fs=t;const i=this.vs();i&&this.cs.push(new z(this,i.Ui))}for(let s=0;s<this.cs.length;s++){const e=this.cs[s];e.update(t,i,s),e.Ui.ii(k.Ui)>this.range&&(e.Li=!0)}}vs(){let t,i=1/0;for(let s=0;s<r.ki.length;s++){const e=k.Ui.ii(r.ki[s].Ui);e<i&&(i=e,t=r.ki[s])}return t}}const C=()=>{O.upgrade.clear();for(let t=0;t<r.Pi;t++){const s=new i.R({offsetX:O.upgrade.coords.nt(-1)+O.upgrade.coords.width(t/r.Pi),offsetY:O.upgrade.coords.rt(-1),jt:O.upgrade.coords.width()/r.Pi,xt:O.upgrade.coords.height(),padding:.05}),e=new i.ft(O.upgrade.context,{...O.upgrade.options,coords:s,stroke:!1});e.rect(-1,-1,1,e.coords.height()/e.coords.width(),{stroke:r.Ci===t,fill:!0,T:{fillStyle:"rgba(255,255,255,.5)"}}),e.text("TEST",0,-.8,{T:{textBaseline:"top"}})}};var E;!function(t){t[t.ps=0]="Initialize",t[t.gs=1]="CanvasResize",t[t.ws=2]="WindowResize",t[t.Ms=3]="Tick",t[t.bs=4]="KeyDown",t[t.ys=5]="KeyUp",t[t._s=6]="StateChange"}(E||(E={}));const W={[E.ps]:[],[E.gs]:[],[E.ws]:[],[E.Ms]:[],[E.bs]:[],[E.ys]:[],[E._s]:[]},D=(t,i)=>{W[t].push(i)},T=(t,...i)=>{const s=W[t];for(let t=0;t<s.length;t++)s[t](...i)};new ResizeObserver((()=>{T(E.gs)})).observe(w.map),window.addEventListener("keydown",(t=>{T(E.bs,t.key)})),window.addEventListener("keyup",(t=>{T(E.ys,t.key)})),window.addEventListener("resize",(t=>{T(E.ws)}));const F=[[[22,38],[35,87],[37,89],[44,92],[55,92],[60,89],[64,84],[76,38],[74,35],[59,22],[49,20],[38,22],[29,29],[22,38]],[[31,52],[45,55],[40,61],[35,59],[31,52]],[[58,61],[56,60],[54,55],[67,52],[62,59],[58,61]],[[58,25],[59,17],[63,12],[68,8],[76,7],[83,8],[88,12],[92,17],[94,25],[93,29],[89,38]],[[74,35],[89,52],[86,54],[83,55],[79,55],[75,51],[72,40],[74,35]],[[40,25],[38,17],[34,12],[29,8],[22,7],[15,8],[10,12],[6,17],[5,29],[9,38]],[[25,35],[9,52],[11,54],[14,55],[19,55],[22,51],[25,40],[25,35]]];class B extends A{constructor(t,i){super(t),this.Os=t=>{this.Li=!0},this.Ss=i}update(t,i,s){super.update(t,i),this.Zi(t,i,s)}Zi(t,s,e){this.Ss.js&&((t,s,e,n)=>{const r=i.yt.from(k.position,t);if(!e.start&&r.ti<e.si)e.start=s;else if(e.start&&r.ti<.5)e.xs(n);else if(e.start){const i=s-e.start;r.normalize();const n=r.clone().multiply(.0015*i-.25);t.x+=n.x,t.y+=n.y}})(this.position,t,this.Ss.js,e)}}class L extends B{constructor(t){super(t,{js:{si:3,As:t.clone(),xs:t=>{this.Os(t)}}}),this.Xi=j,this.Ji=1,this.Ki=.25,this.Bi=11,this.Vi=t=>{t.X(0,0,this.Ki,5,.4,this.options)}}}class H extends L{constructor(t){super(t),this.points=1,this.options={T:{fillStyle:v,strokeStyle:v},fill:!0}}}class I extends L{constructor(t){super(t),this.points=5,this.options={T:{fillStyle:p,strokeStyle:p},fill:!0}}}class q extends L{constructor(t){super(t),this.points=25,this.options={T:{fillStyle:g,strokeStyle:g},fill:!0}}}const U=(0,s(257).i)({o:.5,u:1,h:.2,l:2});class J extends A{constructor(t,s,e){super(J.ks(t.Ui.clone(),t)),this.Ki=.5,this.Ji=1,this.duration=500,this.Rs={T:{scale:{origin:h,scale:new i.yt(1,1)}}},this.options=void 0,this.Xi=j,this.Yi=t=>{super.Yi(t,this.Rs)},this.Vi=t=>{t.text(this.text,0,0,{fill:!0,T:{fontSize:t=>t.width(.35),textBaseline:"top"},dt:.3})},this.target=t,this.Bi=s,this.text=s,this.start=e}static ks(t,i){return t.x=i.Ui.x-.5,t.y=i.Ui.y-1.5,t}update(t,i){super.update(t,0,i);const s=U((t-this.start)/this.duration);this.Rs.T.scale.origin=this.Ui,this.Rs.T.scale.scale.x=s,this.Rs.T.scale.scale.y=s,J.ks(this.position,this.target),t-this.start>=this.duration&&(this.Li=!0)}}class K extends A{constructor(t,i,s){super(t),this.speed=.00175,this.Ns=1e3,this.zs={},this.options={T:{fillStyle:f},fill:!0},this.Ss=i,this.Ps=s}Cs(t){O.Ti.text(String(t),this.Ui.x,this.Ui.y-this.Ji/2)}$i(t,i,s,e){const n=this.zs[e];n&&s-n<this.Ns||(this.Ps-=t,r.Ni.push(new J(this,String(t),s)),this.Ps<=0&&this.Os(),this.zs[e]=s)}Os(){const t=new((0,i.random)([H,I,q]))(this.Ui.clone());t.position.add(-t.Ji/2,-t.Ji/2),r.items.push(t),this.Li=!0}update(t,i){super.update(t,i),this.Zi(t,i)}Zi(t,s){this.Ss.Es&&((t,s,e)=>{const n=i.yt.from(k.position,t).normalize().multiply(s*e.Ws);t.x+=n.x,t.y+=n.y})(this.position,s,this.Ss.Es),this.Ss.Ds&&((t,s,e)=>{const n=i.yt.from(k.position,t);if(n.ti<e.si){const i=n.normalize().multiply(s*e.Es);t.x+=i.x,t.y+=i.y}else{if(t.equals(e.Ts))return;if(t.ii(e.Ts)<.1)t.set(e.Ts);else{const n=i.yt.from(e.Ts,t).normalize().multiply(s*e.Es);t.x+=n.x,t.y+=n.y}}})(this.position,s,this.Ss.Ds)}}class Y extends K{constructor(t,i){super(t,{Ds:{Es:.002,si:3,Ts:t.clone()}},i),this.Xi=S,this.Ji=1,this.Bi=1,this.Ki=.5,this.Vi=t=>{F.forEach((i=>t.U(i,this.options)))}}}const V=[[[87,35],[83,21],[80,15],[70,6],[57,1],[43,1],[30,6],[20,15],[15,28],[14,35],[9,39],[7,47],[9,54],[14,59],[18,72],[26,84],[37,92],[44,95],[57,95],[63,92],[74,84],[82,72],[87,59],[94,50],[95,47],[92,39],[87,35]],[[87,45],[76,44],[76,35],[80,34],[80,41],[83,41],[87,45]],[[78,63],[76,68],[76,65],[78,63]],[[63,74],[63,63],[71,63],[73,65],[73,74],[63,74]],[[45,74],[43,73],[43,65],[45,63],[57,63],[57,74],[45,74]],[[29,74],[30,63],[38,63],[40,65],[40,73],[29,74]],[[24,63],[25,68],[24,63]],[[22,30],[25,24],[25,29],[22,30]],[[57,19],[57,30],[43,29],[43,21],[45,19],[57,19]],[[78,30],[76,29],[76,24],[78,30]],[[73,58],[71,60],[63,60],[62,56],[58,54],[57,60],[45,60],[43,58],[43,54],[40,56],[38,60],[30,60],[29,35],[38,34],[40,35],[40,38],[43,40],[43,35],[45,34],[57,34],[58,40],[62,38],[63,34],[73,35],[73,58]],[[29,29],[29,19],[38,19],[40,21],[40,29],[29,29]],[[73,19],[73,29],[63,30],[63,19],[73,19]],[[63,16],[62,11],[70,16],[63,16]],[[40,14],[38,16],[31,16],[40,11],[40,14]],[[58,9],[57,16],[45,16],[43,14],[43,9],[58,9]],[[18,41],[21,41],[21,35],[24,34],[25,44],[14,45],[18,41]],[[18,52],[14,49],[25,50],[24,60],[22,60],[21,53],[18,52]],[[31,78],[40,79],[40,86],[31,78]],[[43,88],[43,79],[58,79],[58,88],[43,88]],[[62,86],[63,78],[71,78],[62,86]],[[83,52],[80,53],[78,60],[76,58],[76,50],[87,49],[83,52]],[[38,41],[33,42],[32,47],[33,50],[38,52],[41,50],[43,47],[41,42],[38,41]],[[63,41],[59,42],[58,47],[59,50],[63,52],[67,50],[69,47],[67,42],[63,41]]];const X=[[[37,36],[46,37],[53,42],[57,48],[60,58],[59,66],[56,69],[49,74],[46,84],[37,87],[31,86],[28,84],[26,74],[17,69],[14,62],[17,48],[21,42],[28,37],[37,36]],[[63,95],[68,71],[69,59],[67,45],[64,35],[58,28],[47,21],[37,19],[27,21],[15,28],[10,35],[7,45],[6,59],[6,71],[12,95]],[[14,61],[15,79],[21,95]],[[61,61],[59,79],[54,95]],[[77,21],[45,10],[29,9],[20,9],[12,13],[17,8],[25,4],[44,2],[71,6],[92,13],[77,21]],[[94,9],[82,95]],[[42,51],[39,53],[40,59],[43,63],[46,63],[51,60],[53,55],[53,51],[47,48],[42,51]],[[37,63],[34,66],[33,71],[41,71],[40,66],[37,63]],[[33,51],[30,49],[24,49],[22,51],[20,55],[24,60],[30,63],[34,59],[35,56],[33,51]]];const G=[[[95,56],[75,43],[51,35],[43,53],[40,65],[40,82],[44,91],[49,95],[54,96],[65,94],[72,90],[86,74],[96,59],[95,56]],[[53,85],[49,80],[47,68],[56,79],[71,80],[59,85],[53,85]],[[73,71],[67,65],[76,65],[81,72],[73,71]],[[54,62],[49,55],[57,56],[63,62],[54,62]],[[39,47],[33,49],[27,56],[31,45],[36,42],[42,42],[44,36],[48,29],[52,29],[57,31],[55,20],[49,2],[24,7],[2,19],[11,42],[23,57],[35,63],[39,47]],[[43,22],[51,25],[43,29],[35,25],[43,22]],[[25,36],[16,38],[20,31],[29,29],[25,36]]];const Q=[[[58,46],[68,43],[75,40],[74,43],[70,50],[63,50],[60,49],[58,46]],[[49,3],[35,6],[24,14],[16,26],[14,40],[16,62],[23,78],[34,88],[49,94],[62,89],[73,79],[81,63],[84,40],[81,26],[73,14],[62,6],[49,3]],[[46,48],[45,59],[37,54],[34,57],[31,63],[32,73],[43,84],[35,81],[26,74],[21,63],[19,50],[19,34],[22,24],[29,14],[41,7],[32,17],[31,32],[33,37],[39,41],[42,38],[43,31],[46,43],[43,45],[46,48]],[[56,85],[64,76],[68,68],[66,59],[61,54],[58,55],[54,59],[53,48],[56,46],[53,44],[54,33],[56,31],[58,40],[62,40],[65,37],[68,28],[66,18],[58,7],[69,14],[76,24],[79,34],[79,50],[77,63],[75,70],[69,77],[62,82],[56,85]],[[41,46],[30,43],[23,40],[23,43],[27,50],[35,50],[38,49],[41,46]]];class Z extends A{constructor(t,s){super(t),this.Li=!1,this.Bi=12,this.Ki=1.5,this.Ji=3,this.duration=2500,this.Fs=r.Ei/2,this.options=void 0,this.Xi=j,this.Vi=t=>{t.rect(-.2,-.8,.2,.8,{T:{rotation:{origin:h,rotation:i.PI/4},fillStyle:d},fill:!0,stroke:!1}),t.rect(-.2,-.8,.2,.8,{T:{rotation:{origin:h,rotation:-i.PI/4},fillStyle:d},fill:!0,stroke:!1})},this.start=s}update(t,i){super.update(t,0,i),t-this.start>Z.duration&&(this.Li=!0)}}Z.duration=2500;const $=[0,1,2,3],tt=[class extends K{constructor(t,i){super(t,{Es:{Ws:.002}},i),this.Xi=S,this.Ji=1,this.Bi=3,this.Ki=.5,this.Vi=t=>{Q.forEach((i=>t.U(i,this.options)))}}},class extends K{constructor(t,i){super(t,{Es:{Ws:.002}},i),this.Xi=S,this.Ji=2,this.Bi=2,this.Ki=1,this.Vi=t=>{G.forEach((i=>t.U(i,this.options)))}}},class extends K{constructor(t,i){super(t,{Es:{Ws:.002}},i),this.Xi=S,this.Ji=1,this.Bi=4,this.Ki=.5,this.speed=.002,this.Vi=t=>{V.forEach((i=>t.U(i,this.options)))}}},class extends K{constructor(t,i){super(t,{Es:{Ws:.002}},i),this.Xi=S,this.Ji=1,this.Bi=5,this.Ki=.5,this.Vi=t=>{X.forEach((i=>t.U(i,this.options)))}}}],it=t=>{const s=(t-r.timestamp.xi-6e4)/Z.duration;if(s<1&&!r.Ai){const s=(0,i.random)(.8*a.x,.1),e=(0,i.random)(.8*a.y,.1),n=new Z(new i.yt(s,e),t);r.Ai=n,r.Ni.push(n)}else if(s>1&&r.Ai){const s=Math.floor((0,i.random)(16,12));for(let t=0;t<s;t++){const e=r.Ai.Ui.x+1.5*Math.cos(i.V*t/s),n=r.Ai.Ui.y+1.5*Math.sin(i.V*t/s);r.ki.push(new Y(new i.yt(e,n),5))}r.timestamp.xi=t,r.Ai=!1}},st=new(n()),et=st.li(new(n().ui)("phys","#0ff","#002"));st.ai.id="stats",document.body.appendChild(st.ai);const nt=1e3/60;let rt=0,ot=0,ht=0;const at=(i=0)=>{st.di();const s=r.zi!==t.mi?0:i-ot;for(ot=i,ht+=Math.min(s,50);ht>=nt;)ut(),ht-=nt,rt+=nt;ct(ht/nt),st.end(),window.requestAnimationFrame(at)},ut=()=>{et.update(59.99999999999999,200),k.update(rt,nt);for(let t=r.Ri.length-1;t>=0;t--)r.Ri[t].update(rt,nt);for(let t=r.ki.length-1;t>=0;t--)r.ki[t].Li?r.ki.splice(t,1):r.ki[t].update(rt,nt);for(let t=r.items.length-1;t>=0;t--)r.items[t].Li?r.items.splice(t,1):r.items[t].update(rt,nt,t);for(let t=r.Ni.length-1;t>=0;t--)r.Ni[t].Li?r.Ni.splice(t,1):r.Ni[t].update(rt,t);(t=>{const s=1e3*(9e5-Math.max(0,t)/1e3)/1e6;if(t-r.timestamp.ji>=s){r.timestamp.ji=t;const s=(0,i.random)(tt),e=(0,i.random)($);let n,o;0===e&&(n=(0,i.random)(a.x),o=0),1===e&&(n=(0,i.random)(a.x),o=a.y),2===e&&(n=0,o=(0,i.random)(a.y)),3===e&&(n=0,o=(0,i.random)(a.y)),r.ki.push(new s(new i.yt(n,o),5))}t-r.timestamp.xi>=6e4&&it(t)})(rt)},ct=t=>{O.Ti.clear();for(let i=0;i<r.ki.length;i++)r.ki[i].Yi(t);for(let i=0;i<r.Ri.length;i++)r.Ri[i].Yi(t);for(let i=0;i<r.items.length;i++)r.items[i].Yi(t);for(let i=0;i<r.Ni.length;i++)r.Ni[i].Yi(t);k.Yi(t)};(0,i.Kt)(w.map,a),(0,i.Kt)(w.Ti,a),(0,i.Kt)(w.Wi,a),D(E.bs,(s=>{"Enter"===s&&r.Ri.forEach((t=>t.upgrade())),"ArrowLeft"!==s&&"a"!==s||(r.zi===t.mi&&(r.move.left=!0,k.Gi="left"),r.zi===t._i&&(r.Ci=(0,i.hi)(r.Ci-1,r.Pi),C())),"ArrowRight"!==s&&"d"!==s||(r.zi===t.mi&&(r.move.right=!0,k.Gi="right"),r.zi===t._i&&(r.Ci=(0,i.hi)(r.Ci+1,r.Pi),C())),"ArrowUp"!==s&&"w"!==s||(r.move.Oi=!0),"ArrowDown"!==s&&"s"!==s||(r.move.Si=!0),"Escape"===s&&r.zi===t.mi&&T(E._s,t.yi)})),D(E.ys,(i=>{"ArrowLeft"!==i&&"a"!==i||(r.move.left=!1),"ArrowRight"!==i&&"d"!==i||(r.move.right=!1),"ArrowUp"!==i&&"w"!==i||(r.move.Oi=!1),"ArrowDown"!==i&&"s"!==i||(r.move.Si=!1),"Enter"===i&&r.zi===t.yi&&T(E._s,t.mi)})),D(E.gs,(()=>{(()=>{for(let t=0;t<a.x;t++)for(let i=0;i<a.y;i++)O.map.rect(t,i,1/a.x,1/a.y,{T:{strokeStyle:"rgba(255,255,255,0.1)"}})})();const s=w.map.getBoundingClientRect();w.Di.style.height=String(.05*s.height),w.Di.style.left=String(s.left),w.Di.style.top=String(s.top-w.Di.clientHeight),w.Di.style.width=String(s.width),w.Di.width=w.Di.clientWidth*i.et,w.Di.height=w.Di.clientHeight*i.et,O.Di.rect(-1,-1,1,1,{fill:!1,dt:0}),O.Di.rect(-1,-1,.9,1,{fill:!0,dt:0});for(const t in x.Fi)x.Fi[t].length=0;r.zi===t._i&&C()})),D(E.ws,(()=>{const t=w.map.getBoundingClientRect();w.Di.style.height=String(.05*t.height),w.Di.style.left=String(t.left),w.Di.style.top=String(t.top-w.Di.clientHeight),w.Di.style.width=String(t.width)})),D(E._s,(i=>{if(i===t._i)r.Ci=0;r.zi=i})),D(E.ps,(()=>{document.body.style.backgroundColor=l,w.map.style.zIndex="-1",new P})),T(E.ps),T(E._s,t.mi),window.requestAnimationFrame(at)})()})();</script></body></html>