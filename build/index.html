<html><head><link href="main.css" rel="stylesheet"></head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><title>Bardo</title><body class="full"><div id="root"><canvas id="ui"></canvas><canvas id="upgrades"></canvas><canvas id="map"></canvas><canvas id="gameplay"></canvas></div><script>(()=>{var t={705:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.i=void 0;s.i=function(t){var s=void 0===t?{}:t,i=s.h,e=void 0===i?0:i,n=s.o,h=void 0===n?-1:n,r=s.u,o=void 0===r?1:r,a=s.l,u=void 0===a?1:a,c=s.v,l=void 0===c?0:c,f=s.g,d=void 0===f?0:f,v=s.p,g=void 0!==v&&v;if(e<h||e>o)throw new Error("yStart must be between yMin and yMax");var p=2*Math.PI,w=(h+o)/2,y=(o-h)/2,m=g?-1:1,M=Math.asin(2*(e-h)/(o-h)-1)*(u/p);return function(t){return w+y*Math.sin(m*(p*(t-l+M))/u)+d}}},257:function(t,s,i){"use strict";var e=this&&this.m||(Object.create?function(t,s,i,e){void 0===e&&(e=i),Object.defineProperty(t,e,{M:!0,get:function(){return s[i]}})}:function(t,s,i,e){void 0===e&&(e=i),t[e]=s[i]}),n=this&&this.S||function(t,s){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(s,i)||e(s,t,i)};Object.defineProperty(s,"t",{value:!0}),n(i(705),s)},712:function(t,s,i){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var n in s=arguments[i])Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);return t},e.apply(this,arguments)};Object.defineProperty(s,"t",{value:!0}),s.O=s.j=void 0;var n=i(839),h=i(603),r=i(674);!function(t){t.k="width",t.C="height"}(s.j||(s.j={}));var o=function(){function t(t,s){var i;void 0===s&&(s={}),this.context=t,this.coords=null!==(i=s.coords)&&void 0!==i?i:new n.R({canvas:t.canvas});var h={beginPath:!0,closePath:!1,fill:!1,A:-1,N:!0,stroke:!1,P:!1,D:!1,L:!1,W:0,U:!1,random:Math.random};this.options=e(e({},h),s),this.options.B=e(e({},{fontFamily:"sans-serif",fontSize:16}),s.B)}return t.prototype.rect=function(t,s,i,e,n){void 0===t&&(t=0),void 0===s&&(s=0),void 0===i&&(i=1),void 0===e&&(e=1),void 0===n&&(n={}),this.I("roughness",n)?this.F(t,s,i,e,n):this.T(t,s,i,e,n)},t.prototype.F=function(t,s,i,n,h){var r=this.q(t),o=this.K(s),a=this.H(i),u=this.$(n),c=[[r,o],[r+a,o],[r+a,o+u],[r,o+u],[r,o]];this.J(c,e(e({},h),{P:!1,N:!0,U:!0}))},t.prototype.T=function(t,s,i,e,n){this.Y(n),this.context.rect(this.q(t,n),this.K(s,n),this.H(i),this.$(e)),this.V(n)},t.prototype.J=function(t,s){void 0===s&&(s={}),this.I("roughness",s)?this.X(t,s):this.G(t,s)},t.prototype.G=function(t,s){this.Y(s);for(var i=0;i<t.length;i++){var e=this.q(t[i][0],s),n=this.K(t[i][1],s);0===i?this.context.moveTo(e,n):this.context.lineTo(e,n)}this.V(s)},t.prototype.X=function(t,s){for(var i=this.I("roughness",s)||0,h=this.I("random",s),r=t.length-1,o=0;o<2;o++){for(var a=[],u=0;u<r;u++)for(var c=t[u],l=c[0],f=c[1],d=t[u+1],v=d[0],g=d[1],p=i*Math.sqrt(Math.pow(l-v,2)+Math.pow(f-g,2)),w=0;w<4;w++){var y=h()*p,m=h()*n.Z,M=y*Math.cos(m),b=y*Math.sin(m),S=NaN,_=NaN;if(0===w&&(S=l+M,_=f+b),1===w){var x=.5;S=(0,n.tt)(x,l,v)+M,_=(0,n.tt)(x,f,g)+b}if(2===w){x=.75;S=(0,n.tt)(x,l,v)+M,_=(0,n.tt)(x,f,g)+b}3===w&&(s.U&&u===r-1?(S=a[0][0],_=a[0][1]):(S=v+M,_=g+b)),a.push([S,_])}var O=0===o?s:e(e({},s),{fill:!1});this.st(a,O)}},t.prototype.st=function(t,s){var i=this;void 0===s&&(s={}),this.Y(s);for(var e=0;e<t.length-1;e++){var n=this.q(t[e][0],s),h=this.K(t[e][1],s);if(0===e)this.context.moveTo(n,h);else{var r=this.q(t[e+1][0],s),o=this.K(t[e+1][1],s);if(r===n&&o===h)this.context.lineTo(r,o);else{var a=(n+r)/2,u=(h+o)/2;this.context.quadraticCurveTo(n,h,a,u)}}}t.slice(-1).forEach((function(t){i.context.lineTo(i.q(t[0],s),i.K(t[1],s))})),this.V(s)},t.prototype.it=function(t,s,i,e){void 0===e&&(e={}),this.I("roughness",e)?this.et(t,s,i,e):this.nt(t,s,i,e)},t.prototype.nt=function(t,s,i,e){this.Y(e),this.context.arc(this.q(t,e),this.K(s,e),this.ht(i,e),0,n.Z),this.V(e)},t.prototype.et=function(t,s,i,h){for(var r=this.I("roughness",h),o=this.I("random",h),a=r*this.ht(i,h)/window.innerWidth,u=0;u<2;u++){for(var c=[],l=0;l<16;l++){var f=o()*a,d=o()*n.Z,v=f*Math.cos(d),g=f*Math.sin(d),p=n.Z*l/16,w=this.q(t+v,h)+Math.cos(p)*this.ht(i,h),y=this.K(s+g,h)+Math.sin(p)*this.ht(i,h);c.push([w,y])}c[16]=c[0],c[17]=c[1],this.st(c,e(e({},h),{P:!1,N:!0,U:!0}))}},t.prototype.drawImage=function(t,s,i,e){void 0===e&&(e={}),this.Y(e),this.context.drawImage(t,this.q(s,e),this.K(i,e)),this.V(e)},t.prototype.rt=function(t,s,i,h,r,o){void 0===o&&(o={}),this.J((0,n.rt)(this.q(t,o),this.K(s,o),this.ht(i,o),h,r),e(e({},o),{P:!1,N:!0}))},t.prototype.ot=function(t,s,i,h,r){void 0===r&&(r={});var o=this.I("roughness",r);this.J((0,n.ot)(this.q(t,r),this.K(s,r),this.ht(i,r),h),e(e({},r),{P:!1,N:!0,U:Boolean(o)}))},t.prototype.ut=function(t){this.ct(e(e({},this.options.B),t))},t.prototype.text=function(t,s,i,e){void 0===e&&(e={}),this.I("roughness",e)?this.lt(t,s,i,e):this.ft(t,s,i,e)},t.prototype.ft=function(t,s,i,e){void 0===e&&(e={}),this.Y(e);var n=this.I("maxTextWidth",e);this.context.fillText(t,this.q(s,e),this.K(i,e),n>0?n:void 0),this.V(e)},t.prototype.lt=function(t,s,i,h){var o=this;void 0===h&&(h={});var a=this.dt(t,h.B),u=a.actualBoundingBoxAscent,c=a.actualBoundingBoxDescent,l=a.width,f=this.I("roughness",h),d=this.I("random",h),v=t.split(""),g=u-c,p=this.coords.vt(g),w=l/v.length,y=this.coords.gt(w)-this.coords.gt(0),m=y*v.length;this.ut(h.B),v.forEach((function(t,a){var u,c;if("left"===o.context.textAlign)c=(u=s+y*a)+y/2;else if("right"===o.context.textAlign)c=(u=-m+s+y*(a+1))-y/2;else{if("center"!==o.context.textAlign)throw new Error("textAlign must be 'left', 'right', or 'center' to use rough text");c=u=-m/2+s+y*(.5+a)}var v,g=i;if("top"===o.context.textBaseline)v=g-p/2;else if("bottom"===o.context.textBaseline)v=g-p/2;else{if("middle"!==o.context.textBaseline)throw new Error("textBaseline must be 'top', 'bottom', or 'middle' to use rough text");v=g}var w=f*l*.05,M=[(0,n.random)(Math.min(.4,w/6.5),0,d)*y,(0,n.random)(Math.min(.4,w/6.5),0,d)*y],b=[(0,n.random)(Math.min(.4,w/6.5),0,d)*p,(0,n.random)(Math.min(.4,w/6.5),0,d)*p];o.ft(t,u+M[0],g+b[0],e(e({},h),{B:e(e({},h.B),{rotation:{origin:new r.wt(c,v),rotation:w*Math.PI/16}})})),o.ft(t,u+M[1],g+b[1],e(e({},h),{B:e(e({},h.B),{rotation:{origin:new r.wt(c,v),rotation:-w*Math.PI/16}})}))}))},t.prototype.clear=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.prototype.yt=function(t,s){void 0===s&&(s={}),t.width=t.clientWidth*(s.Mt?h.bt:1),t.height=t.clientHeight*(s.Mt?h.bt:1)},t.prototype.q=function(t,s){return void 0===s&&(s={}),this.I("useNormalCoordinates",s)?this.coords.St(t):t},t.prototype.K=function(t,s){return void 0===s&&(s={}),this.I("useNormalCoordinates",s)?this.coords._t(t):t},t.prototype.H=function(t){return this.coords.width(t)},t.prototype.$=function(t){return this.coords.height(t)},t.prototype.ht=function(t,s){void 0===s&&(s={});var i=this.I("scalarNormalization",s);return"width"===i?this.coords.width(t):"height"===i?this.coords.height(t):t},t.prototype.I=function(t,s){var i=s&&t in s?s[t]:this.options[t];return console.assert(null!=i,"A value for ".concat(i," could not be resolved.")),i},t.prototype.xt=function(t,s){var i=s&&t in s?s[t]:this.options.B[t];return"function"==typeof i?i(this.coords):i},t.prototype.Ot=function(t){var s=this.xt("fontSize",t),i=this.xt("lineHeight",t),e=this.xt("fontStyle",t),n=this.xt("fontFamily",t),h=this.xt("fontWeight",t),r=this.xt("fontStretch",t),o="number"==typeof s?"".concat(s,"px"):void 0;return i&&o&&(o="".concat(s," / ").concat(i,"}")),[o,n,e,h,r].join(" ").trim()},t.prototype.ct=function(t){for(var s in t){var i=this.xt(s,t);if(!(0,n.jt)(i)){if("transform"===s&&this.context.setTransform(i),"translation"===s){var e=i,h=e.x,r=e.y;this.context.translate(this.q(h),this.K(r))}if("rotation"===s)if("number"==typeof i)this.context.rotate(i);else{var o=i,a=o.rotation,u=o.origin,c=this.q(u.x),l=this.K(u.y);this.context.translate(c,l),this.context.rotate(a),this.context.translate(-c,-l)}if("scale"===s)if("origin"in i){var f=i,d=f.origin,v=f.scale,g=f.kt,p=void 0!==g&&g;c=this.q(d.x),l=this.K(d.y);this.context.translate(c,l),this.context.scale(v.x,v.y),this.context.translate(-c,-l),p&&(this.context.lineWidth=this.context.lineWidth*(1/((v.x+v.y)/2)))}else{var w=i;h=w.x,r=w.y;this.context.scale(h,r)}"lineDash"===s&&this.context.setLineDash(i),"alpha"===s&&(this.context.globalAlpha=i),s in this.context&&"function"!=typeof this.context[s]&&(this.context[s]=this.xt(s,t))}}this.context.font=this.Ot(t)},t.prototype.Y=function(t){void 0===t&&(t={}),this.I("saveAndRestore",t)&&this.context.save(),this.I("skipApplyStyles",t)||this.ut(t.B),this.I("beginPath",t)&&this.context.beginPath()},t.prototype.V=function(t){this.I("closePath",t)&&this.context.closePath(),this.I("fill",t)&&this.context.fill(),this.I("stroke",t)&&this.context.stroke(),this.I("saveAndRestore",t)&&this.context.restore()},t.prototype.dt=function(t,s){this.context.save(),this.ut(s);var i=this.context.measureText(t);return this.context.restore(),i},t}();s.O=o},659:function(t,s,i){"use strict";var e=this&&this._||function(){return e=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var n in s=arguments[i])Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);return t},e.apply(this,arguments)};Object.defineProperty(s,"t",{value:!0}),s.R=void 0;var n,h=i(654),r=i(796),o=i(908),a=i(482);!function(t){t.Ct="up",t.Rt="down"}(n||(n={}));var u=function(){function t(t){if(void 0===t&&(t={}),(0,r.jt)(t.canvas)&&(0,h.zt)(t.At,t.Nt))throw new Error("Invalid options. A canvas element must be supplied if baseHeight or baseWidth are not defined.");Object.assign(this,e(e({},{Pt:[-1,1],Et:[-1,1],Dt:!1,orientationY:"down",Lt:!1}),t))}return t.prototype.Wt=function(){var t;return null!==(t=this.At)&&void 0!==t?t:this.canvas.width},t.prototype.Ut=function(){return this.Wt()-2*this.Bt()},t.prototype.It=function(){var t;return null!==(t=this.Nt)&&void 0!==t?t:this.canvas.height},t.prototype.Ft=function(){return this.It()-2*this.Tt()},t.prototype.qt=function(){var t,s;return null!==(s=null!==(t=this.Kt)&&void 0!==t?t:this.padding)&&void 0!==s?s:0},t.prototype.Bt=function(){return this.qt()*this.Wt()},t.prototype.Ht=function(){return(0,r.jt)(this.$t)?(0,r.jt)(this.padding)?0:this.Lt?this.padding*(this.Wt()/this.It()):this.padding:this.$t},t.prototype.Tt=function(){return this.Ht()*this.It()},t.prototype.Jt=function(){var t;return null!==(t=this.offsetX)&&void 0!==t?t:0},t.prototype.Yt=function(){var t;return null!==(t=this.offsetY)&&void 0!==t?t:0},t.prototype.St=function(t){var s=(0,a.normalize)(t,this.Pt[0],this.Pt[1],this.Dt);return this.Bt()+this.Jt()+s*this.Ut()},t.prototype._t=function(t){var s=(0,a.normalize)(t,this.Et[0],this.Et[1],this.Dt),i=this.Vt===n.Ct;return this.Tt()+this.Yt()+(i?1-s:s)*this.Ft()},t.prototype.gt=function(t){var s=(0,a.normalize)(t,this.Bt(),this.Bt()+this.width(),this.Dt);return(0,o.tt)(s,this.Pt[0],this.Pt[1])},t.prototype.Xt=function(t){var s=(0,a.normalize)(t,this.Tt(),this.Tt()+this.height(),this.Dt);return(0,o.tt)(s,this.Pt[0],this.Pt[1])},t.prototype.width=function(t){return this.Ut()*(null!=t?t:1)},t.prototype.height=function(t){return this.Ft()*(null!=t?t:1)},t.prototype.Gt=function(t){return this.gt(t)-this.gt(0)},t.prototype.vt=function(t){return this.Xt(t)-this.Xt(0)},t}();s.R=u},326:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Qt=void 0;var e=i(839);s.Qt=function(t,s){if(t.parentElement){var i=t.parentElement,n=s.x,h=s.y,r=new ResizeObserver((function(){var s=i.getBoundingClientRect(),r=s.width,o=s.height,a=Math.min(r/n,o/h),u=t.clientWidth,c=t.clientHeight,l=Math.round(a*n),f=Math.round(a*h);l===u&&f===c||(t instanceof HTMLCanvasElement&&(t.width=l*e.bt,t.height=f*e.bt),t.style.width=l+"px",t.style.height=f+"px")}));return r.observe(i),r}return console.warn("aspectRatioResize: element has no parent and cannot be resized"),null}},999:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Zt=void 0;s.Zt=function(t,s,i){var e=i*Math.sqrt(3)/2;return[[t,s-2*e/3],[t+i/2,s*(e/3)],[t-i/2,s*(e/3)]]}},125:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ts=void 0;s.ts=function(t,s,i,e){var n=Math.sqrt(e*e/4-i*i);return[[t,s-2*n/3],[t+e/2,s*(n/3)],[t-e/2,s*(n/3)]]}},932:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ot=void 0;var e=i(965);s.ot=function(t,s,i,n){void 0===n&&(n=5);for(var h=[],r=0,o=n;r<=o;r++){var a=-e.PI/(2*n)+e.Z*(r/o);h.push([t+Math.cos(a)*i,s+Math.sin(a)*i])}return h}},166:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ss=void 0;s.ss=function(t,s,i,e,n){return[Math.cos(n)*(t-i)-Math.sin(n)*(s-e)+i,Math.sin(n)*(t-i)+Math.cos(n)*(s-e)+e]}},154:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.rt=void 0;var e=i(965);s.rt=function(t,s,i,n,h){void 0===n&&(n=5),void 0===h&&(h=.4);for(var r=[],o=0,a=2*n;o<=a;o++){var u=-e.PI/(2*n)+e.Z*(o/a),c=o%2;r.push([t+Math.cos(u)*(0===c?i:i*h),s+Math.sin(u)*(0===c?i:i*h)])}return r}},839:function(t,s,i){"use strict";var e=this&&this.m||(Object.create?function(t,s,i,e){void 0===e&&(e=i),Object.defineProperty(t,e,{M:!0,get:function(){return s[i]}})}:function(t,s,i,e){void 0===e&&(e=i),t[e]=s[i]}),n=this&&this.S||function(t,s){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(s,i)||e(s,t,i)};Object.defineProperty(s,"t",{value:!0}),n(i(712),s),n(i(659),s),n(i(603),s),n(i(147),s),n(i(654),s),n(i(796),s),n(i(90),s),n(i(466),s),n(i(92),s),n(i(358),s),n(i(159),s),n(i(600),s),n(i(965),s),n(i(908),s),n(i(250),s),n(i(482),s),n(i(674),s),n(i(327),s),n(i(326),s),n(i(999),s),n(i(125),s),n(i(932),s),n(i(166),s),n(i(154),s)},603:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.bt=void 0,s.bt=window.devicePixelRatio||1},90:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.es=void 0;s.es=function(t){return JSON.parse(JSON.stringify(t))}},147:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ns=void 0;s.ns=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return t.every((function(t){return void 0===t}))}},654:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.zt=void 0;s.zt=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return t.some((function(t){return void 0===t}))}},796:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.jt=void 0;s.jt=function(t){return void 0===t}},466:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.hs=void 0;s.hs=function(t){for(new Date;new Date-t<ms;);}},674:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.wt=void 0;var e=i(159),n=function(){function t(t,s){this.x=t,this.y=s}return Object.defineProperty(t.prototype,"ratio",{get:function(){return this.x/this.y},M:!1,rs:!0}),Object.defineProperty(t.prototype,"os",{get:function(){return Math.pow(Math.pow(this.x,2)+Math.pow(this.y,2),.5)},M:!1,rs:!0}),t.prototype.add=function(t,s){return"number"==typeof t?(this.x+=t,"number"==typeof s&&(this.y+=s)):(this.x+=t.x,this.y+=t.y),this},t.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.us=function(t){return(0,e.cs)(this.x,this.y,t.x,t.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.normalize=function(){var t=this.os;return 0!==t&&(this.x/=t,this.y/=t),this},t.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},t.from=function(s,i){return new t(s.x-i.x,s.y-i.y)},t}();s.wt=n},600:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.Dt=void 0;s.Dt=function(t,s,i){return Math.max(Math.min(i,t),s)}},92:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ls=s.fs=void 0;var e=i(159);s.fs=function(t,s,i,n,h,r){return(0,e.cs)(t,s,n,h)<=i+r};s.ls=function(t,s,i,e,n,h,r,o){return!(s+e<h||s>h+o||t+i<n||t>n+r)}},965:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ds=s.PI=s.Z=void 0;var e=i(674);s.Z=2*Math.PI,s.PI=Math.PI,s.ds=new e.wt(0,0)},159:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.vs=s.cs=void 0;s.cs=function(t,i,e,n){return Math.pow((0,s.vs)(t,i,e,n),.5)};s.vs=function(t,s,i,e){return Math.pow(i-t,2)+Math.pow(e-s,2)}},908:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.tt=void 0;s.tt=function(t,s,i){return s*(1-t)+i*t}},250:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.gs=void 0;s.gs=function(t,s){return(t%s+s)%s}},327:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.ps=void 0;s.ps=function(t){return function(){var s=t+=1831565813;return s=Math.imul(s^s>>>15,1|s),(((s^=s+Math.imul(s^s>>>7,61|s))^s>>>14)>>>0)/4294967296}}},482:(t,s,i)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.normalize=void 0;var e=i(600);s.normalize=function(t,s,i,n){return void 0===n&&(n=!1),((n?(0,e.Dt)(t,s,i):t)-s)/(i-s)}},358:(t,s)=>{"use strict";Object.defineProperty(s,"t",{value:!0}),s.random=void 0,s.random=function(t,s,i){if(void 0===t&&(t=1),void 0===s&&(s=0),void 0===i&&(i=Math.random),Array.isArray(t)){var e="function"==typeof s?s:Math.random;return t[Math.floor(e()*t.length)]}if("number"==typeof t&&"number"==typeof s&&"function"==typeof i)return s+i()*(t-s);throw new Error("Invalid args. Check function signature.")}},557:function(t){var s;t.exports=(s=function(){function t(t){return n.appendChild(t.ws),t}function i(t){for(var s=0;s<n.children.length;s++)n.children[s].style.display=s===t?"block":"none";e=t}var e=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),i(++e%n.children.length)}),!1);var h=(performance||Date).now(),r=h,o=0,a=t(new s.ys("FPS","#0ff","#002")),u=t(new s.ys("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new s.ys("MB","#f08","#201"));return i(0),{Ms:16,ws:n,bs:t,Ss:i,_s:function(){h=(performance||Date).now()},end:function(){o++;var t=(performance||Date).now();if(u.update(t-h,200),t>r+1e3&&(a.update(1e3*o/(t-r),100),r=t,o=0,c)){var s=performance.memory;c.update(s.xs/1048576,s.Os/1048576)}return t},update:function(){h=this.end()},js:n,ks:i}},s.ys=function(t,s,i){var e=1/0,n=0,h=Math.round,r=h(window.devicePixelRatio||1),o=80*r,a=48*r,u=3*r,c=2*r,l=3*r,f=15*r,d=74*r,v=30*r,g=document.createElement("canvas");g.width=o,g.height=a,g.style.cssText="width:80px;height:48px";var p=g.getContext("2d");return p.font="bold "+9*r+"px Helvetica,Arial,sans-serif",p.textBaseline="top",p.fillStyle=i,p.fillRect(0,0,o,a),p.fillStyle=s,p.fillText(t,u,c),p.fillRect(l,f,d,v),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(l,f,d,v),{ws:g,update:function(a,w){e=Math.min(e,a),n=Math.max(n,a),p.fillStyle=i,p.globalAlpha=1,p.fillRect(0,0,o,f),p.fillStyle=s,p.fillText(h(a)+" "+t+" ("+h(e)+"-"+h(n)+")",u,c),p.drawImage(g,l+r,f,d-r,v,l,f,d-r,v),p.fillRect(l+d-r,f,r,v),p.fillStyle=i,p.globalAlpha=.9,p.fillRect(l+d-r,f,r,h((1-a/w)*v))}}},s)}},s={};function i(e){var n=s[e];if(void 0!==n)return n.exports;var h=s[e]={exports:{}};return t[e].call(h.exports,h,h.exports,i),h.exports}i.n=t=>{var s=t&&t.t?()=>t.default:()=>t;return i.d(s,{a:s}),s},i.d=(t,s)=>{for(var e in s)i.Cs(s,e)&&!i.Cs(t,e)&&Object.defineProperty(t,e,{M:!0,get:s[e]})},i.Cs=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),(()=>{"use strict";var t=i(839),s=i(557),e=i.n(s);const n=[[[58,15],[55,7],[48,4],[40,7],[37,15],[40,22],[48,26],[55,22],[58,15]],[[87,34],[85,30],[81,29],[14,29],[9,30],[8,34],[9,38],[14,40],[37,40],[37,88],[38,93],[43,95],[45,94],[49,90],[50,80],[52,80],[72,68],[72,62],[58,52],[58,40],[81,40],[85,38],[87,34]],[[50,68],[50,62],[54,65],[50,68]]];var h;!function(t){t.Rs="gameplay",t.zs="intro",t.As="paused",t.Ns="upgrade"}(h||(h={}));const r={move:{Ps:!1,Es:!1,left:!1,right:!1},timestamp:{Ds:0,Ls:-58e3},Ws:!1,Us:100,Bs:{Is:0,level:0,next:0,Fs:0},Ts:!1,qs:[],Ks:[],items:[],Hs:[],$s:h.zs,Js:3,Ys:[],Vs:0,Xs:1550},o={Gs:document.querySelector("canvas#upgrades"),Qs:document.querySelector("canvas#ui"),map:document.querySelector("canvas#map"),Zs:document.querySelector("canvas#gameplay")},a={Gs:o.Gs.getContext("2d"),Qs:o.Qs.getContext("2d"),map:o.map.getContext("2d"),Zs:o.Zs.getContext("2d")},u=new t.wt(0,0),c=new t.wt(32,18),l=new t.wt(c.x/2-1,c.y/2-1),f=1/c.x,d={strokeStyle:"white",fillStyle:"white",fontFamily:"Comic Sans MS, Chalkboard SE, Comic Neue sans-serif",textAlign:"center",textBaseline:"middle",lineWidth:t=>t.width(.00175),fontSize:t=>t.width(.1)},v={P:!0,D:"width",stroke:!0},g={map:new t.R({canvas:o.map,Pt:[0,c.x],Et:[0,c.y]}),upgrade:new t.R({canvas:o.Gs,padding:.1}),Qs:new t.R({canvas:o.Qs})},p={map:new t.O(a.map,{...v,coords:g.map,B:{...d,lineWidth:t=>t.width(.001)}}),Zs:new t.O(a.Zs,{...v,coords:g.map,B:{...d},W:.1}),upgrade:new t.O(a.Gs,{...v,coords:g.upgrade,B:{...d,lineWidth:t=>t.width(.0175)},W:.02}),Qs:new t.O(a.Qs,{...v,coords:g.Qs,B:{...d}})},w=[3178312775,2263286931,486574442,329066167],y="#fff",m="rgb(28,5,50)",M="rgba(0,0,0)",b="rgb(253,93,106)",S="rgb(254,184,18)",_="rgb(111,254,237)",x="rgb(248,96,248)",O="rgb(1,255,185)",j=s=>(0,t.ps)(w[s]),k=[0,100],C=[-1,1],R={ti:{}};class z{constructor(s){this.si="",this.cache={},this.ii=!1,this.ei=new t.wt(0,0),this.ni=new t.wt(0,0),this.hi=4,this.ri=0,this.position=s,this.oi=s.clone()}get ai(){if("ai"in this.cache)return this.cache.ai;const t=this.position.clone().add(this.ui/2,this.ui/2);return this.cache.ai=t,t}get ci(){if("ci"in this.cache)return this.cache.ci;const t=this.position.clone().add(this.ui/2,this.ui/2);return this.cache.ci=t,t}get key(){if("key"in this.cache)return this.cache.key;const t=[String(this.si),String(this.li),JSON.stringify(this.options)].join("~");return this.cache.key=t,t}fi(s){this.ni.x=(0,t.tt)(s,this.oi.x,this.position.x),this.ni.y=(0,t.tt)(s,this.oi.y,this.position.y),this.ei.x=(0,t.tt)(s,this.ci.x,this.ai.x),this.ei.y=(0,t.tt)(s,this.ci.y,this.ai.y)}di(s,i,e=!0){const n=this.key,h=n in R.ti&&R.ti[n].length;e&&this.fi(s),h||(R.ti[this.key]=((s,i,e,n,h)=>{const r=[];s.ut(s.options.B);for(let o=0;o<n;o++){const n=document.createElement("canvas");n.width=e,n.height=e;const a=n.getContext("2d");i(new t.O(a,{...s.options,B:{...s.options.B,lineWidth:s.context.lineWidth},coords:new t.R({canvas:n,Pt:h,Et:h}),random:j(o)})),r.push(n)}return r})(p.Zs,this.vi,p.Zs.coords.width(f*this.ui),this.hi,this.gi));const r=R.ti[n][this.ri];p.Zs.drawImage(r,this.ni.x,this.ni.y,i)}update(t,s,i){console.log(this.ri),this.oi.set(this.position),this.ci.set(this.ai),this.ri=Math.floor(t/r.Xs%1*this.hi)}pi(){this.ai.x=this.position.x+this.ui/2,this.ai.y=this.position.y+this.ui/2}}class A extends z{constructor(s){super(s),this.wi=0,this.yi=100,this.Us=100,this.li=.6,this.ui=1.5,this.si=0,this.speed=.065,this.gi=k,this.mi="right",this.Mi={B:{scale:{origin:this.ei,scale:new t.wt(-1,1)}}},this.options={B:{fillStyle:x},fill:!0},this.vi=t=>{n.forEach((s=>{t.J(s,this.options)}))},this.update=(t,s)=>{super.update(t,s),this.bi(t,s),this.pi(),this.Si(t)},this.bi=(s,i)=>{const e=this.speed,n=.7071*e;let h=0,o=0;r.move.left&&r.move.Ps?(h=-n,o=-n):r.move.left&&r.move.Es?(h=-n,o=n):r.move.right&&r.move.Ps?(h=n,o=-n):r.move.right&&r.move.Es?(h=n,o=n):r.move.Ps?o=-e:r.move.Es?o=e:r.move.left?h=-e:r.move.right&&(h=e),this.position.x=(0,t.Dt)(this.position.x+h,0,c.x-1),this.position.y=(0,t.Dt)(this.position.y+o,0,c.y-1)}}get _i(){const t=.1;return this.position.y<c.y*t?0:this.position.y>.9*c.y?1:this.position.x<c.x*t?2:this.position.x>.9*c.x&&3}di(t){this.fi(t),super.di(t,"left"===this.mi?this.Mi:void 0,!1),p.Zs.rect(this.ei.x-.5,this.ei.y+this.li,f*this.Us/this.yi,f/10,{fill:!0,stroke:!1,W:0,B:{fillStyle:b}})}Si(s){if(!(s<this.wi+A.xi))for(let i=0;i<r.qs.length;i++){const e=r.qs[i];(0,t.fs)(this.ai.x,this.ai.y,this.li,e.ai.x,e.ai.y,e.li)&&this.Oi(e.ji,s)}}Oi(t,s){this.wi=s,this.Us-=t}}A.xi=200;const N=new A(l.clone()),P={6:{ki:[10,11,12.5,15,18,21.5,26.5],range:[1.5,1.55,1.65,1.8,2,2.25,2.55],Ci:[1,2,3,4,5,6,7]},7:{Ri:[.07,.09,.11,.15,.2,.25,.34],zi:[1.5,1.55,1.65,1.85,2.15,2.65,3.15]},8:{ki:[6,6.5,7.5,9,11,13.5,17],frequency:[1,1.5,2,3,4,6,8]},9:{ki:[3,4,6,9,13,18,24],zi:[1.5,1.7,2,2.4,2.9,3.5,4.2]},10:{ki:[16,18,21,25,30,36,43],frequency:[.5,.6,.7,.9,1.1,1.4,1.7]}};class E extends z{constructor(s,i=N.ai.clone()){super(i),this.size=.25,this.Ai=!1,this.Ni=(s,i,e)=>{for(let n=0;n<r.qs.length;n++){const h=r.qs[n];(0,t.fs)(this.ai.x,this.ai.y,this.li,h.ai.x,h.ai.y,h.li)&&(h.ki(s,i,e,this.si),this.Ai&&(this.ii=!0))}},this.parent=s}update(t,s,i){super.update(t,s),this.bi(t,s,i),this.pi(),this.Ni(this.parent.ki,i,t)}}class D{constructor(){this.Pi=[],r.Ks.push(this)}Ei(){return this.level<7}di(t){for(let s=0;s<this.Pi.length;s++)this.Pi[s].di(t)}update(t,s){for(let i=0;i<this.Pi.length;i++)this.Pi[i].ii?this.Pi.splice(i,1):this.Pi[i].update(t,s,i)}}class L extends E{constructor(s,i){super(s,N.position.clone()),this.gi=C,this.ui=1,this.li=.05,this.si=8,this.options=void 0,this.Ai=!0,this.vi=t=>{t.J([[-1,0],[1,0]]),t.J([[-.75,-.4],[-1,0],[-.75,.4]])},this.bi=(t,s)=>{this.position.x+=this.Di.x*this.parent.speed,this.position.y+=this.Di.y*this.parent.speed},this.Di=t.wt.from(i,this.ai).normalize(),this.Li=this.Di.angle()+t.PI,this.Wi={B:{rotation:{origin:this.ei,rotation:this.Li}}}}di(t){this.fi(t),super.di(t,this.Wi,!1)}}class W extends D{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this.Ui=0,this.type=8,this.upgrade=()=>{this.Ei()&&this.level++}}get Bi(){return P[8]}get frequency(){return 1e3/this.Bi.frequency[this.level-1]}get ki(){return this.Bi.ki[this.level-1]}update(t,s){if(super.update(t,s),t-this.Ui>this.frequency){this.Ui=t;const s=this.Ii();s&&this.Pi.push(new L(this,s.ai))}for(let i=0;i<this.Pi.length;i++){const e=this.Pi[i];e.update(t,s,i),e.ai.us(N.ai)>this.range&&(e.ii=!0)}}Ii(){let t,s=1/0;for(let i=0;i<r.qs.length;i++){const e=N.ai.us(r.qs[i].ai);e<s&&(s=e,t=r.qs[i])}return t}}const U={Fi:[],Ti:[],qi:[],Ki:[],Hi:[],$i:[],Ji:[],Yi:[]};let B=0;const I=(t,s)=>(U[t].push({id:B,Vi:s}),B++,B-1),F=(t,...s)=>{const i=U[t];for(let t=0;t<i.length;t++)i[t].Vi(...s)};new ResizeObserver((()=>{F("CanvasResize")})).observe(o.map),window.addEventListener("keydown",(t=>{F("KeyDown",t.key)})),window.addEventListener("keyup",(t=>{F("KeyUp",t.key)})),window.addEventListener("resize",(t=>{F("WindowResize")}));const T=[.4,.2,.6],q=[0,.2,.6];class K extends E{constructor(s,i,e){super(s,i),this.gi=C,this.ui=2,this.li=.5,this.si=10,this.options=void 0,this.vi=t=>{const s=-1/3;t.J([[s,0],[s,0-T[0]/2],[s+q[1],0-T[1]/2],[s+q[2],0-T[2]/2],[s+q[2],0+T[2]/2],[s+q[1],0+T[1]/2],[s,0+T[0]/2],[s,0]]),t.J([[s+q[1],.8],[s+q[1],0+T[0]/2]])},this.bi=(s,i)=>{const e=(0,t.normalize)(s,this.start,this.start+this.parent.duration),n=-t.PI/2-e*t.PI;this.parent.Xi(this.position,n,this.Gi),this.position.add(-this.ui/2,-this.ui/2)},this.start=e,this.Gi="left"===N.mi?1:-1,this.Wi={B:{rotation:{origin:this.ai,rotation:this.Gi*-Math.PI/4},scale:{origin:this.ai,scale:new t.wt(-1*this.Gi,1)}}}}di(t){super.di(t,this.Wi)}}class H extends D{constructor(){super(),this.level=1,this.range=1.7,this.speed=.09,this.duration=500,this.Ui=0,this.type=10,this.upgrade=()=>{this.Ei()&&this.level++}}get Bi(){return P[10]}get frequency(){return 1e3/this.Bi.frequency[this.level-1]}Xi(t,s,i){t.x=N.ai.x+i*Math.cos(i*s)*this.range,t.y=N.ai.y+i*Math.sin(i*s)*this.range}get ki(){return this.Bi.ki[this.level-1]}update(s,i){if(super.update(s,i),s-this.Ui>this.frequency){this.Ui=s;const i=N.position.clone();this.Xi(i,-t.PI/2,1),i.add(-.5,-.5),this.Pi.push(new K(this,i,s))}for(let t=0;t<this.Pi.length;t++){const e=this.Pi[t];e.update(s,i,t),s-e.start>this.duration&&(e.ii=!0)}}}class $ extends E{constructor(s,i){super(s),this.gi=C,this.si=9,this.options=void 0,this.vi=s=>{s.it(0,0,.5,{B:{fillStyle:x,alpha:.1},fill:!0}),s.it(0,0,.5,{B:{strokeStyle:x}}),s.it(0,0,.4,{B:{strokeStyle:x}});for(let i=0;i<5;i++){const e=.3*Math.cos(t.Z*i/5),n=.3*Math.sin(t.Z*i/5);s.it(e,n,.2,{B:{strokeStyle:x}})}},this.bi=(t,s)=>{},this.start=i,this.Qi={B:{scale:new t.wt(this.parent.zi,this.parent.zi)}},this.oi.add(-this.li,-this.li),this.position.add(-this.li,-this.li)}get li(){return this.parent.zi}get ui(){return 2*this.li}}class J extends D{constructor(){super(),this.level=1,this.range=5,this.speed=.1,this.Ui=0,this.frequency=1500,this.duration=1500,this.type=9,this.upgrade=()=>{this.Ei()&&this.level++}}get Bi(){return P[9]}get zi(){return this.Bi.zi[this.level-1]}get ki(){return this.Bi.ki[this.level-1]}update(t,s){super.update(t,s),t-this.Ui>this.frequency&&(this.Ui=t,this.Pi.push(new $(this,t)));for(let i=0;i<this.Pi.length;i++){const e=this.Pi[i];e.update(t,s,i),t-e.start>this.duration&&(e.ii=!0)}}}class Y extends E{constructor(s){super(s),this.gi=C,this.ui=1,this.si=6,this.li=.25,this.offset=0,this.options=void 0,this.vi=t=>{t.it(0,0,this.li,{B:{fillStyle:x},fill:!0})},this.bi=(s,i)=>{const e=this.offset+t.Z*(s/this.parent.l),n=N.ai.x+Math.cos(e)*this.parent.range-this.ui/2,h=N.ai.y+Math.sin(e)*this.parent.range-this.ui/2;this.position.x=(0,t.tt)(1-this.parent.Zi,this.oi.x,n),this.position.y=(0,t.tt)(1-this.parent.Zi,this.oi.y,h)}}}class V extends D{constructor(){super(),this.level=1,this.Zi=.33,this.l=2e3,this.type=6,this.upgrade=()=>{if(this.Ei())for(this.level++;this.Pi.length<this.Ci;)this.Pi.push(new Y(this)),this.Pi.forEach(((s,i)=>s.offset=t.Z*i/this.Pi.length))},this.Pi.push(new Y(this))}get Bi(){return P[6]}get Ci(){return this.Bi.Ci[this.level-1]}get range(){return this.Bi.range[this.level-1]}get ki(){return this.Bi.ki[this.level-1]}}const X=[8,10,6,9],G=()=>{r.Bs.Fs=r.Bs.Is,r.Bs.level++,r.Bs.next=50*Math.pow(r.Bs.level,2),r.Ys.length=0,r.Ys=(t=>{const s=X.map((t=>{const s=r.Ks.find((s=>s.type===t)),i=(s?.level??0)+1;let e,n;switch(t){case 8:1===i?e=()=>new W:s&&(e=()=>s.upgrade()),n=`Arrow - L${i}`;break;case 10:1===i?e=()=>new H:s&&(e=()=>s.upgrade()),n=`Axe - L${i}`;break;case 6:1===i?e=()=>new V:s&&(e=()=>s.upgrade()),n=`Orb - L${i}`;break;case 9:1===i?e=()=>new J:s&&(e=()=>s.upgrade()),n=`Summoning Circle - L${i}`;break;default:throw new Error}return{text:n,te:e}})),i=[];for(let e=0;e<t;e++){const t=Math.floor(Math.random()*s.length);i.push(s[t]),s.splice(t,1)}return i})(r.Js),F("StateChange",h.Ns)},Q=()=>{p.upgrade.options.random=j(0),p.upgrade.clear();for(let s=0;s<r.Js;s++){const i=r.Ys[s],e=new t.R({offsetX:p.upgrade.coords.St(-1)+p.upgrade.coords.width(s/r.Js),offsetY:p.upgrade.coords._t(-1),At:p.upgrade.coords.width()/r.Js,Nt:p.upgrade.coords.height(),padding:.05}),n=new t.O(p.upgrade.context,{...p.upgrade.options,coords:e,stroke:!1});n.rect(-1,-1,1,1,{stroke:!0,fill:!0,B:{fillStyle:m,strokeStyle:r.Vs===s?O:y}}),n.text(i.text,0,-.8,{B:{textBaseline:"top",fillStyle:r.Vs===s?O:y},W:0,A:e.width(.9)})}},Z=()=>{const t=(r.Bs.Is-r.Bs.Fs)/(r.Bs.next-r.Bs.Fs);p.Qs.clear(),p.Qs.rect(-1,-1,1,1,{fill:!1,W:0,stroke:!0}),p.Qs.rect(-1,-1,t,1,{fill:!0,W:0,B:{fillStyle:O}})},tt=()=>{for(let t=0;t<c.x;t++)for(let s=0;s<c.y;s++)p.map.rect(t,s,1/c.x,1/c.y,{B:{strokeStyle:"rgba(255,255,255,0.1)"}})},st=[[[22,38],[35,87],[37,89],[44,92],[55,92],[60,89],[64,84],[76,38],[74,35],[59,22],[49,20],[38,22],[29,29],[22,38]],[[31,52],[45,55],[40,61],[35,59],[31,52]],[[58,61],[56,60],[54,55],[67,52],[62,59],[58,61]],[[58,25],[59,17],[63,12],[68,8],[76,7],[83,8],[88,12],[92,17],[94,25],[93,29],[89,38]],[[74,35],[89,52],[86,54],[83,55],[79,55],[75,51],[72,40],[74,35]],[[40,25],[38,17],[34,12],[29,8],[22,7],[15,8],[10,12],[6,17],[5,29],[9,38]],[[25,35],[9,52],[11,54],[14,55],[19,55],[22,51],[25,40],[25,35]]];class it extends z{constructor(t,s){super(t),this.se=t=>{this.ii=!0},this.ie=s}update(t,s,i){super.update(t,s),this.bi(t,s,i),this.pi()}bi(s,i,e){this.ie.ee&&((s,i,e,n)=>{const h=t.wt.from(N.position,s);if(!e.start&&h.os<e.cs)e.start=i;else if(e.start&&h.os<1)e.ne(n);else if(e.start){const t=i-e.start;h.normalize();const n=h.clone().multiply(.0015*t-.25);s.x+=n.x,s.y+=n.y}})(this.position,s,this.ie.ee,e)}}class et extends it{constructor(t,s){let i;super(t,{ee:{cs:2,he:t.clone(),ne:t=>{r.Bs.Is+=s,r.Bs.Is>r.Bs.next&&F("LevelUp"),Z(),this.se(t)}}}),this.gi=C,this.ui=1,this.li=.25,this.si=11,this.vi=t=>{t.rt(0,0,this.li,5,.4,this.options)},this.Bs=s,i=this.Bs<20?0:this.Bs<50?1:2,this.options={B:et.B[i],fill:!0}}}et.B={0:{fillStyle:S,strokeStyle:S},1:{fillStyle:_,strokeStyle:_},2:{fillStyle:x,strokeStyle:x}};const nt=(0,i(257).i)({h:.5,u:1,o:.2,l:2});class ht extends z{constructor(s,i,e){super(ht.re(s.ai.clone(),s)),this.li=.5,this.ui=1,this.duration=500,this.Qi={B:{scale:{origin:u,scale:new t.wt(1,1)}}},this.options=void 0,this.gi=C,this.di=t=>{super.di(t,this.Qi)},this.vi=t=>{t.text(this.text,0,0,{fill:!0,B:{fontSize:t=>t.width(.35),textBaseline:"top"},W:0})},this.target=s,this.si=i,this.text=i,this.start=e}static re(t,s){return t.x=s.ai.x-.5,t.y=s.ai.y-1.5,t}update(t,s){super.update(t,0,s);const i=nt((t-this.start)/this.duration);this.Qi.B.scale.origin=this.ai,this.Qi.B.scale.scale.x=i,this.Qi.B.scale.scale.y=i,ht.re(this.position,this.target),t-this.start>=this.duration&&(this.ii=!0)}}class rt extends z{constructor(t,s,i){super(t),this.ji=5,this.speed=.025,this.oe=1e3,this.ae={},this.options={B:{fillStyle:M},fill:!0},this.ie=s,this.Us=i,this.yi=i}ue(t){p.Zs.text(String(t),this.ai.x,this.ai.y-this.ui/2,{W:0})}ki(t,s,i,e){const n=this.ae[e];n&&i-n<this.oe||(this.Us-=t,r.Hs.push(new ht(this,String(t),i)),this.Us<=0&&this.se(),this.ae[e]=i)}se(){const t=new et(this.ai.clone(),this.yi);t.position.add(-t.ui/2,-t.ui/2),r.items.push(t),this.ii=!0}update(t,s){super.update(t,s),this.bi(t,s),this.pi()}bi(s,i){this.ie.ce&&((s,i)=>{const e=t.wt.from(N.position,s).normalize().multiply(i);s.x+=e.x,s.y+=e.y})(this.position,this.speed),this.ie.le&&((s,i,e)=>{const n=t.wt.from(N.position,s);if(n.os<e.cs){const t=n.normalize().multiply(i*e.ce);s.x+=t.x,s.y+=t.y}else{if(s.equals(e.fe))return;if(s.us(e.fe)<.1)s.set(e.fe);else{const n=t.wt.from(e.fe,s).normalize().multiply(i*e.ce);s.x+=n.x,s.y+=n.y}}})(this.position,i,this.ie.le)}}class ot extends rt{constructor(t,s){super(t,{le:{ce:.002,cs:3,fe:t.clone()}},s),this.gi=k,this.ui=1,this.si=1,this.li=.5,this.vi=t=>{st.forEach((s=>t.J(s,this.options)))}}}ot.de=7;const at=[[[87,35],[83,21],[80,15],[70,6],[57,1],[43,1],[30,6],[20,15],[15,28],[14,35],[9,39],[7,47],[9,54],[14,59],[18,72],[26,84],[37,92],[44,95],[57,95],[63,92],[74,84],[82,72],[87,59],[94,50],[95,47],[92,39],[87,35]],[[87,45],[76,44],[76,35],[80,34],[80,41],[83,41],[87,45]],[[78,63],[76,68],[76,65],[78,63]],[[63,74],[63,63],[71,63],[73,65],[73,74],[63,74]],[[45,74],[43,73],[43,65],[45,63],[57,63],[57,74],[45,74]],[[29,74],[30,63],[38,63],[40,65],[40,73],[29,74]],[[24,63],[25,68],[24,63]],[[22,30],[25,24],[25,29],[22,30]],[[57,19],[57,30],[43,29],[43,21],[45,19],[57,19]],[[78,30],[76,29],[76,24],[78,30]],[[73,58],[71,60],[63,60],[62,56],[58,54],[57,60],[45,60],[43,58],[43,54],[40,56],[38,60],[30,60],[29,35],[38,34],[40,35],[40,38],[43,40],[43,35],[45,34],[57,34],[58,40],[62,38],[63,34],[73,35],[73,58]],[[29,29],[29,19],[38,19],[40,21],[40,29],[29,29]],[[73,19],[73,29],[63,30],[63,19],[73,19]],[[63,16],[62,11],[70,16],[63,16]],[[40,14],[38,16],[31,16],[40,11],[40,14]],[[58,9],[57,16],[45,16],[43,14],[43,9],[58,9]],[[18,41],[21,41],[21,35],[24,34],[25,44],[14,45],[18,41]],[[18,52],[14,49],[25,50],[24,60],[22,60],[21,53],[18,52]],[[31,78],[40,79],[40,86],[31,78]],[[43,88],[43,79],[58,79],[58,88],[43,88]],[[62,86],[63,78],[71,78],[62,86]],[[83,52],[80,53],[78,60],[76,58],[76,50],[87,49],[83,52]],[[38,41],[33,42],[32,47],[33,50],[38,52],[41,50],[43,47],[41,42],[38,41]],[[63,41],[59,42],[58,47],[59,50],[63,52],[67,50],[69,47],[67,42],[63,41]]];class ut extends rt{constructor(t,s){super(t,{ce:{ve:.002}},s),this.gi=k,this.ui=1,this.si=4,this.li=.5,this.speed=.002,this.vi=t=>{at.forEach((s=>t.J(s,this.options)))},this.options={...this.options,B:{...this.options.B,lineWidth:t=>t.width(.025)}}}}ut.de=13;const ct=[[[37,36],[46,37],[53,42],[57,48],[60,58],[59,66],[56,69],[49,74],[46,84],[37,87],[31,86],[28,84],[26,74],[17,69],[14,62],[17,48],[21,42],[28,37],[37,36]],[[63,95],[68,71],[69,59],[67,45],[64,35],[58,28],[47,21],[37,19],[27,21],[15,28],[10,35],[7,45],[6,59],[6,71],[12,95]],[[14,61],[15,79],[21,95]],[[61,61],[59,79],[54,95]],[[77,21],[45,10],[29,9],[20,9],[12,13],[17,8],[25,4],[44,2],[71,6],[92,13],[77,21]],[[94,9],[82,95]],[[42,51],[39,53],[40,59],[43,63],[46,63],[51,60],[53,55],[53,51],[47,48],[42,51]],[[37,63],[34,66],[33,71],[41,71],[40,66],[37,63]],[[33,51],[30,49],[24,49],[22,51],[20,55],[24,60],[30,63],[34,59],[35,56],[33,51]]];class lt extends rt{constructor(t,s){super(t,{ce:{ve:.002}},s),this.gi=k,this.ui=1,this.si=5,this.li=.5,this.vi=t=>{ct.forEach((s=>t.J(s,this.options)))}}}lt.de=15;const ft=[[[95,56],[75,43],[51,35],[43,53],[40,65],[40,82],[44,91],[49,95],[54,96],[65,94],[72,90],[86,74],[96,59],[95,56]],[[53,85],[49,80],[47,68],[56,79],[71,80],[59,85],[53,85]],[[73,71],[67,65],[76,65],[81,72],[73,71]],[[54,62],[49,55],[57,56],[63,62],[54,62]],[[39,47],[33,49],[27,56],[31,45],[36,42],[42,42],[44,36],[48,29],[52,29],[57,31],[55,20],[49,2],[24,7],[2,19],[11,42],[23,57],[35,63],[39,47]],[[43,22],[51,25],[43,29],[35,25],[43,22]],[[25,36],[16,38],[20,31],[29,29],[25,36]]];class dt extends rt{constructor(t,s){super(t,{ce:{ve:.002}},s),this.gi=k,this.ui=2,this.si=2,this.li=.8,this.vi=t=>{ft.forEach((s=>t.J(s,this.options)))}}}dt.de=10;const vt=[[[58,46],[68,43],[75,40],[74,43],[70,50],[63,50],[60,49],[58,46]],[[49,3],[35,6],[24,14],[16,26],[14,40],[16,62],[23,78],[34,88],[49,94],[62,89],[73,79],[81,63],[84,40],[81,26],[73,14],[62,6],[49,3]],[[46,48],[45,59],[37,54],[34,57],[31,63],[32,73],[43,84],[35,81],[26,74],[21,63],[19,50],[19,34],[22,24],[29,14],[41,7],[32,17],[31,32],[33,37],[39,41],[42,38],[43,31],[46,43],[43,45],[46,48]],[[56,85],[64,76],[68,68],[66,59],[61,54],[58,55],[54,59],[53,48],[56,46],[53,44],[54,33],[56,31],[58,40],[62,40],[65,37],[68,28],[66,18],[58,7],[69,14],[76,24],[79,34],[79,50],[77,63],[75,70],[69,77],[62,82],[56,85]],[[41,46],[30,43],[23,40],[23,43],[27,50],[35,50],[38,49],[41,46]]];class gt extends rt{constructor(t,s){super(t,{ce:{ve:.002}},s),this.gi=k,this.ui=1,this.si=3,this.li=.5,this.vi=t=>{vt.forEach((s=>t.J(s,this.options)))},this.options={...this.options,B:{...this.options.B,lineWidth:t=>t.width(.025)}}}}gt.de=5;const pt={1:ot,2:dt,3:gt,4:ut,5:lt};class wt extends z{constructor(s,i){super(s),this.ii=!1,this.si=12,this.li=1.5,this.ui=3,this.duration=2500,this.ge=r.Xs/2,this.options=void 0,this.gi=C,this.vi=s=>{s.rect(-.2,-.8,.2,.8,{B:{rotation:{origin:u,rotation:t.PI/4},fillStyle:b},fill:!0,stroke:!1}),s.rect(-.2,-.8,.2,.8,{B:{rotation:{origin:u,rotation:-t.PI/4},fillStyle:b},fill:!0,stroke:!1})},this.start=i}update(t,s){super.update(t,0,s),t-this.start>wt.duration&&(this.ii=!0)}}wt.duration=2500;const yt=[0,1,2,3],mt=Object.keys(pt),Mt=s=>{const i=1e3*(9e5-Math.max(0,s)/1e3)/1e6;if(s-r.timestamp.Ds>=i){r.timestamp.Ds=s;const i=(0,t.random)(mt),e=(0,t.random)(yt);let n,h;0===e&&(n=(0,t.random)(c.x),h=0),1===e&&(n=(0,t.random)(c.x),h=c.y),2===e&&(n=0,h=(0,t.random)(c.y)),3===e&&(n=0,h=(0,t.random)(c.y));const o=pt[i];r.qs.push(new o(new t.wt(n,h),(t=>pt[t].de*r.Bs.level*.5)(i)))}s-r.timestamp.Ls>=6e4&&bt(s)},bt=s=>{const i=(s-r.timestamp.Ls-6e4)/wt.duration;if(i<1&&!r.Ts){const i=(0,t.random)(.8*c.x,.1),e=(0,t.random)(.8*c.y,.1),n=new wt(new t.wt(i,e),s);r.Ts=n,r.Hs.push(n)}else if(i>1&&r.Ts){const i=Math.floor((0,t.random)(16,12));for(let s=0;s<i;s++){const e=r.Ts.ai.x+1.5*Math.cos(t.Z*s/i),n=r.Ts.ai.y+1.5*Math.sin(t.Z*s/i);r.qs.push(new ot(new t.wt(e,n),5))}r.timestamp.Ls=s,r.Ts=!1}};let St;const _t=[[[16,20],[25,25],[26,24],[25,19],[22,17],[19,17],[16,20]],[[34,5],[30,5],[28,7],[28,13],[30,15],[35,15],[38,12],[37,6],[34,5]],[[65,5],[61,8],[61,12],[64,15],[69,15],[71,13],[71,7],[69,5],[65,5]],[[74,25],[83,19],[80,17],[75,18],[73,21],[74,25]],[[21,47],[26,50],[21,47]],[[21,47],[26,50],[21,47]],[[21,53],[25,50],[21,53]],[[21,53],[25,50],[21,53]],[[74,50],[78,53],[79,52],[74,50]],[[74,50],[78,53],[79,52],[74,50]],[[74,49],[78,46],[74,49]],[[74,49],[78,46],[74,49]]],xt=[[[25,50],[40,58],[52,60],[59,58],[74,49],[58,44],[46,43],[25,50]]],Ot=[[[86,37],[85,34],[81,34],[79,36],[79,40],[83,42],[86,40],[86,37]],[[20,39],[20,35],[13,35],[14,41],[17,42],[20,39]]],jt=[[[25,49],[26,50],[44,44],[55,44],[74,50],[63,43],[52,39],[40,41],[25,49]],[[16,20],[16,26],[20,28],[24,27],[25,25],[16,20]],[[55,5],[53,1],[48,0],[45,2],[44,7],[46,10],[51,11],[54,9],[55,5]],[[74,25],[78,28],[82,27],[84,24],[83,19],[74,25]],[[21,40],[21,36],[18,34],[13,34],[11,37],[11,42],[13,44],[19,44],[21,40]],[[29,8],[28,13],[30,15],[35,14],[35,8],[29,8]],[[64,14],[69,15],[71,13],[71,9],[68,7],[64,8],[64,14]],[[78,41],[80,44],[86,44],[88,42],[87,35],[79,35],[78,41]],[[-90,50],[-89,51],[-72,45],[-60,45],[-43,51],[-41,50],[-62,40],[-70,40],[-76,42],[-90,50]],[[-99,21],[-100,26],[-98,28],[-95,29],[-91,27],[-99,21]],[[-61,6],[-63,2],[-67,1],[-71,4],[-71,9],[-67,12],[-64,12],[-61,9],[-61,6]],[[-41,26],[-40,28],[-37,29],[-34,28],[-32,26],[-32,21],[-33,20],[-41,26]],[[-94,41],[-94,38],[-97,35],[-102,35],[-105,39],[-102,45],[-97,45],[-94,41]],[[-86,9],[-88,13],[-85,16],[-82,16],[-80,14],[-80,10],[-82,8],[-86,9]],[[-51,15],[-45,15],[-45,9],[-50,8],[-52,10],[-51,15]],[[-37,42],[-35,45],[-30,45],[-27,39],[-30,35],[-35,35],[-38,39],[-37,42]]],kt=.035,Ct=200*kt;const Rt=new class extends z{constructor(){super(...arguments),this.gi=k,this.options=void 0,this.li=1,this.ui=c.y,this.si="third-eye",this.vi=t=>{(t=>{xt.forEach((s=>{t.J(s,{fill:!0,B:{fillStyle:m},W:kt})})),_t.forEach((s=>{t.J(s,{W:kt})})),t.it(50,50,.09,{W:Ct}),t.it(50,50,.06,{W:Ct}),t.it(50,65,.01,{W:Ct}),t.it(50,70,.0125,{W:Ct}),t.it(50,75,.015,{W:Ct}),jt.forEach((s=>{t.J(s,{fill:!0,B:{fillStyle:x},W:kt})})),Ot.forEach((s=>{t.J(s,{fill:!0,B:{fillStyle:m},W:kt})})),t.text("BARDO",50,23,{W:0}),t.text("The journey between",50,30,{W:0,B:{fontSize:t=>t.width(.035)}}),t.text("lives on Earth",50,35,{W:0,B:{fontSize:t=>t.width(.035)}}),t.text("Press any key to start",50,92,{W:0,B:{fontSize:t=>t.width(.04)}}),t.J([[50,79],[50,87]],{W:kt}),t.J([[47,85],[50,87],[53,85]],{W:kt})})(t)}}}(new t.wt((c.x-c.y)/2,0)),zt=new(e()),At=zt.bs(new(e().ys)("phys","#0ff","#002"));zt.ws.id="stats",document.body.appendChild(zt.ws);const Nt=1e3/60;let Pt=0,Et=0,Dt=0,Lt=0;const Wt=(t=0)=>{zt._s();const s=r.$s===h.As?0:t-Et;for(Et=t,Lt=0===N.wi?1:Math.min(1,(Pt-N.wi)/A.xi),Dt+=Math.min(s,50)*Lt;Dt>=Nt;)Ut(),Dt-=Nt,Pt+=Nt;Bt(Dt/Nt),zt.end(),window.requestAnimationFrame(Wt)},Ut=()=>{if(At.update(59.99999999999999,200),r.$s===h.zs&&Rt.update(Pt,Nt),r.$s===h.Rs){N.update(Pt,Nt);for(let t=r.Ks.length-1;t>=0;t--)r.Ks[t].update(Pt,Nt);for(let t=r.qs.length-1;t>=0;t--)r.qs[t].ii?r.qs.splice(t,1):r.qs[t].update(Pt,Nt);for(let t=r.items.length-1;t>=0;t--)r.items[t].ii?r.items.splice(t,1):r.items[t].update(Pt,Nt,t);for(let t=r.Hs.length-1;t>=0;t--)r.Hs[t].ii?r.Hs.splice(t,1):r.Hs[t].update(Pt,t);Mt(Pt)}},Bt=t=>{if(p.Zs.clear(),r.$s===h.zs&&Rt.di(t),r.$s===h.Rs||r.$s===h.As){for(let s=0;s<r.Ks.length;s++)r.Ks[s].di(t);for(let s=0;s<r.qs.length;s++)r.qs[s].di(t);for(let s=0;s<r.items.length;s++)r.items[s].di(t);for(let s=0;s<r.Hs.length;s++)r.Hs[s].di(t);N.di(t),Lt<1&&p.Zs.rect(0,0,c.x,c.y,{W:0,fill:!0,B:{fillStyle:"red",alpha:.33*(1-Lt)}})}};(0,t.Qt)(o.map,c),(0,t.Qt)(o.Zs,c),(0,t.Qt)(o.Gs,c),I("KeyDown",(s=>{if(r.$s!==h.zs){if("Enter"===s&&r.$s===h.Ns){r.Ys[r.Vs].te(),r.Vs=0,p.upgrade.clear(),F("StateChange",h.Rs)}"Shift"===s&&(r.Bs.Is=r.Bs.next,F("LevelUp")),"Escape"===s&&r.$s===h.Rs&&F("StateChange",h.As),"ArrowLeft"!==s&&"a"!==s||(r.$s===h.Rs&&(r.move.left=!0,N.mi="left"),r.$s===h.Ns&&(r.Vs=(0,t.gs)(r.Vs-1,r.Js),Q())),"ArrowRight"!==s&&"d"!==s||(r.$s===h.Rs&&(r.move.right=!0,N.mi="right"),r.$s===h.Ns&&(r.Vs=(0,t.gs)(r.Vs+1,r.Js),Q())),"ArrowUp"!==s&&"w"!==s||(r.move.Ps=!0),"ArrowDown"!==s&&"s"!==s||(r.move.Es=!0)}else F("StateChange",h.Rs)})),I("KeyUp",(t=>{"ArrowLeft"!==t&&"a"!==t||(r.move.left=!1),"ArrowRight"!==t&&"d"!==t||(r.move.right=!1),"ArrowUp"!==t&&"w"!==t||(r.move.Ps=!1),"ArrowDown"!==t&&"s"!==t||(r.move.Es=!1),"Enter"===t&&r.$s===h.As&&F("StateChange",h.Rs)})),I("CanvasResize",(()=>{for(const t in R.ti)R.ti[t].length=0;const s=o.map.getBoundingClientRect();o.Qs.style.height=String(.05*s.height),o.Qs.style.left=String(s.left),o.Qs.style.top=String(s.top-o.Qs.clientHeight),o.Qs.style.width=String(s.width),o.Qs.width=o.Qs.clientWidth*t.bt,o.Qs.height=o.Qs.clientHeight*t.bt,r.$s===h.Rs&&(tt(),Z()),r.$s===h.Ns&&Q()})),I("WindowResize",(()=>{const t=o.map.getBoundingClientRect();o.Qs.style.height=String(.05*t.height),o.Qs.style.left=String(t.left),o.Qs.style.top=String(t.top-o.Qs.clientHeight),o.Qs.style.width=String(t.width)})),I("StateChange",(t=>{switch(t){case h.Ns:r.Vs=0,Q(),St=I("CanvasResize",Q);case h.Rs:p.map.clear(),p.Qs.clear(),tt(),Z()}t!==h.Ns&&(t=>{let s;for(s in U)for(let i=U[s].length-1;i>=0;i--)U[s][i].id===t&&U[s].splice(i,1)})(St),r.$s=t})),I("LevelUp",G),I("Initialize",(()=>{document.body.style.backgroundColor=m,o.map.style.zIndex="-1",G(),new W})),F("Initialize"),F("StateChange",h.zs),window.requestAnimationFrame(Wt)})()})();</script></body></html>